# 9. AOP (Aspect-Oriented Programming)

## AOP ê°œë…ê³¼ í•„ìš”ì„±

ë‹¤ìŒì€ Spring í”„ë ˆì„ì›Œí¬ì—ì„œì˜ **AOP(Aspect-Oriented Programming, ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°)**ì˜ **ê°œë…, í•„ìš”ì„±, í•µì‹¬ êµ¬ì„± ìš”ì†Œ, ë‚´ë¶€ ë™ì‘ ì›ë¦¬, ì‹¤ë¬´ ì ìš© ì˜ˆì œ, DIì™€ì˜ ì°¨ì´ì , ì ìš© ìœ„ì¹˜ ë° ì „ëµ**ê¹Œì§€ í¬í•¨í•œ **ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…**ì´ë‹¤.

------

### AOPë€? (Aspect-Oriented Programming)

### 1. AOPì˜ ê°œë…

**AOP(ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°)**ëŠ” í”„ë¡œê·¸ë¨ì˜ í•µì‹¬ ë¡œì§(Core Concern)ê³¼ëŠ” **ê´€ì‹¬ì‚¬ê°€ ë‹¤ë¥´ì§€ë§Œ ë°˜ë³µì ìœ¼ë¡œ í•„ìš”í•œ ê³µí†µ ê¸°ëŠ¥(Cross-Cutting Concern)**ì„
 **í•œ ê³³ì— ëª¨ì•„ ë¶„ë¦¬í•˜ì—¬ ì¬ì‚¬ìš©ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ í–¥ìƒ**ì‹œí‚¤ëŠ” í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„ì´ë‹¤.

> ì¦‰, "ëª¨ë“  í´ë˜ìŠ¤ì— ë°˜ë³µì ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê³µí†µ ì½”ë“œë¥¼ í•˜ë‚˜ì˜ 'ê´€ì (Aspect)'ìœ¼ë¡œ ë¬¶ì–´ ì²˜ë¦¬"í•˜ëŠ” ê²ƒ

------

### 2. AOPê°€ í•„ìš”í•œ ì´ìœ 

#### âœ³ï¸ ë°˜ë³µë˜ëŠ” ë¶€ê°€ê¸°ëŠ¥ì„ ëª¨ë“ˆí™”

- íŠ¸ëœì­ì…˜ ì²˜ë¦¬
- ë¡œê·¸ ê¸°ë¡
- ë³´ì•ˆ ê²€ì‚¬
- ì˜ˆì™¸ ì²˜ë¦¬
- ì¸ì¦/ì¸ê°€
- ì„±ëŠ¥ ì¸¡ì •

> ì´ ê¸°ëŠ¥ë“¤ì´ **ì—¬ëŸ¬ í´ë˜ìŠ¤ì— ì¤‘ë³µë  ê²½ìš° ì½”ë“œê°€ ë¶„ì‚°**ë˜ì–´ ë²„ê·¸ ìœ„í—˜ ì¦ê°€, í…ŒìŠ¤íŠ¸ ì–´ë ¤ì›€

------

### 3. OOP vs AOP

| í•­ëª©        | OOP (ê°ì²´ì§€í–¥)                            | AOP (ê´€ì ì§€í–¥)                              |
| ----------- | ----------------------------------------- | ------------------------------------------- |
| ê´€ì‹¬ì‚¬ ë¶„ë¦¬ | **ê¸°ëŠ¥ ì¤‘ì‹¬(ì—­í• )**ìœ¼ë¡œ ë¶„ë¦¬              | **ê´€ì  ì¤‘ì‹¬(ê³µí†µ ê´€ì‹¬ì‚¬)**ë¡œ ë¶„ë¦¬           |
| ì¤‘ë³µ ì œê±°   | ìƒì†, ì¸í„°í˜ì´ìŠ¤ ë“±ìœ¼ë¡œ í•´ê²° ì‹œ í•œê³„ ì¡´ì¬ | ì—¬ëŸ¬ ì§€ì ì— **íˆ¬ëª…í•˜ê²Œ ì ìš©** ê°€ëŠ¥          |
| ë‹¨ìœ„        | í´ë˜ìŠ¤, ê°ì²´                              | **Aspect, Join Point, Advice**              |
| í•µì‹¬ ëª©í‘œ   | ì‘ì§‘ë„ â†‘, ê²°í•©ë„ â†“                        | **íš¡ë‹¨ ê´€ì‹¬ì‚¬(Cross-Cutting Concern) ë¶„ë¦¬** |

------

### 4. AOPì˜ í•µì‹¬ ìš©ì–´

| ìš©ì–´           | ì„¤ëª…                                                         |
| -------------- | ------------------------------------------------------------ |
| **Aspect**     | ê³µí†µ ê¸°ëŠ¥(íŠ¸ëœì­ì…˜, ë¡œê·¸ ë“±)ì„ ë‹´ì€ ëª¨ë“ˆ                     |
| **Advice**     | ê³µí†µ ê¸°ëŠ¥ì´ **ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œ** (`@Before`, `@After`, `@Around` ë“±) |
| **Join Point** | AOPê°€ ì ìš© ê°€ëŠ¥í•œ ì§€ì  (ë©”ì„œë“œ í˜¸ì¶œ, ì˜ˆì™¸ ë°œìƒ ë“±)           |
| **Pointcut**   | Join Point ì¤‘ì—ì„œ ì‹¤ì œ AOPë¥¼ ì ìš©í•  **ì¡°ê±´ í•„í„°ë§** (ì˜ˆ: íŠ¹ì • íŒ¨í‚¤ì§€ ì´í•˜ ëª¨ë“  ë©”ì„œë“œ) |
| **Weaving**    | Adviceë¥¼ ì‹¤ì œ ëŒ€ìƒ ê°ì²´ì˜ Join Pointì— **ê²°í•©**í•˜ëŠ” ê³¼ì •     |
| **Proxy**      | ìŠ¤í”„ë§ì´ ìƒì„±í•˜ëŠ” **ìœ„ì„ ê°ì²´**, ì‹¤ì œ ëŒ€ìƒ ê°ì²´ ì•ì—ì„œ AOP ì²˜ë¦¬ ìˆ˜í–‰ |

------

### 5. Spring AOP ë™ì‘ ë°©ì‹ (í”„ë¡ì‹œ ê¸°ë°˜)

1. IoC ì»¨í…Œì´ë„ˆê°€ ë¹ˆì„ ìƒì„±í•  ë•Œ **í”„ë¡ì‹œ ê°ì²´(ëŒ€ë¦¬ ê°ì²´)ë¥¼ ëŒ€ì‹  ìƒì„±**
2. ì‚¬ìš©ìê°€ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ì‹¤ì œ ëŒ€ìƒ ê°ì²´ê°€ ì•„ë‹ˆë¼ **í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ ìš”ì²­ ì²˜ë¦¬**
3. í”„ë¡ì‹œ ê°ì²´ëŠ” **Advice â†’ Target Method â†’ í›„ì²˜ë¦¬** ìˆœìœ¼ë¡œ ì‹¤í–‰

> ê¸°ë³¸ì ìœ¼ë¡œ Spring AOPëŠ” **JDK ë™ì  í”„ë¡ì‹œ** ë˜ëŠ” **CGLIB í”„ë¡ì‹œ**ë¥¼ ì‚¬ìš©

------

### 6. ì½”ë“œ ì˜ˆì œ (Spring AOP)

#### 6.1 Aspect í´ë˜ìŠ¤ ì •ì˜

```
@Aspect
@Component
public class LoggingAspect {

    @Before("execution(* com.example.service.*.*(..))")
    public void logBefore(JoinPoint joinPoint) {
        System.out.println("[LOG] Before: " + joinPoint.getSignature());
    }

    @AfterReturning("execution(* com.example.service.*.*(..))")
    public void logAfter(JoinPoint joinPoint) {
        System.out.println("[LOG] After: " + joinPoint.getSignature());
    }
}
```

#### 6.2 ì„¤ì • í´ë˜ìŠ¤

```
@Configuration
@EnableAspectJAutoProxy
@ComponentScan("com.example")
public class AppConfig { }
```

â†’ `@EnableAspectJAutoProxy`ëŠ” AOP í”„ë¡ì‹œ ê¸°ëŠ¥ì„ í™œì„±í™”ì‹œí‚´

------

### 7. Advice ì¢…ë¥˜

| ì¢…ë¥˜              | ì„¤ëª…                                                 |
| ----------------- | ---------------------------------------------------- |
| `@Before`         | ëŒ€ìƒ ë©”ì„œë“œ ì‹¤í–‰ **ì „**ì— ì‹¤í–‰                       |
| `@After`          | ëŒ€ìƒ ë©”ì„œë“œ ì‹¤í–‰ **í›„** ë¬´ì¡°ê±´ ì‹¤í–‰ (ì„±ê³µ/ì‹¤íŒ¨ ëª¨ë‘) |
| `@AfterReturning` | ëŒ€ìƒ ë©”ì„œë“œ **ì„±ê³µ í›„ì—ë§Œ** ì‹¤í–‰                     |
| `@AfterThrowing`  | ëŒ€ìƒ ë©”ì„œë“œì—ì„œ ì˜ˆì™¸ ë°œìƒ ì‹œ ì‹¤í–‰                    |
| `@Around`         | ë©”ì„œë“œ ì‹¤í–‰ ì „/í›„ **ëª¨ë‘ ì œì–´** ê°€ëŠ¥ (ê°€ì¥ ê°•ë ¥í•¨)   |

------

### 8. Pointcut ì˜ˆì‹œ

| í‘œí˜„ì‹                               | ì„¤ëª…                                 |
| ------------------------------------ | ------------------------------------ |
| `execution(* com.example..*.*(..))`  | com.example ì´í•˜ ëª¨ë“  ë©”ì„œë“œ         |
| `execution(* *..*Service.*(..))`     | ëª¨ë“  `*Service` í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì„œë“œ |
| `execution(public void delete*(..))` | ëª¨ë“  deleteë¡œ ì‹œì‘í•˜ëŠ” public ë©”ì„œë“œ |
| `within(com.example.controller..*)`  | íŠ¹ì • íŒ¨í‚¤ì§€ ë‚´ë¶€ í´ë˜ìŠ¤ ì „ì²´         |

------

### 9. AOPì˜ ì‹¤ë¬´ ì ìš© ì˜ˆ

| ê¸°ëŠ¥           | ì„¤ëª…                                       |
| -------------- | ------------------------------------------ |
| íŠ¸ëœì­ì…˜ ê´€ë¦¬  | `@Transactional`ì€ ë‚´ë¶€ì ìœ¼ë¡œ AOPë¥¼ ì‚¬ìš©í•¨ |
| ë¡œê¹… ì²˜ë¦¬      | ëª¨ë“  ì„œë¹„ìŠ¤ ë©”ì„œë“œ í˜¸ì¶œ ì „í›„ ë¡œê·¸ ë‚¨ê¸°ê¸°   |
| ì„±ëŠ¥ ì¸¡ì •      | ë©”ì„œë“œ ì‹¤í–‰ ì‹œê°„ ì¸¡ì • í›„ ë¡œê·¸ ì¶œë ¥         |
| ë³´ì•ˆ ì²´í¬      | ì¸ì¦/ì¸ê°€ ë¡œì§ Aspectë¡œ ë¶„ë¦¬               |
| ê³µí†µ ì˜ˆì™¸ ì²˜ë¦¬ | try-catchë¥¼ Aspectë¡œ ë¶„ë¦¬ ì²˜ë¦¬             |

------

### 10. AOP ì‚¬ìš© ì‹œ ì£¼ì˜ì 

| í•­ëª©                              | ì„¤ëª…                                                  |
| --------------------------------- | ----------------------------------------------------- |
| **private ë©”ì„œë“œì—ëŠ” ì ìš© ì•ˆ ë¨** | Spring AOPëŠ” í”„ë¡ì‹œ ê¸°ë°˜ â†’ public ë©”ì„œë“œë§Œ ê°€ëŠ¥       |
| **ë‚´ë¶€ ë©”ì„œë“œ í˜¸ì¶œì€ AOP ìš°íšŒë¨** | ë™ì¼ í´ë˜ìŠ¤ ë‚´ `this.ë©”ì„œë“œ()`ëŠ” í”„ë¡ì‹œë¥¼ ê±°ì¹˜ì§€ ì•ŠìŒ |
| **í”„ë¡ì‹œ ê°ì²´ í™•ì¸ ì–´ë ¤ì›€**       | ë””ë²„ê¹… ì‹œ ì‹¤ì œ í´ë˜ìŠ¤ ëŒ€ì‹  í”„ë¡ì‹œ ê°ì²´ê°€ ë°˜í™˜ë¨       |
| **ì„±ëŠ¥ ê³ ë ¤ í•„ìš”**                | Adviceê°€ ë§ì•„ì§€ë©´ ì˜¤ë²„í—¤ë“œ ë°œìƒ ê°€ëŠ¥                  |

------

### 11. AOP vs DI ì°¨ì´

| í•­ëª©      | DI (ì˜ì¡´ì„± ì£¼ì…)                   | AOP (ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°)      |
| --------- | ---------------------------------- | ------------------------------- |
| ëª©ì       | ê°ì²´ ê°„ ê´€ê³„ êµ¬ì„±                  | ê³µí†µ ë¡œì§ì˜ íš¡ë‹¨ ê´€ì‹¬ ë¶„ë¦¬      |
| ë‹¨ìœ„      | Bean, Component, Service ë“±        | Advice, Aspect, Join Point      |
| ì˜ˆì‹œ      | Controllerì— Service ì£¼ì…          | ëª¨ë“  Serviceì— ë¡œê¹… ì ìš©        |
| êµ¬í˜„ ë°©ì‹ | `@Autowired`, `@Inject`, ìƒì„±ì ë“± | `@Aspect`, `@Before`, í”„ë¡ì‹œ ë“± |

------

### 12. ìš”ì•½

| í•­ëª©            | ì„¤ëª…                                                       |
| --------------- | ---------------------------------------------------------- |
| AOPë€?          | ê³µí†µ ê¸°ëŠ¥ì„ í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ë¶„ë¦¬í•˜ì—¬ ëª¨ë“ˆí™”         |
| ì ìš© ìœ„ì¹˜       | íŠ¸ëœì­ì…˜, ë¡œê¹…, ë³´ì•ˆ, ì˜ˆì™¸ ì²˜ë¦¬ ë“±                         |
| í•µì‹¬ ì–´ë…¸í…Œì´ì…˜ | `@Aspect`, `@Before`, `@Around`, `@EnableAspectJAutoProxy` |
| êµ¬ì„± ìš”ì†Œ       | Aspect, Pointcut, Advice, JoinPoint, Weaving               |
| ì‹¤ë¬´ ê¶Œì¥ ë°©ì‹  | `@Around` + í¬ì¸íŠ¸ì»· + ë³„ë„ ëª¨ë“ˆ êµ¬ì„±ìœ¼ë¡œ ì¬ì‚¬ìš©ì„± í™•ë³´    |

## í•µì‹¬ ìš©ì–´: JoinPoint, Pointcut, Advice, Aspect

Spring AOPì—ì„œ ìì£¼ ë“±ì¥í•˜ëŠ” í•µì‹¬ ìš©ì–´ì¸ **JoinPoint**, **Pointcut**, **Advice**, **Aspect**ëŠ” AOP í”„ë¡œê·¸ë˜ë°ì˜ ì¤‘ì‹¬ ê°œë…ì…ë‹ˆë‹¤.
 ë‹¤ìŒì€ ì´ ë„¤ ê°€ì§€ë¥¼ ê°œë…, ì˜ˆì‹œ, ë‚´ë¶€ êµ¬ì¡°, ìƒí˜¸ì‘ìš©, ì‹¤ì „ ì½”ë“œì™€ í•¨ê»˜ **ê°€ì¥ ê¹Šì´ ìˆê²Œ ì •ë¦¬í•œ ìë£Œ**ì…ë‹ˆë‹¤.

------

### ğŸ”¹ í•µì‹¬ ìš©ì–´ ìš”ì•½

| ìš©ì–´          | ì˜ë¯¸ ìš”ì•½                                     |
| ------------- | --------------------------------------------- |
| **JoinPoint** | AOPê°€ ì ìš© ê°€ëŠ¥í•œ ì§€ì  (ë©”ì„œë“œ í˜¸ì¶œ ë“±)       |
| **Pointcut**  | ì–´ë–¤ JoinPointì— AOPë¥¼ ì ìš©í• ì§€ ê²°ì •í•˜ëŠ” ê·œì¹™ |
| **Advice**    | JoinPointì— ë¼ì›Œë„£ì„ ì‹¤ì œ ì‹¤í–‰ ì½”ë“œ           |
| **Aspect**    | Pointcut + Adviceë¥¼ ë¬¶ì€ ë‹¨ìœ„ (AOP ë¡œì§ ëª¨ë“ˆ) |

------

### 1. **JoinPoint**

#### âœ… ê°œë…

- í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì¤‘ì— **AOPê°€ ë¼ì–´ë“¤ ìˆ˜ ìˆëŠ” ì§€ì **
- Spring AOPì—ì„œëŠ” ì˜¤ì§ **ë©”ì„œë“œ ì‹¤í–‰(ë©”ì„œë“œ í˜¸ì¶œ)**ë§Œ JoinPointë¡œ ì·¨ê¸‰í•¨

#### âœ… ì˜ˆì‹œ

```
public void processOrder(String id)
```

â†’ ì´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ëª¨ë“  ì‹œì ì´ JoinPoint
 (Spring AOPëŠ” í•„ë“œ ì ‘ê·¼, ìƒì„±ì í˜¸ì¶œ ë“±ì˜ JoinPointëŠ” ì§€ì›í•˜ì§€ ì•ŠìŒ)

#### âœ… ì£¼ìš” API

```
@Before("execution(...)")
public void log(JoinPoint joinPoint) {
    joinPoint.getSignature();       // ë©”ì„œë“œ ì´ë¦„, ì‹œê·¸ë‹ˆì²˜
    joinPoint.getArgs();            // ì „ë‹¬ì¸ì ëª©ë¡
    joinPoint.getTarget();          // ì‹¤ì œ ëŒ€ìƒ ê°ì²´
    joinPoint.getThis();            // í”„ë¡ì‹œ ê°ì²´
}
```

------

### 2. **Pointcut**

#### âœ… ê°œë…

- AOPë¥¼ ì ìš©í•  JoinPointë¥¼ **í•„í„°ë§í•˜ëŠ” í‘œí˜„ì‹ ë˜ëŠ” ì¡°ê±´**
- ì‹¤ì œë¡œ Adviceê°€ **ì–´ëŠ ì§€ì ì— ì ìš©ë ì§€ ê²°ì •í•˜ëŠ” ë£°**

#### âœ… í‘œí˜„ ë°©ì‹

```
execution(* com.example.service.*.*(..))
```

â†’ `com.example.service` í•˜ìœ„ í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì„œë“œ

#### ì£¼ìš” í‘œí˜„ì‹ ì˜ˆì‹œ

| í‘œí˜„ì‹                                 | ì„¤ëª…                          |
| -------------------------------------- | ----------------------------- |
| `execution(* *(..))`                   | ëª¨ë“  ë©”ì„œë“œ                   |
| `execution(* com.app..*Service.*(..))` | Service í•˜ìœ„ ëª¨ë“  ë©”ì„œë“œ      |
| `within(com.example..*)`               | í•´ë‹¹ íŒ¨í‚¤ì§€ ë‚´ë¶€ í´ë˜ìŠ¤ ì „ì²´  |
| `@annotation(com.example.Loggable)`    | íŠ¹ì • ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ ë©”ì„œë“œ |

------

### 3. **Advice**

#### âœ… ê°œë…

- Pointcutìœ¼ë¡œ ì„ ì •ëœ JoinPointì— **ì‹¤ì œë¡œ ì‹¤í–‰ë  ì½”ë“œ ì¡°ê°**
- ë¡œê·¸ ì¶œë ¥, íŠ¸ëœì­ì…˜ ì²˜ë¦¬, ì˜ˆì™¸ ì²˜ë¦¬ ë“±ì„ ìˆ˜í–‰

#### âœ… ì¢…ë¥˜ì™€ ì‹¤í–‰ ì‹œì 

| ì¢…ë¥˜             | ì–´ë…¸í…Œì´ì…˜        | ì‹¤í–‰ ì‹œì                                  |
| ---------------- | ----------------- | ----------------------------------------- |
| `Before`         | `@Before`         | ë©”ì„œë“œ **í˜¸ì¶œ ì „**                        |
| `After`          | `@After`          | ë©”ì„œë“œ **ì¢…ë£Œ í›„ í•­ìƒ**                   |
| `AfterReturning` | `@AfterReturning` | **ì •ìƒ ì¢…ë£Œ í›„**                          |
| `AfterThrowing`  | `@AfterThrowing`  | **ì˜ˆì™¸ ë°œìƒ í›„**                          |
| `Around`         | `@Around`         | ë©”ì„œë“œ **ì „í›„ ëª¨ë‘ ì œì–´**, ê²°ê³¼ ë°˜í™˜ í¬í•¨ |

#### âœ… ì˜ˆì‹œ

```
@Around("execution(* com.example..*(..))")
public Object aroundLog(ProceedingJoinPoint joinPoint) throws Throwable {
    long start = System.currentTimeMillis();
    Object result = joinPoint.proceed(); // ëŒ€ìƒ ë©”ì„œë“œ ì‹¤í–‰
    long end = System.currentTimeMillis();
    System.out.println("ì‹¤í–‰ ì‹œê°„: " + (end - start) + "ms");
    return result;
}
```

------

### 4. **Aspect**

#### âœ… ê°œë…

- ì—¬ëŸ¬ Adviceì™€ Pointcutì„ **í•˜ë‚˜ì˜ ëª¨ë“ˆ ë‹¨ìœ„ë¡œ ë¬¶ì€ í´ë˜ìŠ¤**
- `@Aspect` ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì¸ í´ë˜ìŠ¤ëŠ” ìŠ¤í”„ë§ì´ **í”„ë¡ì‹œ ê°ì²´ë¡œ ë³€í™˜**

#### âœ… ì˜ˆì‹œ

```
@Aspect
@Component
public class LoggingAspect {

    @Before("execution(* com.example.service.*.*(..))")
    public void logBefore(JoinPoint jp) {
        System.out.println("ë©”ì„œë“œ ì‹œì‘: " + jp.getSignature());
    }

    @AfterReturning(pointcut = "...", returning = "result")
    public void logResult(Object result) {
        System.out.println("ê²°ê³¼: " + result);
    }
}
```

> í•˜ë‚˜ì˜ Aspect í´ë˜ìŠ¤ì— ì—¬ëŸ¬ Adviceë¥¼ ì„ ì–¸í•  ìˆ˜ ìˆìŒ

------

### 5. ìš©ì–´ ê°„ ê´€ê³„ ìš”ì•½ ê·¸ë¦¼

```
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚  Aspect    â”‚    â† ê³µí†µ ê´€ì‹¬ì‚¬ ì •ì˜ ë‹¨ìœ„
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Pointcut â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ JoinPoint(s)â”‚ â† AOP ì ìš© ëŒ€ìƒ ì§€ì 
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Advice  â”‚ â† ì‹¤ì œ ì‹¤í–‰ ë¡œì§
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

------

### 6. ì‹¤ì „ ìš”ì•½

| ìš©ì–´          | ê°œë… ìš”ì•½            | ì½”ë“œ ì˜ˆ                            |
| ------------- | -------------------- | ---------------------------------- |
| **Aspect**    | AOP ë¬¶ìŒ í´ë˜ìŠ¤      | `@Aspect` í´ë˜ìŠ¤                   |
| **Pointcut**  | ì ìš© ì¡°ê±´ ì§€ì •       | `execution(* com..*Service.*(..))` |
| **JoinPoint** | AOP ì‚½ì… ê°€ëŠ¥í•œ ì§€ì  | ë©”ì„œë“œ í˜¸ì¶œ                        |
| **Advice**    | ì‹¤ì œ ì‹¤í–‰í•  ë¶€ê°€ê¸°ëŠ¥ | `@Around`, `@Before`, `@After` ë“±  |

------

### 7. ê²°ë¡  ìš”ì•½

| í•­ëª©      | ì„¤ëª…                                     |
| --------- | ---------------------------------------- |
| JoinPoint | AOPê°€ ì‚½ì…ë  ìˆ˜ ìˆëŠ” ì‹¤ì œ ì½”ë“œ ì§€ì       |
| Pointcut  | ì–´ë–¤ JoinPointì— Adviceë¥¼ ì ìš©í• ì§€ ì§€ì •  |
| Advice    | ì‹¤ì œ ì‹¤í–‰ë  ì½”ë“œ (ë¡œê¹…, íŠ¸ëœì­ì…˜ ë“±)     |
| Aspect    | Pointcut + Adviceë¥¼ ë¬¶ì€ AOP êµ¬ì„± í´ë˜ìŠ¤ |

## `@Aspect` ì„¤ì • ë°©ì‹

- ## `@Before`, `@After`, `@Around`, `@AfterReturning`, `@AfterThrowing`

  ë‹¤ìŒì€ Spring AOPì—ì„œ ì‚¬ìš©ë˜ëŠ” í•µì‹¬ Advice ì–´ë…¸í…Œì´ì…˜ì¸
   **`@Before`, `@After`, `@Around`, `@AfterReturning`, `@AfterThrowing`**
   ê°ê°ì˜ **ì •ì˜, ì‹¤í–‰ ì‹œì , ìš©ë„, ì½”ë“œ ì˜ˆì‹œ, íŒŒë¼ë¯¸í„° ì²˜ë¦¬ ë°©ì‹** ë“±ì„ í¬í•¨í•œ **ê°€ì¥ ê¹Šì´ ìˆê³  ì‹¤ì „ ì¤‘ì‹¬ì ì¸ ì„¤ëª…**ì…ë‹ˆë‹¤.

  ------

  ### Spring AOP Advice ì–´ë…¸í…Œì´ì…˜

  | ì–´ë…¸í…Œì´ì…˜        | ì‹¤í–‰ ì‹œì                | ì˜ˆì™¸ ì‹œ ì‹¤í–‰ ì—¬ë¶€ | ë°˜í™˜ê°’ ì ‘ê·¼ | ì˜ˆì™¸ ì ‘ê·¼ | ëŒ€í‘œ ìš©ë„                   |
  | ----------------- | ----------------------- | ----------------- | ----------- | --------- | --------------------------- |
  | `@Before`         | ë©”ì„œë“œ ì‹¤í–‰ **ì „**      | âŒ                 | âŒ           | âŒ         | ì…ë ¥ ê°’ ê²€ì¦, ë¡œê·¸ ì‹œì‘     |
  | `@After`          | ë©”ì„œë“œ ì‹¤í–‰ **í›„ í•­ìƒ** | âœ…                 | âŒ           | âŒ         | ì •ë¦¬ ì‘ì—… (ë¬´ì¡°ê±´ ì‹¤í–‰)     |
  | `@AfterReturning` | ë©”ì„œë“œ **ì •ìƒ ì¢…ë£Œ í›„** | âŒ                 | âœ…           | âŒ         | ê²°ê³¼ ë¡œê·¸, ìºì‹œ             |
  | `@AfterThrowing`  | ë©”ì„œë“œ **ì˜ˆì™¸ ë°œìƒ ì‹œ** | âœ…                 | âŒ           | âœ…         | ì˜ˆì™¸ ë¡œê¹…, íŠ¸ëœì­ì…˜ ë¡¤ë°±    |
  | `@Around`         | **ì „/í›„/ì˜ˆì™¸ ëª¨ë‘**     | âœ…                 | âœ…           | âœ…         | ì‹¤í–‰ ì‹œê°„ ì¸¡ì •, ì»¤ìŠ¤í…€ ì œì–´ |

  ------

  ### 1. `@Before`

  #### âœ… ì„¤ëª…

  - ëŒ€ìƒ ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ê¸° **ì§ì „ì— ì‹¤í–‰**
  - ì „ë‹¬ë˜ëŠ” ì¸ì í™•ì¸ ë˜ëŠ” ì‚¬ì „ ë¡œê·¸ ì²˜ë¦¬ì— ì í•©

  #### âœ… ì˜ˆì‹œ

  ```
  @Before("execution(* com.example.service.*.*(..))")
  public void beforeLog(JoinPoint jp) {
      System.out.println("Before: " + jp.getSignature());
  }
  ```

  ------

  ### 2. `@After`

  #### âœ… ì„¤ëª…

  - ëŒ€ìƒ ë©”ì„œë“œê°€ ì‹¤í–‰ëœ í›„, **ì •ìƒ/ì˜ˆì™¸ ê´€ê³„ì—†ì´ ë¬´ì¡°ê±´ ì‹¤í–‰**
  - ë¦¬ì†ŒìŠ¤ í•´ì œ, ë¡œê·¸ ë§ˆë¬´ë¦¬ ë“±ì— ì‚¬ìš©

  #### âœ… ì˜ˆì‹œ

  ```
  @After("execution(* com.example.service.*.*(..))")
  public void afterLog(JoinPoint jp) {
      System.out.println("After: " + jp.getSignature());
  }
  ```

  ------

  ### 3. `@AfterReturning`

  #### âœ… ì„¤ëª…

  - ëŒ€ìƒ ë©”ì„œë“œê°€ **ì •ìƒì ìœ¼ë¡œ ë°˜í™˜ë˜ì—ˆì„ ë•Œë§Œ** ì‹¤í–‰
  - ë¦¬í„´ê°’ì„ Advice ë©”ì„œë“œì— ì „ë‹¬ë°›ì„ ìˆ˜ ìˆìŒ

  #### âœ… ì˜ˆì‹œ

  ```
  @AfterReturning(
      pointcut = "execution(* com.example.service.*.*(..))",
      returning = "result")
  public void afterReturn(Object result) {
      System.out.println("Return value: " + result);
  }
  ```

  - `returning` ì†ì„±ì˜ ê°’ì€ **Advice ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„° ì´ë¦„ê³¼ ë™ì¼í•´ì•¼ í•¨**

  ------

  ### 4. `@AfterThrowing`

  #### âœ… ì„¤ëª…

  - ëŒ€ìƒ ë©”ì„œë“œì—ì„œ **ì˜ˆì™¸ê°€ ë˜ì ¸ì¡Œì„ ë•Œë§Œ** ì‹¤í–‰
  - ì˜ˆì™¸ ë¡œê·¸, ëª¨ë‹ˆí„°ë§, ì•Œë¦¼ ë“±ì— ì‚¬ìš©

  #### âœ… ì˜ˆì‹œ

  ```
  @AfterThrowing(
      pointcut = "execution(* com.example.service.*.*(..))",
      throwing = "ex")
  public void afterThrowing(Throwable ex) {
      System.out.println("ì˜ˆì™¸ ë°œìƒ: " + ex.getMessage());
  }
  ```

  ------

  ### 5. `@Around`

  #### âœ… ì„¤ëª…

  - ëŒ€ìƒ ë©”ì„œë“œì˜ ì‹¤í–‰ì„ **ì™„ì „íˆ ê°ì‹¸ì„œ ì „í›„/ì˜ˆì™¸ ëª¨ë‘ ì²˜ë¦¬**
  - `proceed()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì•¼ ëŒ€ìƒ ë©”ì„œë“œê°€ ì‹¤í–‰ë¨
  - **ê°€ì¥ ê°•ë ¥í•˜ê³  ë²”ìš©ì ì¸ Advice**

  #### âœ… ì˜ˆì‹œ

  ```
  @Around("execution(* com.example.service.*.*(..))")
  public Object aroundAdvice(ProceedingJoinPoint pjp) throws Throwable {
      System.out.println("Before ì‹¤í–‰");
  
      try {
          Object result = pjp.proceed(); // ëŒ€ìƒ ë©”ì„œë“œ í˜¸ì¶œ
          System.out.println("AfterReturning ì‹¤í–‰");
          return result;
      } catch (Throwable ex) {
          System.out.println("AfterThrowing ì‹¤í–‰");
          throw ex;
      } finally {
          System.out.println("After ì‹¤í–‰");
      }
  }
  ```

  #### âœ… ì£¼ìš” API

  | ë©”ì„œë“œ               | ì„¤ëª…                  |
  | -------------------- | --------------------- |
  | `pjp.getArgs()`      | ë©”ì„œë“œ ì¸ì ë°°ì—´      |
  | `pjp.getSignature()` | ë©”ì„œë“œ ì •ë³´           |
  | `pjp.proceed()`      | ì‹¤ì œ ëŒ€ìƒ ë©”ì„œë“œ ì‹¤í–‰ |

  ------

  ### ì‹¤ë¬´ íŒ¨í„´ë³„ ì¶”ì²œ Advice

  | ìƒí™©                   | ì¶”ì²œ Advice                  |
  | ---------------------- | ---------------------------- |
  | ë©”ì„œë“œ í˜¸ì¶œ ë¡œê·¸       | `@Before`, `@After`          |
  | ë©”ì„œë“œ ì‹¤í–‰ ì‹œê°„ ì¸¡ì •  | `@Around`                    |
  | ê²°ê³¼ê°’ ìºì‹œ ì²˜ë¦¬       | `@AfterReturning`            |
  | ì˜ˆì™¸ ë°œìƒ ì‹œ ìŠ¬ë™ ì•Œë¦¼ | `@AfterThrowing`             |
  | ê³µí†µ íŠ¸ëœì­ì…˜ ì²˜ë¦¬     | `@Around` + `@Transactional` |

  ------

  ### ì£¼ì˜ ì‚¬í•­

  - `@Before`, `@AfterReturning`ì€ **ë¦¬í„´ê°’ ì¡°ì‘ ë¶ˆê°€**
  - `@Around`ë§Œì´ ìœ ì¼í•˜ê²Œ **ë¦¬í„´ê°’ ë³€ê²½ ë° ì‹¤í–‰ ì¤‘ë‹¨ ê°€ëŠ¥**
  - AdviceëŠ” ë°˜ë“œì‹œ Springì´ ê´€ë¦¬í•˜ëŠ” **í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ ì‹¤í–‰ë¨**

  ------

  ### ì „ì²´ íë¦„ ìš”ì•½ (ì •ìƒ ì¢…ë£Œ ê¸°ì¤€)

  ```
  í´ë¼ì´ì–¸íŠ¸ ìš”ì²­
      â†“
  @Before Advice
      â†“
  @Around - before
      â†“
  (Target Method ì‹¤í–‰)
      â†“
  @Around - after
      â†“
  @AfterReturning
      â†“
  @After
      â†“
  ì‘ë‹µ ë°˜í™˜
  ```

## AOP í”„ë¡ì‹œ êµ¬í˜„ ë°©ì‹

- ## JDK Dynamic Proxy

  **JDK Dynamic Proxy**ëŠ” Javaì—ì„œ ì œê³µí•˜ëŠ” **ëŸ°íƒ€ì„ í”„ë¡ì‹œ ê°ì²´ ìƒì„± ê¸°ìˆ **ë¡œ,
   ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ì˜ í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ **ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬**í•˜ê±°ë‚˜ **ê³µí†µ ê¸°ëŠ¥ì„ ë©”ì„œë“œ í˜¸ì¶œ ì „í›„ì— ì‚½ì…**í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê°•ë ¥í•œ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.
   Spring AOPì˜ í•µì‹¬ ê¸°ë°˜ ì¤‘ í•˜ë‚˜ì´ë©°, AspectJ ì—†ì´ë„ ë™ì‘í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

  ------

  ### âœ… 1. ê°œë… ìš”ì•½

  - **JDK Dynamic Proxy**ëŠ” **ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ê°ì²´**ì— ëŒ€í•´ **í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ëŸ°íƒ€ì„ì— ìƒì„±**
  - ì‹¤ì œ ëŒ€ìƒ ê°ì²´(Method Target)ì˜ **ë©”ì„œë“œ í˜¸ì¶œì„ ê°€ë¡œì±„ì„œ ê°€ê³µí•˜ê±°ë‚˜ í™•ì¥**í•  ìˆ˜ ìˆìŒ
  - Java SE í‘œì¤€ APIë§Œìœ¼ë¡œ ë™ì‘

  ------

  ### âœ… 2. ë™ì‘ êµ¬ì¡°

  ```
  í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ â†’ í”„ë¡ì‹œ ê°ì²´ â†’ InvocationHandler â†’ ì‹¤ì œ êµ¬í˜„ì²´
  ```

  - í”„ë¡ì‹œëŠ” ì§€ì •ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ê³ , í˜¸ì¶œëœ ë©”ì„œë“œëŠ” ëª¨ë‘ `InvocationHandler`ë¡œ ìœ„ì„ë¨
  - `InvocationHandler`ëŠ” ì¤‘ê°„ì—ì„œ **ê³µí†µ ë¡œì§ ì²˜ë¦¬ + ì‹¤ì œ ë©”ì„œë“œ í˜¸ì¶œ**ì„ ë‹´ë‹¹

  ------

  ### âœ… 3. í•µì‹¬ í´ë˜ìŠ¤ ë° ì¸í„°í˜ì´ìŠ¤

  | í´ë˜ìŠ¤/ì¸í„°í˜ì´ìŠ¤                     | ì„¤ëª…                                   |
  | ------------------------------------- | -------------------------------------- |
  | `java.lang.reflect.Proxy`             | í”„ë¡ì‹œ í´ë˜ìŠ¤ ìƒì„± ë„êµ¬                |
  | `java.lang.reflect.InvocationHandler` | í”„ë¡ì‹œì˜ ë©”ì„œë“œ í˜¸ì¶œì„ ê°€ë¡œì±„ëŠ” í•¸ë“¤ëŸ¬ |

  ------

  ### âœ… 4. ê¸°ë³¸ ì˜ˆì œ

  #### 1. ëŒ€ìƒ ì¸í„°í˜ì´ìŠ¤

  ```
  public interface HelloService {
      String sayHello(String name);
  }
  ```

  #### 2. ëŒ€ìƒ êµ¬í˜„ì²´

  ```
  public class HelloServiceImpl implements HelloService {
      public String sayHello(String name) {
          return "Hello, " + name;
      }
  }
  ```

  #### 3. í”„ë¡ì‹œ ìƒì„±

  ```
  HelloService target = new HelloServiceImpl();
  
  HelloService proxy = (HelloService) Proxy.newProxyInstance(
      HelloService.class.getClassLoader(),
      new Class[]{HelloService.class},
      new InvocationHandler() {
          @Override
          public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
              System.out.println("[Before] " + method.getName());
              Object result = method.invoke(target, args);
              System.out.println("[After] " + method.getName());
              return result;
          }
      }
  );
  ```

  #### 4. ì‹¤í–‰ ê²°ê³¼

  ```
  proxy.sayHello("Spring");
  
  // ì¶œë ¥
  [Before] sayHello
  [After] sayHello
  ```

  ------

  ### âœ… 5. íŠ¹ì§•

  | í•­ëª©                | ì„¤ëª…                                               |
  | ------------------- | -------------------------------------------------- |
  | **ì¸í„°í˜ì´ìŠ¤ í•„ìš”** | ë°˜ë“œì‹œ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë§Œ í”„ë¡ì‹œ ê°€ëŠ¥    |
  | **ëŸ°íƒ€ì„ ìƒì„±**     | ì»´íŒŒì¼ ì‹œì ì´ ì•„ë‹Œ **ì‹¤í–‰ ì‹œì ì— í´ë˜ìŠ¤ ìƒì„±**     |
  | **ë¦¬í”Œë ‰ì…˜ ì‚¬ìš©**   | `Method.invoke()`ë¡œ ë©”ì„œë“œ í˜¸ì¶œ                    |
  | **ì„±ëŠ¥**            | ê¸°ë³¸ì ìœ¼ë¡œ ë¹ ë¥´ë‚˜, ëŒ€ëŸ‰ ì²˜ë¦¬ ì‹œ ë¦¬í”Œë ‰ì…˜ ë¹„ìš© ì£¼ì˜ |

  ------

  ### âœ… 6. Spring AOPì—ì„œì˜ í™œìš©

  Spring AOPëŠ” í”„ë¡ì‹œ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ë©° ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬ëœë‹¤:

  | ìƒí™©                                   | ì‚¬ìš© í”„ë¡ì‹œ ë°©ì‹             |
  | -------------------------------------- | ---------------------------- |
  | ëŒ€ìƒì´ **ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ Bean**ì¼ ê²½ìš° | âœ… **JDK Dynamic Proxy** ì‚¬ìš© |
  | ëŒ€ìƒì´ **êµ¬í˜„ì²´ í´ë˜ìŠ¤ë§Œ ìˆì„ ê²½ìš°**   | âŒ â†’ **CGLIB Proxy** ì‚¬ìš©     |

  Spring ì„¤ì •:

  ```
  @EnableAspectJAutoProxy(proxyTargetClass = false) // ê¸°ë³¸: JDK Proxy
  ```

  ------

  ### âœ… 7. ì¥ì ê³¼ ë‹¨ì 

  #### âœ… ì¥ì 

  - Java ê¸°ë³¸ APIë§Œìœ¼ë¡œ ë™ì‘ (AspectJ ë¶ˆí•„ìš”)
  - ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ëœ ì„œë¹„ìŠ¤ì— ì í•©
  - ê°ì²´ ë‚´ë¶€ ë³€ê²½ ì—†ì´ ì™¸ë¶€ ë¡œì§ ì‚½ì… ê°€ëŠ¥

  #### âš ï¸ ë‹¨ì 

  - **ì¸í„°í˜ì´ìŠ¤ê°€ ë°˜ë“œì‹œ í•„ìš”**
  - ë‚´ë¶€ ë©”ì„œë“œ í˜¸ì¶œ(this)ì€ í”„ë¡ì‹œë¥¼ ê±°ì¹˜ì§€ ì•ŠìŒ
  - ë¦¬í”Œë ‰ì…˜ ì„±ëŠ¥ ì €í•˜ ì´ìŠˆ (í¬ë¦¬í‹°ì»¬í•œ ê²½ìš°ë§Œ)

  ------

  ### âœ… 8. ë™ì‘ íë¦„ ìš”ì•½

  ```
  Proxy.newProxyInstance()
     â””â”€> í´ë˜ìŠ¤ ë¡œë”, ì¸í„°í˜ì´ìŠ¤ ëª©ë¡, InvocationHandler ì „ë‹¬
         â””â”€> í”„ë¡ì‹œ í´ë˜ìŠ¤ ìƒì„± ë° ë°”ì´íŠ¸ì½”ë“œ ë™ì  ìƒì„±
             â””â”€> method í˜¸ì¶œ â†’ invoke() ë‚´ë¶€ì—ì„œ ê°€ë¡œì±„ ì²˜ë¦¬
  ```

  ------

  ### âœ… 9. ì‹¤ë¬´ì—ì„œì˜ í™œìš© ì˜ˆ

  | í™œìš© ì˜ˆ                            | ì„¤ëª…                                         |
  | ---------------------------------- | -------------------------------------------- |
  | Spring AOP ê¸°ë³¸ êµ¬í˜„               | JDK ë™ì  í”„ë¡ì‹œ ê¸°ë°˜ìœ¼ë¡œ ë¡œê¹…, íŠ¸ëœì­ì…˜ êµ¬í˜„ |
  | Javaì—ì„œ ìì²´ AOP êµ¬ì„±             | DI ì—†ì´ ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ í”„ë¡ì‹œ êµ¬í˜„ ê°€ëŠ¥     |
  | ë‹¤ì¤‘ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ í´ë˜ìŠ¤ ê°ì‹¸ê¸° | ì¸í„°í˜ì´ìŠ¤ë³„ ë¡œì§ ë¶„ë¦¬ ê°€ëŠ¥                  |
  | í…ŒìŠ¤íŠ¸ ì‹œ Mock í”„ë¡ì‹œ ì‘ì„±         | JDK Proxyë¡œ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ìš© í”„ë¡ì‹œ ì‘ì„± ê°€ëŠ¥ |

  ------

  ### âœ… 10. ëŒ€ì²´ ê¸°ìˆ : CGLIBê³¼ ë¹„êµ

  | í•­ëª©                      | JDK Dynamic Proxy      | CGLIB Proxy               |
  | ------------------------- | ---------------------- | ------------------------- |
  | ëŒ€ìƒ í•„ìš” ìš”ì†Œ            | ì¸í„°í˜ì´ìŠ¤ ë°˜ë“œì‹œ í•„ìš” | í´ë˜ìŠ¤ë§Œ ìˆì–´ë„ ê°€ëŠ¥      |
  | í”„ë¡ì‹œ ë°©ì‹               | ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ í”„ë¡ì‹œ | í´ë˜ìŠ¤ ìƒì† ê¸°ë°˜ í”„ë¡ì‹œ   |
  | ë¦¬í”Œë ‰ì…˜ ì‚¬ìš© ì—¬ë¶€        | ì‚¬ìš©                   | ë°”ì´íŠ¸ì½”ë“œ ìƒì„±           |
  | ì„±ëŠ¥                      | ì•½ê°„ ë‚®ìŒ              | ë¹ ë¥´ì§€ë§Œ ë¬´ê²ê³  ì œì•½ ìˆìŒ |
  | Spring ê¸°ë³¸ ì‚¬ìš© ìš°ì„ ìˆœìœ„ | JDK â†’ CGLIB ìˆœ         |                           |

  ------

  ### âœ… ìš”ì•½

  | í•­ëª©            | ì„¤ëª…                                                         |
  | --------------- | ------------------------------------------------------------ |
  | ëª©ì             | ëŸ°íƒ€ì„ ì‹œ ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ê°ì²´ì˜ í˜¸ì¶œì„ ê°€ë¡œì±„ê¸° ìœ„í•œ í”„ë¡ì‹œ ìƒì„± |
  | í•µì‹¬ API        | `Proxy`, `InvocationHandler`                                 |
  | ìŠ¤í”„ë§ AOP í™œìš© | ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ì¼ ê²½ìš° JDK í”„ë¡ì‹œ ì‚¬ìš©                       |
  | ì‹¤ë¬´ ì ìš©       | ê³µí†µ ë¡œì§ ì‚½ì…, íŠ¸ëœì­ì…˜, ë¡œê¹…, ì¸ì¦, ì»¤ìŠ¤í…€ í”„ë ˆì„ì›Œí¬ ë“±   |
  | ëŒ€ì•ˆ ê¸°ìˆ        | í´ë˜ìŠ¤ ê¸°ë°˜ì´ë¼ë©´ CGLIB ì‚¬ìš© í•„ìš”                            |

- ## CGLIB Proxy

  ë‹¤ìŒì€ **CGLIB Proxy (Code Generation Library)**ì— ëŒ€í•œ ê°€ì¥ ê¹Šì´ ìˆê³  ì²´ê³„ì ì¸ ì„¤ëª…ì´ë‹¤.
   Spring AOPì—ì„œ JDK ë™ì  í”„ë¡ì‹œë¥¼ ëŒ€ì²´í•˜ëŠ” ì¤‘ìš”í•œ ê¸°ìˆ ì´ë©°, **í´ë˜ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëŸ°íƒ€ì„ í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±**í•˜ì—¬ ë‹¤ì–‘í•œ AOP ê¸°ëŠ¥ì„ ê°€ëŠ¥í•˜ê²Œ í•´ì¤€ë‹¤.

  ------

  ### âœ… 1. CGLIB Proxyë€?

  **CGLIB (Code Generation Library)**ëŠ” **í´ë˜ìŠ¤ë¥¼ ìƒì†í•˜ì—¬ í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë°”ì´íŠ¸ì½”ë“œ ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬**ë‹¤.

  - ëŒ€ìƒ ê°ì²´ê°€ **ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì§€ ì•Šì•„ë„** í”„ë¡ì‹œ ê°€ëŠ¥
  - **ëŸ°íƒ€ì„ì— ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ìƒì„±**í•˜ê³ , ê·¸ í´ë˜ìŠ¤ê°€ ì›ë³¸ í´ë˜ìŠ¤ë¥¼ **ìƒì†**í•˜ì—¬ ë™ì‘

  > Spring AOPì—ì„œëŠ” ëŒ€ìƒ í´ë˜ìŠ¤ê°€ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì§€ ì•Šì•˜ì„ ê²½ìš°, ìë™ìœ¼ë¡œ CGLIBì„ ì‚¬ìš©í•¨.

  ------

  ### âœ… 2. CGLIB Proxy vs JDK Dynamic Proxy

  | í•­ëª©                 | CGLIB Proxy                         | JDK Dynamic Proxy             |
  | -------------------- | ----------------------------------- | ----------------------------- |
  | í”„ë¡ì‹œ ë°©ì‹          | **í´ë˜ìŠ¤ ìƒì†** ê¸°ë°˜                | **ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„** ê¸°ë°˜      |
  | ì¸í„°í˜ì´ìŠ¤ í•„ìš” ì—¬ë¶€ | âŒ í•„ìš” ì—†ìŒ                         | âœ… ì¸í„°í˜ì´ìŠ¤ í•„ìˆ˜             |
  | í”„ë¡ì‹œ ëŒ€ìƒ ì œí•œ     | `final` í´ë˜ìŠ¤/ë©”ì„œë“œëŠ” í”„ë¡ì‹œ ë¶ˆê°€ | ì—†ìŒ (ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ì´ë¯€ë¡œ)  |
  | Spring ê¸°ë³¸ ë™ì‘     | ëŒ€ìƒì´ í´ë˜ìŠ¤ë©´ ìë™ ì ìš©           | ëŒ€ìƒì´ ì¸í„°í˜ì´ìŠ¤ë©´ ìš°ì„  ì ìš© |
  | ì„±ëŠ¥                 | JDKë³´ë‹¤ ì•½ê°„ ë¹ ë¦„ (ìºì‹œ ì´í›„)       | ì•½ê°„ ëŠë¦¼ (ë¦¬í”Œë ‰ì…˜ ê¸°ë°˜)     |
  | ë°”ì´íŠ¸ì½”ë“œ ìˆ˜ì • ì—¬ë¶€ | âœ… ìˆìŒ (ASM ë˜ëŠ” ByteBuddy ê¸°ë°˜)    | âŒ ì—†ìŒ                        |

  ------

  ### âœ… 3. Spring AOPì—ì„œ CGLIBì´ ì‚¬ìš©ë˜ëŠ” ì¡°ê±´

  Springì—ì„œ AOP í”„ë¡ì‹œ ë°©ì‹ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ìŒ ê¸°ì¤€ì— ë”°ë¼ ê²°ì •ëœë‹¤:

  #### â–¶ ê¸°ë³¸ ì„¤ì •

  ```
  @EnableAspectJAutoProxy(proxyTargetClass = false) // ê¸°ë³¸ê°’: false â†’ JDK Proxy ìš°ì„ 
  ```

  #### â–¶ ê°•ì œë¡œ CGLIB ì‚¬ìš©í•˜ë ¤ë©´:

  ```
  @EnableAspectJAutoProxy(proxyTargetClass = true)
  ```

  ------

  ### âœ… 4. ë™ì‘ êµ¬ì¡° ìš”ì•½

  1. ëŒ€ìƒ í´ë˜ìŠ¤ì˜ ë°”ì´íŠ¸ì½”ë“œë¥¼ ë¶„ì„
  2. í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ **ìƒì†**í•˜ëŠ” ìƒˆë¡œìš´ í´ë˜ìŠ¤ ë™ì ìœ¼ë¡œ ìƒì„±
  3. ì¬ì •ì˜ëœ ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ **Advice â†’ ëŒ€ìƒ ë©”ì„œë“œ** ì‹¤í–‰
  4. í”„ë¡ì‹œ ê°ì²´ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡

  ------

  ### âœ… 5. ì‹¤ìŠµ ì˜ˆì œ

  ```
  public class HelloService {
      public String hello(String name) {
          return "Hello, " + name;
      }
  }
  ```

  ```
  Enhancer enhancer = new Enhancer();
  enhancer.setSuperclass(HelloService.class);
  enhancer.setCallback(new MethodInterceptor() {
      @Override
      public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable {
          System.out.println("[Before] " + method.getName());
          Object result = proxy.invokeSuper(obj, args); // ì›ë³¸ ë©”ì„œë“œ í˜¸ì¶œ
          System.out.println("[After] " + method.getName());
          return result;
      }
  });
  
  HelloService proxy = (HelloService) enhancer.create();
  proxy.hello("Spring");
  ```

  #### ê²°ê³¼

  ```
  [Before] hello
  [After] hello
  ```

  ------

  ### âœ… 6. ì£¼ìš” API

  | í´ë˜ìŠ¤/ì¸í„°í˜ì´ìŠ¤   | ì„¤ëª…                                          |
  | ------------------- | --------------------------------------------- |
  | `Enhancer`          | CGLIB í”„ë¡ì‹œ ê°ì²´ ìƒì„±ê¸°                      |
  | `MethodInterceptor` | JDKì˜ `InvocationHandler`ì™€ ìœ ì‚¬í•œ ì¸í„°í˜ì´ìŠ¤ |
  | `MethodProxy`       | `invokeSuper()`ë¥¼ í†µí•´ ì›ë³¸ ë©”ì„œë“œ í˜¸ì¶œ       |

  ------

  ### âœ… 7. í”„ë¡ì‹œ ê°ì²´ì˜ ìƒì„± ë°©ì‹

  CGLIBì€ **ASM / ByteBuddy**ì™€ ê°™ì€ ë°”ì´íŠ¸ì½”ë“œ ì¡°ì‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒì„ ìˆ˜í–‰í•¨:

  - ëŸ°íƒ€ì„ì— ëŒ€ìƒ í´ë˜ìŠ¤ë¥¼ **extends**
  - ë©”ì„œë“œë¥¼ overrideí•˜ì—¬ ì¤‘ê°„ì— **Advice ì½”ë“œ ì‚½ì…**
  - ìƒì„±ëœ í”„ë¡ì‹œ í´ë˜ìŠ¤ëŠ” **ìºì‹œë˜ì–´ ì¬ì‚¬ìš© ê°€ëŠ¥**

  ------

  ### âœ… 8. ì£¼ì˜ ì‚¬í•­

  | í•­ëª©                           | ì„¤ëª…                                                         |
  | ------------------------------ | ------------------------------------------------------------ |
  | **`final` í´ë˜ìŠ¤/ë©”ì„œë“œ ê¸ˆì§€** | ìƒì† ê¸°ë°˜ì´ë¯€ë¡œ override ë¶ˆê°€í•œ ê²½ìš° í”„ë¡ì‹œ ìƒì„± ì‹¤íŒ¨        |
  | **ìƒì„±ì í˜¸ì¶œ ë¬¸ì œ**           | ìƒì„±ìëŠ” í”„ë¡ì‹œí™” ë¶ˆê°€ëŠ¥ â†’ ìƒì„±ì ë‚´ë¶€ ë¡œì§ì€ ê°€ë¡œì±Œ ìˆ˜ ì—†ìŒ |
  | **private ë©”ì„œë“œ**             | override ë¶ˆê°€ â†’ AOP ì ìš© ë¶ˆê°€                                |
  | **ë‚´ë¶€ í˜¸ì¶œ ìš°íšŒ ë¬¸ì œ**        | this.ë©”ì„œë“œ() í˜¸ì¶œì€ í”„ë¡ì‹œë¥¼ ê±°ì¹˜ì§€ ì•ŠìŒ â†’ AOP ì ìš© ì•ˆ ë¨   |

  ------

  ### âœ… 9. ì‹¤ë¬´ ì‚¬ìš© ì˜ˆ

  | ìƒí™©                                     | ì„¤ëª…                          |
  | ---------------------------------------- | ----------------------------- |
  | ì¸í„°í˜ì´ìŠ¤ê°€ ì—†ëŠ” ë ˆê±°ì‹œ í´ë˜ìŠ¤ í”„ë¡ì‹œí™” | JDK Proxyë¡œ ë¶ˆê°€ â†’ CGLIB ì‚¬ìš© |
  | ê³µí†µ ë¡œì§ ì‚½ì… (ë¡œê¹…, íŠ¸ëœì­ì…˜ ë“±)       | í”„ë¡ì‹œ ê¸°ë°˜ AOP êµ¬ì„±          |
  | @Transactionalì´ í´ë˜ìŠ¤ì— ì ìš©ëœ ê²½ìš°    | CGLIBì´ íŠ¸ëœì­ì…˜ í”„ë¡ì‹œ ìƒì„±  |

  ------

  ### âœ… 10. AOP í”„ë¡ì‹œ ì ìš© ì—¬ë¶€ íŒë‹¨ ê¸°ì¤€

  | ëŒ€ìƒ Bean íŠ¹ì„±               | Springì´ ì„ íƒí•˜ëŠ” í”„ë¡ì‹œ ë°©ì‹     |
  | ---------------------------- | --------------------------------- |
  | ì¸í„°í˜ì´ìŠ¤ë§Œ ì¡´ì¬            | JDK Dynamic Proxy                 |
  | í´ë˜ìŠ¤ë§Œ ì¡´ì¬                | CGLIB Proxy                       |
  | `proxyTargetClass=true` ì„¤ì • | í•­ìƒ CGLIB ì‚¬ìš©                   |
  | `final` í´ë˜ìŠ¤ or ë©”ì„œë“œ     | âŒ CGLIB ì‚¬ìš© ë¶ˆê°€, ì˜ˆì™¸ ë°œìƒ ê°€ëŠ¥ |

  ------

  ### âœ… 11. Spring Bootì—ì„œ AOP ì„¤ì • ë°©ì‹

  ```
  spring:
    aop:
      proxy-target-class: true # CGLIB ê°•ì œ ì‚¬ìš©
  ```

  ------

  ### âœ… 12. ìš”ì•½

  | í•­ëª©        | ì„¤ëª…                                            |
  | ----------- | ----------------------------------------------- |
  | ì •ì˜        | ëŒ€ìƒ í´ë˜ìŠ¤ë¥¼ ìƒì†í•˜ì—¬ í”„ë¡ì‹œ í´ë˜ìŠ¤ ìƒì„±       |
  | ê¸°ë°˜ ê¸°ìˆ    | ASM, ByteBuddy                                  |
  | í”„ë¡ì‹œ ì¡°ê±´ | í´ë˜ìŠ¤ ê¸°ë°˜, ì¸í„°í˜ì´ìŠ¤ ì—†ì–´ë„ ê°€ëŠ¥             |
  | ì£¼ì˜ì       | final, private, ìƒì„±ì í˜¸ì¶œ ë¶ˆê°€                |
  | Spring ì ìš© | ì¸í„°í˜ì´ìŠ¤ ì—†ëŠ” Beanì— ìë™ ì ìš©ë¨              |
  | ì‹¤ë¬´ í™œìš©   | íŠ¸ëœì­ì…˜, ë¡œê¹…, ë³´ì•ˆ, ë ˆê±°ì‹œ í´ë˜ìŠ¤ í”„ë¡ì‹œ ì²˜ë¦¬ |

## ì‹¤ì „ í™œìš© ì˜ˆ

- ## ë¡œê¹…

  ë‹¤ìŒì€ **Spring ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œì˜ ë¡œê¹…(logging)**ì— ëŒ€í•œ **ê°€ì¥ ê¹Šì´ ìˆê³  ì‹¤ë¬´ ì¤‘ì‹¬ì ì¸ ì„¤ëª…**ì…ë‹ˆë‹¤.
   Javaì˜ ì „í†µì  ë¡œê¹… ê°œë…ë¶€í„°, Spring Bootì—ì„œì˜ ë¡œê¹… ì„¤ì •, ì£¼ìš” ë¡œê¹… í”„ë ˆì„ì›Œí¬(SLF4J, Logback, Log4j2), AOP ê¸°ë°˜ ë¡œê¹…, MDC í™œìš©ë²•, ê·¸ë¦¬ê³  ë¡œê·¸ ì „ëµê¹Œì§€ ì „ë¶€ í¬í•¨í•©ë‹ˆë‹¤.

  ------

  ### âœ… 1. ë¡œê¹…ì´ë€?

  **ë¡œê¹…(logging)**ì€ **í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ íë¦„, ìƒíƒœ, ì˜¤ë¥˜, ë””ë²„ê¹… ì •ë³´ ë“±ì„ ì™¸ë¶€ë¡œ ì¶œë ¥**í•˜ì—¬
   ì‹œìŠ¤í…œì˜ **ìƒíƒœ ì¶”ì  ë° ë¬¸ì œ í•´ê²°, ë³´ì•ˆ ê°ì‹œ, í†µê³„ ë¶„ì„**ì— í™œìš©ë˜ëŠ” í•µì‹¬ ë„êµ¬ì´ë‹¤.

  > `System.out.println()`ì€ ê°„ë‹¨í•˜ì§€ë§Œ ì„±ëŠ¥, í™•ì¥ì„±, ê´€ë¦¬ ì¸¡ë©´ì—ì„œ ë¶€ì ì ˆí•¨
  >  â†’ **ì „ë¬¸ ë¡œê¹… í”„ë ˆì„ì›Œí¬**ë¥¼ ì‚¬ìš©í•´ì•¼ í•¨

  ------

  ### âœ… 2. Java ë¡œê¹… ì‹œìŠ¤í…œ ê°œìš”

  | ê³„ì¸µ                    | ì˜ˆì‹œ                                 |
  | ----------------------- | ------------------------------------ |
  | Logging API í‘œì¤€í™” ê³„ì¸µ | **SLF4J**, **JUL**, Commons Logging  |
  | ì‹¤ì œ êµ¬í˜„ì²´             | **Logback**, Log4j2, JUL, tinylog ë“± |
  | Spring Boot ê¸°ë³¸ ì„¤ì •   | **SLF4J + Logback** ì¡°í•©             |

  ------

  ### âœ… 3. SLF4J (Simple Logging Facade for Java)

  #### ì—­í• 

  - **ë¡œê¹… ì¶”ìƒí™” ê³„ì¸µ** (Facade)
  - ë‹¤ì–‘í•œ êµ¬í˜„ì²´(Logback, Log4j2 ë“±)ì— **ì¢…ì†ë˜ì§€ ì•Šê³  ì½”ë”© ê°€ëŠ¥**

  #### ì‚¬ìš© ì˜ˆ

  ```
  import org.slf4j.Logger;
  import org.slf4j.LoggerFactory;
  
  public class MyService {
      private static final Logger log = LoggerFactory.getLogger(MyService.class);
  
      public void run() {
          log.info("ì„œë¹„ìŠ¤ ì‹¤í–‰ ì‹œì‘");
          log.debug("ë””ë²„ê·¸ ì •ë³´: {}", someValue);
          log.warn("ê²½ê³  ë°œìƒ");
          log.error("ì˜¤ë¥˜ ë°œìƒ", exception);
      }
  }
  ```

  ------

  ### âœ… 4. Spring Bootì˜ ê¸°ë³¸ ë¡œê¹… êµ¬ì¡°

  | ê³„ì¸µ      | ê¸°ë³¸ ì„¤ì •                               |
  | --------- | --------------------------------------- |
  | ì¶”ìƒí™”    | SLF4J                                   |
  | êµ¬í˜„ì²´    | Logback                                 |
  | ì„¤ì • íŒŒì¼ | `application.yml`, `logback-spring.xml` |

  #### ìë™ ì„¤ì •

  - `spring-boot-starter-logging`ì´ ìë™ìœ¼ë¡œ SLF4J + Logback êµ¬ì„±
  - `System.out.println()` ì—†ì´ë„ `@Slf4j`, `log.info()`ë¡œ ì¶œë ¥ ê°€ëŠ¥

  ------

  ### âœ… 5. ë¡œê·¸ ë ˆë²¨ (ìš°ì„ ìˆœìœ„ ë†’ìŒ â†’ ë‚®ìŒ)

  | ë ˆë²¨    | ì„¤ëª…                             |
  | ------- | -------------------------------- |
  | `ERROR` | ì‹¬ê°í•œ ì˜¤ë¥˜ ë°œìƒ                 |
  | `WARN`  | ê²½ê³ ì„± ë©”ì‹œì§€, ì£¼ì˜ í•„ìš”         |
  | `INFO`  | ì •ìƒ íë¦„ ì •ë³´, ìš´ì˜ ë¡œê·¸        |
  | `DEBUG` | ìƒì„¸í•œ ë‚´ë¶€ ë™ì‘ ì •ë³´            |
  | `TRACE` | ê°€ì¥ ìƒì„¸í•œ ë¡œì§ ì¶”ì  (ì˜ ì•ˆ ì”€) |

  > ì„¤ì •ëœ ë ˆë²¨ë³´ë‹¤ **ìƒìœ„ ë ˆë²¨ë§Œ ì¶œë ¥ë¨**

  ------

  ### âœ… 6. ì„¤ì • ë°©ë²•

  #### `application.yml`

  ```
  logging:
    level:
      root: INFO
      com.example.service: DEBUG
    file:
      name: logs/app.log
    pattern:
      console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger - %msg%n"
  ```

  ------

  #### `logback-spring.xml`

  ```
  <configuration>
    <appender name="FILE" class="ch.qos.logback.core.FileAppender">
      <file>logs/app.log</file>
      <encoder>
        <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger - %msg%n</pattern>
      </encoder>
    </appender>
  
    <root level="INFO">
      <appender-ref ref="FILE"/>
    </root>
  </configuration>
  ```

  ------

  ### âœ… 7. Lombok `@Slf4j` í™œìš©

  ```
  import lombok.extern.slf4j.Slf4j;
  
  @Slf4j
  @Service
  public class MyService {
      public void hello() {
          log.info("í—¬ë¡œìš°");
      }
  }
  ```

  > Lombokì´ `Logger log = LoggerFactory.getLogger(...)` ìë™ ìƒì„±

  ------

  ### âœ… 8. AOP ê¸°ë°˜ ê³µí†µ ë¡œê¹…

  #### Aspectë¥¼ ì´ìš©í•œ í˜¸ì¶œ/ì‘ë‹µ ë¡œê¹…

  ```
  @Aspect
  @Component
  public class LoggingAspect {
  
      @Around("execution(* com.example.service..*(..))")
      public Object logMethod(ProceedingJoinPoint pjp) throws Throwable {
          String method = pjp.getSignature().toShortString();
          Object[] args = pjp.getArgs();
  
          log.info("â–¶â–¶ í˜¸ì¶œ: {} args={}", method, Arrays.toString(args));
  
          try {
              Object result = pjp.proceed();
              log.info("â—€â—€ ë¦¬í„´: {} result={}", method, result);
              return result;
          } catch (Throwable ex) {
              log.error("âœ–âœ– ì˜ˆì™¸: {} ex={}", method, ex.getMessage());
              throw ex;
          }
      }
  }
  ```

  ------

  ### âœ… 9. MDC (Mapped Diagnostic Context) í™œìš©

  - **ë¡œê·¸ë§ˆë‹¤ ì‚¬ìš©ì ì •ë³´, íŠ¸ëœì­ì…˜ ID ë“± Contextë¥¼ ì‚½ì…**í•  ìˆ˜ ìˆìŒ

  ```
  MDC.put("userId", "admin123");
  
  log.info("ë°ì´í„° ì¡°íšŒ ìš”ì²­");
  
  MDC.clear();
  ```

  #### ë¡œê·¸ íŒ¨í„´ ì„¤ì • (logback.xml)

  ```
  <pattern>%d{HH:mm:ss} [%thread] %X{userId} %-5level %logger - %msg%n</pattern>
  ```

  â†’ ë¡œê·¸ ì¶œë ¥:

  ```
  12:30:55 [main] admin123 INFO com.example.Service - ë°ì´í„° ì¡°íšŒ ìš”ì²­
  ```

  ------

  ### âœ… 10. ì‹¤ë¬´ ë¡œê¹… ì „ëµ

  | ì „ëµ                                | ì„¤ëª…                     |
  | ----------------------------------- | ------------------------ |
  | ë ˆë²¨ êµ¬ë¶„ ëª…í™•íˆ                    | DEBUGì™€ INFO í˜¼ë™ ê¸ˆì§€   |
  | ìš´ì˜ í™˜ê²½ì—ì„œëŠ” `DEBUG` ì œê±°        | `INFO` ì´ìƒë§Œ ì¶œë ¥       |
  | íŒŒì¼ + ì½˜ì†” ë¡œê·¸ ë¶„ë¦¬               | ìš´ì˜/ë””ë²„ê¹… ë¶„ë¦¬         |
  | ì˜ˆì™¸ ë¡œê·¸ëŠ” í•­ìƒ `log.error(â€¦, ex)` | ìŠ¤íƒíŠ¸ë ˆì´ìŠ¤ í¬í•¨ í•„ìš”   |
  | AOP + MDC ì¡°í•©ìœ¼ë¡œ ìœ ì € ì¶”ì         | API ê¸°ë°˜ ì‹œìŠ¤í…œì—ì„œ ìœ ìš© |

  ------

  ### âœ… 11. ìš”ì•½

  | í•­ëª©            | ì„¤ëª…                                        |
  | --------------- | ------------------------------------------- |
  | ê¸°ë³¸ êµ¬ì¡°       | SLF4J (ì¶”ìƒí™”) + Logback (êµ¬í˜„)             |
  | ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš© | `@Slf4j` (Lombok) ì¶”ì²œ                      |
  | ì„¤ì • ë°©ë²•       | `application.yml` ë˜ëŠ” `logback-spring.xml` |
  | ê³µí†µ ë¡œê¹… ì²˜ë¦¬  | AOP ê¸°ë°˜ `@Around` Advice                   |
  | ê³ ê¸‰ ê¸°ëŠ¥       | MDC, ë¹„ë™ê¸° ë¡œê·¸, íŒŒì¼ ë¶„ë¦¬ ë“±              |

- ## ë³´ì•ˆ

  Springì—ì„œì˜ **ë³´ì•ˆ(Security)**ì€ ëŒ€ë¶€ë¶„ **Spring Security**ë¥¼ í†µí•´ ì²˜ë¦¬ë˜ë©°,
   ì¸ì¦(Authentication), ì¸ê°€(Authorization), ì•”í˜¸í™”(Encoding), CSRF ë°©ì–´, ì„¸ì…˜ ê´€ë¦¬, JWT ì²˜ë¦¬, OAuth ì—°ë™, ë¹„ë°€ë²ˆí˜¸ ë³´í˜¸ ë“± **ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì˜ ë³´ì•ˆ ìš”êµ¬ì‚¬í•­ì„ í†µí•©ì ìœ¼ë¡œ í•´ê²°**í•˜ëŠ” ê°•ë ¥í•œ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.

  ì•„ë˜ëŠ” **Spring ë³´ì•ˆì˜ ê°œë…, ëª©ì , êµ¬ì„±ìš”ì†Œ, í•µì‹¬ ê¸°ëŠ¥, ë‚´ë¶€ ë™ì‘ ì›ë¦¬, ì‹¤ë¬´ ì „ëµê¹Œì§€ í¬í•¨í•œ ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…**ì…ë‹ˆë‹¤.

  ------

  ### ğŸ” Spring ë³´ì•ˆ(Security) ê°œìš”

  ### 1. ì •ì˜

  **Spring Security**ëŠ” Spring ì• í”Œë¦¬ì¼€ì´ì…˜ì— **ì¸ì¦/ì¸ê°€, ì„¸ì…˜ ë³´ì•ˆ, ì•”í˜¸í™”, ê³µê²© ë°©ì–´ ê¸°ëŠ¥**ì„ ì œê³µí•˜ëŠ” **ë³´ì•ˆ í”„ë ˆì„ì›Œí¬**ì´ë‹¤.

  - ì›¹ ë³´ì•ˆ (HTTP ìš”ì²­ í•„í„°ë§, ì„¸ì…˜ ë³´ì•ˆ)
  - ë©”ì„œë“œ ë³´ì•ˆ (`@Secured`, `@PreAuthorize`)
  - OAuth2, JWT, LDAP, SSO, CSRF, CORS ë“± ì§€ì›
  - í™•ì¥ì„±ê³¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ë§¤ìš° ë›°ì–´ë‚¨

  ------

  ### 2. ë³´ì•ˆì´ í•„ìš”í•œ ì´ìœ 

  | ìœ„í˜‘ ì¢…ë¥˜        | ë°©ì§€ ìˆ˜ë‹¨                |
  | ---------------- | ------------------------ |
  | ì¸ì¦ ìš°íšŒ ê³µê²©   | ë¡œê·¸ì¸ í•„í„°ë§, ì„¸ì…˜ ê²€ì‚¬ |
  | ê¶Œí•œ ìƒìŠ¹        | ì—­í•  ê¸°ë°˜ ì¸ê°€ ê²€ì¦      |
  | CSRF             | í† í° ê¸°ë°˜ ê²€ì¦           |
  | XSS/Clickjacking | í—¤ë” ì„¤ì •                |
  | ë°ì´í„° íƒˆì·¨      | ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”, HTTPS   |
  | ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© | ë¡œê·¸ì¸ ì œí•œ, CAPTCHA     |

  ------

  ### 3. í•µì‹¬ êµ¬ì„± ìš”ì†Œ

  | êµ¬ì„± ìš”ì†Œ               | ì„¤ëª…                                  |
  | ----------------------- | ------------------------------------- |
  | `Authentication`        | ì‚¬ìš©ìê°€ **ëˆ„êµ¬ì¸ì§€ í™•ì¸**            |
  | `Authorization`         | ì‚¬ìš©ìê°€ **ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ì§€ ê²€ì‚¬** |
  | `SecurityFilterChain`   | HTTP ìš”ì²­ í•„í„° ì²´ì¸ êµ¬ì„±              |
  | `UserDetailsService`    | ì‚¬ìš©ì ì •ë³´ ë¡œë”©                      |
  | `PasswordEncoder`       | ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ë° ê²€ì¦               |
  | `AuthenticationManager` | ì¸ì¦ ì²˜ë¦¬ ì´ê´„                        |
  | `GrantedAuthority`      | ê¶Œí•œ(ROLE_USER, ROLE_ADMIN ë“±)        |
  | `SecurityContext`       | í˜„ì¬ ì¸ì¦ ì •ë³´ ì €ì¥ì†Œ                 |

  ------

  ### 4. ê¸°ë³¸ ë™ì‘ íë¦„

  ```
  [ìš”ì²­] â†’ SecurityFilterChain â†’ AuthenticationFilter â†’ 
  AuthenticationManager â†’ UserDetailsService â†’ UserDetails ë°˜í™˜ â†’ ì¸ì¦ ì„±ê³µ â†’ 
  SecurityContextHolder ì €ì¥ â†’ Controller ì§„ì…
  ```

  ------

  ### 5. í•µì‹¬ ê¸°ëŠ¥

  | ê¸°ëŠ¥                | ì„¤ëª…                                         |
  | ------------------- | -------------------------------------------- |
  | **í¼ ë¡œê·¸ì¸**       | ê¸°ë³¸ ë¡œê·¸ì¸ í˜ì´ì§€ ì œê³µ (`/login`)           |
  | **ì„¸ì…˜ ê´€ë¦¬**       | ì„¸ì…˜ ê³ ì • ê³µê²© ë°©ì§€, ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬          |
  | **íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™”** | `BCryptPasswordEncoder` ë“± ì‚¬ìš©              |
  | **ì—­í•  ê¸°ë°˜ ì¸ê°€**  | URL, ë©”ì„œë“œ ë‹¨ìœ„ `@Secured`, `@PreAuthorize` |
  | **CSRF ë°©ì–´**       | POST ìš”ì²­ì— ëŒ€í•´ í† í° ìš”êµ¬                   |
  | **CORS ì„¤ì •**       | ë‹¤ë¥¸ ë„ë©”ì¸ ìš”ì²­ í—ˆìš©/ì°¨ë‹¨                   |
  | **OAuth2/OpenID**   | ì™¸ë¶€ ì¸ì¦ ì„œë²„ ì—°ë™                          |
  | **JWT í† í° ì¸ì¦**   | Stateless ë°©ì‹ ì§€ì›                          |

  ------

  ### 6. ì„¤ì • ì˜ˆì œ (Spring Boot 3.x ì´ìƒ, Security 6 ê¸°ì¤€)

  ```
  @Configuration
  @EnableMethodSecurity
  public class SecurityConfig {
  
      @Bean
      public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
          return http
              .csrf(AbstractHttpConfigurer::disable)
              .authorizeHttpRequests(auth -> auth
                  .requestMatchers("/admin/**").hasRole("ADMIN")
                  .requestMatchers("/user/**").hasAnyRole("USER", "ADMIN")
                  .anyRequest().permitAll()
              )
              .formLogin(Customizer.withDefaults())
              .build();
      }
  
      @Bean
      public UserDetailsService userDetailsService() {
          UserDetails user = User.withUsername("user")
              .password(passwordEncoder().encode("1234"))
              .roles("USER")
              .build();
  
          return new InMemoryUserDetailsManager(user);
      }
  
      @Bean
      public PasswordEncoder passwordEncoder() {
          return new BCryptPasswordEncoder();
      }
  }
  ```

  ------

  ### 7. ì‹¤ë¬´ ë³´ì•ˆ ì „ëµ

  | í•­ëª©               | ì „ëµ                                           |
  | ------------------ | ---------------------------------------------- |
  | ë¹„ë°€ë²ˆí˜¸ ì €ì¥      | âœ… **BCrypt, Argon2 ì‚¬ìš©**, ì ˆëŒ€ í‰ë¬¸ ê¸ˆì§€      |
  | ì¸ì¦ ë°©ì‹          | âœ… JWT ë˜ëŠ” ì„¸ì…˜ ê¸°ë°˜ ì„ íƒ                      |
  | CSRF ê³µê²©          | âœ… ìƒíƒœ ì €ì¥ ë°©ì‹ì—ì„œëŠ” ë°˜ë“œì‹œ CSRF ë³´í˜¸ í™œì„±í™” |
  | ì¸ì¦ ìš°íšŒ          | âœ… í•„í„° ì²´ì¸ì—ì„œ `permitAll()` ì¡°ì ˆ ì£¼ì˜        |
  | ì¸ê°€ ê²€ì¦          | âœ… URI + ë©”ì„œë“œ ë‘ êµ°ë° ë‹¤ í™•ì¸                 |
  | ê´€ë¦¬ì ê¶Œí•œ        | âœ… ë°˜ë“œì‹œ ë³„ë„ Roleë¡œ ë¶„ë¦¬í•˜ê³  ì ˆëŒ€ ë…¸ì¶œ ê¸ˆì§€   |
  | OAuth ì—°ë™         | âœ… `spring-security-oauth2-client` ì‚¬ìš©         |
  | ë¯¼ê°í•œ ë°ì´í„° ë¡œê·¸ | âŒ ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸, í† í° ë“± ë¡œê¹… ê¸ˆì§€           |
  | ë³´ì•ˆ í—¤ë” ì ìš©     | âœ… `frameOptions()`, `xssProtection()` ë“± ì ìš©  |

  ------

  ### 8. ë³´ì•ˆ ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜

  | ì–´ë…¸í…Œì´ì…˜                          | ì„¤ëª…                         |
  | ----------------------------------- | ---------------------------- |
  | `@Secured("ROLE_ADMIN")`            | ë©”ì„œë“œ ì ‘ê·¼ ì œì–´             |
  | `@PreAuthorize("hasRole('ADMIN')")` | SpEL ê¸°ë°˜ ì¸ê°€               |
  | `@PostAuthorize(...)`               | ë©”ì„œë“œ ì‹¤í–‰ í›„ ì¸ê°€ ê²€ì‚¬     |
  | `@WithMockUser(...)`                | í…ŒìŠ¤íŠ¸ìš© ì¸ì¦ ì‚¬ìš©ì ì£¼ì…    |
  | `@AuthenticationPrincipal`          | í˜„ì¬ ì¸ì¦ëœ ì‚¬ìš©ì ì •ë³´ ì¶”ì¶œ |

  ------

  ### 9. í† í° ê¸°ë°˜ ì¸ì¦ (JWT)

  ```
  Authorization: Bearer <token>
  ```

  Spring SecurityëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì„¸ì…˜ ê¸°ë°˜ì´ì§€ë§Œ, **JWT í•„í„°ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì—¬ ë¬´ìƒíƒœ(stateless) ì¸ì¦ ì‹œìŠ¤í…œ êµ¬ì¶• ê°€ëŠ¥**

  ------

  ### 10. ë³´ì•ˆ ê´€ë ¨ í´ë˜ìŠ¤ ìš”ì•½

  | í´ë˜ìŠ¤/ì¸í„°í˜ì´ìŠ¤       | ì—­í•                   |
  | ----------------------- | --------------------- |
  | `UserDetailsService`    | ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ì œê³µ |
  | `UserDetails`           | ì‚¬ìš©ì ê°ì²´           |
  | `Authentication`        | ì¸ì¦ í† í°             |
  | `SecurityContextHolder` | ì¸ì¦ ì •ë³´ ì €ì¥ì†Œ      |
  | `AuthenticationManager` | ì¸ì¦ ì±…ì„ì           |
  | `GrantedAuthority`      | ê¶Œí•œ ì •ë³´             |

  ------

  ### 11. ìš”ì•½

  | í•­ëª©                 | ì„¤ëª…                                                   |
  | -------------------- | ------------------------------------------------------ |
  | ì¸ì¦(Authentication) | ë¡œê·¸ì¸, ì‹ ì› í™•ì¸                                      |
  | ì¸ê°€(Authorization)  | ê¶Œí•œ í™•ì¸, ì ‘ê·¼ í†µì œ                                   |
  | ê¸°ë³¸ ë°©ì‹            | í•„í„° ì²´ì¸ + ì„¸ì…˜/í† í° ì¸ì¦                             |
  | ì£¼ìš” ê¸°ìˆ             | BCrypt, JWT, OAuth2, CSRF ë³´í˜¸                         |
  | ì‹¤ë¬´ ê¶Œì¥            | ì—­í•  ê¸°ë°˜ ì ‘ê·¼ í†µì œ + AOP ê¸°ë°˜ ë©”ì„œë“œ ë³´ì•ˆ + ë¡œê·¸ ì œí•œ |

- ## íŠ¸ëœì­ì…˜

  ë‹¤ìŒì€ **Springì˜ íŠ¸ëœì­ì…˜(Transaction) ì²˜ë¦¬**ì— ëŒ€í•œ ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…ì…ë‹ˆë‹¤.
   íŠ¸ëœì­ì…˜ì˜ ê°œë…, Spring íŠ¸ëœì­ì…˜ì˜ êµ¬ì¡°, `@Transactional` ì–´ë…¸í…Œì´ì…˜ì˜ ë™ì‘ ë°©ì‹, ë‚´ë¶€ AOP ë©”ì»¤ë‹ˆì¦˜, íŠ¸ëœì­ì…˜ ì „íŒŒ, ê²©ë¦¬ ìˆ˜ì¤€, ë¡¤ë°± ì „ëµ, ì„ ì–¸ì  vs ëª…ë ¹ì  ì²˜ë¦¬, ì‹¤ë¬´ì—ì„œì˜ ì‹¤ìˆ˜ ë°©ì§€ ì „ëµê¹Œì§€ ì™„ë²½í•˜ê²Œ ë‹¤ë£¹ë‹ˆë‹¤.

  ------

  ### ğŸ”„ 1. íŠ¸ëœì­ì…˜ì´ë€?

  #### âœ… ì •ì˜

  íŠ¸ëœì­ì…˜ì€ **í•˜ë‚˜ì˜ ì‘ì—… ë‹¨ìœ„ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ë¬¶ì–´ ì²˜ë¦¬**í•˜ëŠ” ê²ƒìœ¼ë¡œ, í•´ë‹¹ ë‹¨ìœ„ëŠ” **ëª¨ë‘ ì„±ê³µí•˜ê±°ë‚˜ ëª¨ë‘ ì‹¤íŒ¨í•´ì•¼ í•¨**ì„ ë³´ì¥í•©ë‹ˆë‹¤.

  â†’ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œì˜ **ì›ìì„±(Atomicity)** ë³´ì¥ì„ ìœ„í•œ í•µì‹¬ ê°œë…ì…ë‹ˆë‹¤.

  #### âœ… ACID

  | ìš”ì†Œ            | ì„¤ëª…                             |
  | --------------- | -------------------------------- |
  | **Atomicity**   | ì „ë¶€ ì„±ê³µ or ì „ë¶€ ì‹¤íŒ¨           |
  | **Consistency** | ì¼ê´€ëœ ìƒíƒœ ìœ ì§€                 |
  | **Isolation**   | ë™ì‹œì— ì‹¤í–‰ë˜ì–´ë„ ì„œë¡œ ê°„ì„­ ì—†ìŒ |
  | **Durability**  | ì»¤ë°‹ëœ ê²°ê³¼ëŠ” ì˜êµ¬ ë³´ì¡´ë¨        |

  ------

  ### âš™ï¸ 2. Spring íŠ¸ëœì­ì…˜ ì²˜ë¦¬ êµ¬ì¡°

  Springì€ **í”„ë¡œê·¸ë˜ë°ì  + ì„ ì–¸ì ** íŠ¸ëœì­ì…˜ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤.
   **ì„ ì–¸ì  ë°©ì‹(@Transactional)**ì´ ê°€ì¥ ë§ì´ ì“°ì…ë‹ˆë‹¤.

  #### ì£¼ìš” êµ¬ì„± ìš”ì†Œ

  | ì»´í¬ë„ŒíŠ¸                       | ì—­í•                              |
  | ------------------------------ | -------------------------------- |
  | `PlatformTransactionManager`   | íŠ¸ëœì­ì…˜ ì‹œì‘, ì»¤ë°‹, ë¡¤ë°±ì„ ê´€ë¦¬ |
  | `@Transactional`               | ì„ ì–¸ì  íŠ¸ëœì­ì…˜ ê²½ê³„ ì§€ì •        |
  | `TransactionInterceptor`       | AOPë¡œ íŠ¸ëœì­ì…˜ì„ ê±¸ì–´ì£¼ëŠ” Advice |
  | `DataSourceTransactionManager` | JDBC ê¸°ë°˜ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €        |
  | `JpaTransactionManager`        | JPA ê¸°ë°˜ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €         |

  ------

  ### âœ… 3. ê¸°ë³¸ ì„¤ì • ì˜ˆì œ

  #### ì„¤ì • (Spring Boot ê¸°ì¤€)

  ```
  @SpringBootApplication
  @EnableTransactionManagement
  public class MyApp { }
  ```

  #### íŠ¸ëœì­ì…˜ ì ìš© ì˜ˆ

  ```
  @Service
  public class OrderService {
  
      @Transactional
      public void placeOrder(OrderRequest request) {
          orderRepository.save(...);
          paymentService.process(...); // ë‚´ë¶€ í˜¸ì¶œ ì£¼ì˜
      }
  }
  ```

  ------

  ### ğŸ“Œ 4. `@Transactional` í•µì‹¬ ì†ì„±

  | ì†ì„±          | ê¸°ë³¸ê°’             | ì„¤ëª…                       |
  | ------------- | ------------------ | -------------------------- |
  | `propagation` | `REQUIRED`         | íŠ¸ëœì­ì…˜ ì „íŒŒ ë°©ì‹         |
  | `isolation`   | DB ê¸°ë³¸ê°’          | íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€         |
  | `rollbackFor` | `RuntimeException` | ë¡¤ë°± ì˜ˆì™¸ ì§€ì •             |
  | `readOnly`    | `false`            | ì½ê¸° ì „ìš© íŠ¸ëœì­ì…˜ ìµœì í™”  |
  | `timeout`     | -1 (ë¬´ì œí•œ)        | ì œí•œ ì‹œê°„ ì´ˆê³¼ ì‹œ rollback |

  ------

  ### ğŸ”„ 5. íŠ¸ëœì­ì…˜ ì „íŒŒ ì†ì„± (propagation)

  | ì†ì„±            | ì„¤ëª…                                        |
  | --------------- | ------------------------------------------- |
  | `REQUIRED`      | ê¸°ì¡´ íŠ¸ëœì­ì…˜ ìˆìœ¼ë©´ ì°¸ì—¬, ì—†ìœ¼ë©´ ìƒˆë¡œ ì‹œì‘ |
  | `REQUIRES_NEW`  | í•­ìƒ ìƒˆ íŠ¸ëœì­ì…˜ ì‹œì‘ (ê¸°ì¡´ì€ ì¼ì‹œ ì¤‘ë‹¨)    |
  | `NESTED`        | ì¤‘ì²© íŠ¸ëœì­ì…˜ (Savepoint ì‚¬ìš©)              |
  | `MANDATORY`     | ê¸°ì¡´ íŠ¸ëœì­ì…˜ ì—†ìœ¼ë©´ ì˜ˆì™¸                   |
  | `NEVER`         | íŠ¸ëœì­ì…˜ ìˆìœ¼ë©´ ì˜ˆì™¸                        |
  | `SUPPORTS`      | ìˆìœ¼ë©´ ì°¸ì—¬, ì—†ìœ¼ë©´ ë¹„íŠ¸ëœì­ì…˜              |
  | `NOT_SUPPORTED` | íŠ¸ëœì­ì…˜ ì—†ì´ ì‹¤í–‰ (ì¤‘ë‹¨)                   |

  ------

  ### ğŸ” 6. ê²©ë¦¬ ìˆ˜ì¤€ (isolation)

  | ìˆ˜ì¤€               | ì„¤ëª…                                         |
  | ------------------ | -------------------------------------------- |
  | `READ_UNCOMMITTED` | ì»¤ë°‹ë˜ì§€ ì•Šì€ ë°ì´í„°ë„ ì½ìŒ (ë”í‹° ì½ê¸° ê°€ëŠ¥) |
  | `READ_COMMITTED`   | ì»¤ë°‹ëœ ë°ì´í„°ë§Œ ì½ìŒ (SQL ê¸°ë³¸)              |
  | `REPEATABLE_READ`  | ê°™ì€ ì¿¼ë¦¬ ë°˜ë³µ ì‹œ í•­ìƒ ë™ì¼í•œ ê²°ê³¼           |
  | `SERIALIZABLE`     | ê°€ì¥ ê°•ë ¥í•œ ìˆ˜ì¤€, ì™„ì „ ì§ë ¬í™”                |
  | `DEFAULT`          | DBì˜ ê¸°ë³¸ ê²©ë¦¬ ìˆ˜ì¤€ ì‚¬ìš©                     |

  ------

  ### â— 7. ë¡¤ë°± ì „ëµ

  Springì€ ê¸°ë³¸ì ìœ¼ë¡œ **`RuntimeException`, `Error`** ë°œìƒ ì‹œ rollback í•©ë‹ˆë‹¤.

  #### ì˜ˆì™¸ ìƒí™© ëª…ì‹œì  ì²˜ë¦¬ ì˜ˆ

  ```
  @Transactional(rollbackFor = Exception.class)
  public void process() throws Exception {
      // checked ì˜ˆì™¸ë„ rollback
  }
  ```

  > `rollbackFor`, `noRollbackFor` ì†ì„±ìœ¼ë¡œ ì œì–´ ê°€ëŠ¥

  ------

  ### âš ï¸ 8. ì‹¤ë¬´ ì‹¤ìˆ˜ ë°©ì§€ ì „ëµ

  | ë¬¸ì œ                            | ì›ì¸                                                      | í•´ê²° ë°©ë²•                                                 |
  | ------------------------------- | --------------------------------------------------------- | --------------------------------------------------------- |
  | íŠ¸ëœì­ì…˜ ì ìš© ì•ˆ ë¨             | `@Transactional`ì´ **ì¸í„°í˜ì´ìŠ¤ë‚˜ private ë©”ì„œë“œ**ì— ë¶™ìŒ | ë°˜ë“œì‹œ `public` ë©”ì„œë“œì— ì ìš©                             |
  | ë‚´ë¶€ ë©”ì„œë“œ í˜¸ì¶œ ì‹œ AOP ë¬´ì‹œ    | `this.ë©”ì„œë“œ()`ë¡œ í˜¸ì¶œë¨ â†’ í”„ë¡ì‹œ ìš°íšŒ                    | ë³„ë„ ì»´í¬ë„ŒíŠ¸ë¡œ ë¶„ë¦¬í•˜ê±°ë‚˜ `ApplicationContext` í†µí•´ í˜¸ì¶œ |
  | checked ì˜ˆì™¸ì—ì„œ rollback ì•ˆ ë¨ | ê¸°ë³¸ì€ `RuntimeException`ë§Œ ë¡¤ë°±                          | `rollbackFor` ëª…ì‹œ                                        |
  | readOnly ì†ì„± ë¬´ì‹œë¨            | MyBatis, JPA ì„¤ì •ê³¼ ìƒì¶© ê°€ëŠ¥ì„± ìˆìŒ                      | íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € ì„¤ì • í™•ì¸                                 |
  | ë³‘ë ¬ ì—…ë°ì´íŠ¸ ì‹œ ì¶©ëŒ ë°œìƒ      | ê²©ë¦¬ ìˆ˜ì¤€ ë‚®ìŒ                                            | `REPEATABLE_READ` ë˜ëŠ” `OPTIMISTIC_LOCK` ì‚¬ìš©             |

  ------

  ### âš™ï¸ 9. íŠ¸ëœì­ì…˜ ì»¤ë°‹/ë¡¤ë°± ë™ì‘ ìˆœì„œ

  ```
  1. í´ë¼ì´ì–¸íŠ¸ â†’ íŠ¸ëœì­ì…˜ ì‹œì‘
  2. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
  3. ì˜ˆì™¸ ë°œìƒ ì—¬ë¶€ í™•ì¸
  4. ì˜ˆì™¸ ë°œìƒ ì‹œ â†’ rollback
  5. ì„±ê³µ ì‹œ â†’ commit
  6. í›„ì²˜ë¦¬ / ì´ë²¤íŠ¸ ì „íŒŒ
  ```

  ------

  ### ğŸ” 10. ì„ ì–¸ì  vs í”„ë¡œê·¸ë˜ë°ì  íŠ¸ëœì­ì…˜

  | ë°©ì‹                | ì˜ˆì‹œ                                                         |
  | ------------------- | ------------------------------------------------------------ |
  | **ì„ ì–¸ì  ë°©ì‹**     | `@Transactional` ì‚¬ìš© (ê°€ì¥ ì¼ë°˜ì )                          |
  | **í”„ë¡œê·¸ë˜ë° ë°©ì‹** | `TransactionTemplate`, `PlatformTransactionManager` ì§ì ‘ í˜¸ì¶œ |

  ```
  transactionTemplate.execute(status -> {
      // ë¡œì§ ì‹¤í–‰
      return null;
  });
  ```

  â†’ **ë™ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ ì¡°ê±´ì„ ë°”ê¾¸ê³  ì‹¶ì„ ë•Œ** ìœ ìš©

  ------

  ### âœ… 11. ìš”ì•½

  | í•­ëª©               | ì„¤ëª…                                          |
  | ------------------ | --------------------------------------------- |
  | íŠ¸ëœì­ì…˜ ê¸°ë³¸ ëª©ì  | ì›ìì„±, ì¼ê´€ì„±, ê²©ë¦¬ì„±, ì§€ì†ì„± ë³´ì¥           |
  | ì‚¬ìš© ë°©ë²•          | `@Transactional` + íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €            |
  | ì „íŒŒ ì†ì„±          | íŠ¸ëœì­ì…˜ ê²½ê³„ ê°„ ê´€ê³„ ì œì–´                    |
  | ë¡¤ë°± ì¡°ê±´          | ê¸°ë³¸ì€ `RuntimeException` / ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥ |
  | ê²©ë¦¬ ìˆ˜ì¤€          | ë³‘í–‰ ì²˜ë¦¬ ì‹œ ë°ì´í„° ë³´í˜¸ ìˆ˜ì¤€ ì„¤ì •            |
  | ì‹¤ë¬´ ì „ëµ          | public, ì™¸ë¶€ í˜¸ì¶œ, rollbackFor ë“± ì£¼ì˜        |