# 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ (Application Layer) â€” ì„ íƒì 

## ë³µì¡í•œ ìœ ìŠ¤ì¼€ì´ìŠ¤ ì²˜ë¦¬ (Command, Use Case ì¤‘ì‹¬)

### ğŸ§© 1. ê°œë… ì •ì˜

#### ğŸ”¸ ìœ ìŠ¤ì¼€ì´ìŠ¤(Use Case)ë€?

> ì‹œìŠ¤í…œì´ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ëŒ€í•´ ìˆ˜í–‰í•´ì•¼ í•  **í•˜ë‚˜ì˜ ê¸°ëŠ¥ ë‹¨ìœ„**.
>  "ì‚¬ìš©ì ì…ì¥ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ê°€?"ì— ì§‘ì¤‘í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ íë¦„.

#### ğŸ”¸ Command ê¸°ë°˜ Use Case ì²˜ë¦¬ë€?

- **ëª…ë ¹(Command)** ê°ì²´ë¥¼ í†µí•´ ì™¸ë¶€ ìš”ì²­ì„ ë‚´ë¶€ ë„ë©”ì¸ ë¡œì§ê³¼ **ëª…í™•íˆ ë¶„ë¦¬**
- Use CaseëŠ” ì´ëŸ¬í•œ Commandë¥¼ ë°›ì•„ â†’ **ê²€ì¦ â†’ ë„ë©”ì¸ ê°ì²´ í˜¸ì¶œ â†’ ê²°ê³¼ ë°˜í™˜**í•˜ëŠ” ì—­í• 

------

### ğŸ“¦ 2. ì£¼ìš” êµ¬ì„± ìš”ì†Œ

| êµ¬ì„±ìš”ì†Œ                     | ì„¤ëª…                                                   |
| ---------------------------- | ------------------------------------------------------ |
| Command                      | í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ìº¡ìŠí™”í•œ ë‹¨ìˆœ ì…ë ¥ ë°ì´í„° (DTO ì—­í• ) |
| UseCase(Application Service) | í•˜ë‚˜ì˜ ìœ ìŠ¤ì¼€ì´ìŠ¤ë¥¼ ì‹¤í–‰. íë¦„ ì¡°ìœ¨, íŠ¸ëœì­ì…˜ ê´€ë¦¬     |
| Domain                       | ì‹¤ì œ ìƒíƒœ ë³€ê²½, ê·œì¹™ ì ìš© ë“±ì˜ í•µì‹¬ ë¡œì§ì„ ë‹´ë‹¹        |
| Result DTO                   | í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°˜í™˜í•  ì‘ë‹µ ë°ì´í„°ë¥¼ ìº¡ìŠí™”             |

------

### ğŸ§± 3. êµ¬ì¡° ì˜ˆì‹œ

```
[Controller]
    â†“
[Command ê°ì²´ ìƒì„±]
    â†“
[UseCase í˜¸ì¶œ] â†’ [Command ì²˜ë¦¬]
    â†“
[ë„ë©”ì¸ ëª¨ë¸ ì¡°ì‘]
    â†“
[ê²°ê³¼ ê°ì²´ ë°˜í™˜ (DTO)]
```

------

### ğŸ§  4. ì˜ˆì œ: ì‚¬ìš©ì íšŒì›ê°€ì… ìœ ìŠ¤ì¼€ì´ìŠ¤

#### 1) ğŸ“¥ Command ê°ì²´

```
public record RegisterUserCommand(String name, String email, String password) {}
```

#### 2) ğŸ§­ UseCase (Application Layer)

```
@Service
public class RegisterUserUseCase {

    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;

    @Transactional
    public void register(RegisterUserCommand cmd) {
        if (userRepository.existsByEmail(cmd.email())) {
            throw new EmailAlreadyExistsException();
        }

        User user = new User(cmd.name(), cmd.email(), passwordEncoder.encode(cmd.password()));
        userRepository.save(user);
    }
}
```

> ğŸ“Œ ì—¬ê¸°ì„œ UseCaseëŠ” "íšŒì›ê°€ì…"ì´ë¼ëŠ” í•˜ë‚˜ì˜ íë¦„ì„ ì±…ì„ì§€ê³  ì¡°ìœ¨í•˜ëŠ” í´ë˜ìŠ¤ì„

------

#### 3) ğŸ”§ ë„ë©”ì¸ ì—”í‹°í‹°

```
@Entity
public class User {
    @Id @GeneratedValue
    private Long id;

    private String name;
    private String email;
    private String password;

    protected User() {}

    public User(String name, String email, String encodedPassword) {
        this.name = name;
        this.email = email;
        this.password = encodedPassword;
    }
}
```

------

#### 4) ğŸ® Controller

```
@RestController
@RequestMapping("/api/users")
public class UserController {

    private final RegisterUserUseCase registerUserUseCase;

    @PostMapping
    public ResponseEntity<Void> register(@RequestBody @Valid RegisterUserRequest request) {
        RegisterUserCommand cmd = request.toCommand();
        registerUserUseCase.register(cmd);
        return ResponseEntity.status(HttpStatus.CREATED).build();
    }
}
```

#### 5) DTO â†’ Command ë³€í™˜

```
public class RegisterUserRequest {
    @NotBlank private String name;
    @Email private String email;
    @NotBlank private String password;

    public RegisterUserCommand toCommand() {
        return new RegisterUserCommand(name, email, password);
    }
}
```

------

### âœ… 5. ì™œ ì´ë ‡ê²Œ ë¶„ë¦¬í• ê¹Œ?

| ëª©ì                         | ì´ìœ                                           |
| --------------------------- | --------------------------------------------- |
| â–¶ ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬          | ìš”ì²­ â†’ ëª…ë ¹ â†’ ìœ ìŠ¤ì¼€ì´ìŠ¤ â†’ ë„ë©”ì¸             |
| â–¶ í…ŒìŠ¤íŠ¸ ìš©ì´ì„±             | UseCase ë‹¨ë… í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ (Mockë§Œ ì£¼ì…í•˜ë©´ ë¨) |
| â–¶ ë³´ì•ˆ/ê²€ì¦ ì§‘ì¤‘í™”          | ì…ë ¥ ê²€ì¦, ì •ì±… ê²€ì¦ì„ UseCase ë‚´ë¡œ ì§‘ì¤‘ ê°€ëŠ¥ |
| â–¶ ë‹¨ì¼ ìœ ìŠ¤ì¼€ì´ìŠ¤ ì¤‘ì‹¬ ì„¤ê³„ | ë³µì¡í•œ ì„œë¹„ìŠ¤ ë©”ì„œë“œ í˜¼ë€ ì œê±°                |

------

### ğŸ“š 6. ì—¬ëŸ¬ Use Caseë¥¼ êµ¬ë¶„í•  ë•Œ ê¸°ì¤€

| ê¸°ì¤€                             | ì˜ˆì‹œ UseCase                              |
| -------------------------------- | ----------------------------------------- |
| ì˜ë¯¸ ë‹¨ìœ„ë¡œ ë‚˜ëˆŒ ê²ƒ              | `RegisterUserUseCase`, `LoginUserUseCase` |
| ë‹¨ì¼ ì±…ì„ ì›ì¹™(SRP) ë”°ë¥¼ ê²ƒ      | ê²°ì œì™€ ì•Œë¦¼ì€ ë¶„ë¦¬                        |
| íŠ¸ëœì­ì…˜ ê²½ê³„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚˜ëˆŒ ê²ƒ | í•˜ë‚˜ì˜ DB ì‘ì—… ë¬¶ìŒì´ë©´ í•˜ë‚˜ì˜ UseCase    |

------

### ğŸ›  7. ê³ ê¸‰ í™•ì¥ ìš”ì†Œ (ì„ íƒ ì‚¬í•­)

| ê¸°ëŠ¥                      | ì„¤ëª…                                             |
| ------------------------- | ------------------------------------------------ |
| Result ê°ì²´               | ê²°ê³¼ë¥¼ `ResultDto`, `Success/Fail` ê°ì²´ë¡œ ê°ì‹¸ê¸° |
| CQRS ì ìš©                 | Query UseCaseì™€ Command UseCase ë¶„ë¦¬             |
| Validation Layer ì¶”ê°€     | Command ê²€ì¦ê¸° (`CommandValidator`) ë³„ë„ ìƒì„±    |
| ë„ë©”ì¸ ì´ë²¤íŠ¸ ë°œí–‰        | `userRegisteredEvent` ê°™ì€ ì´ë²¤íŠ¸ ê°ì²´ ë°œí–‰      |
| Clean Architectureì™€ ì—°ê²° | Interface â†’ UseCase â†’ Domain â†’ Infra ë°©í–¥ ìœ ì§€   |

------

### âœ… ìš”ì•½

| êµ¬ì„± ìš”ì†Œ    | ì—­í•                                                   |
| ------------ | ----------------------------------------------------- |
| `Command`    | ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ìº¡ìŠí™”í•œ ê°ì²´                         |
| `UseCase`    | ìš”ì²­ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ íë¦„ì„ ì‹¤í–‰í•˜ê³  ë„ë©”ì¸ì„ ì¡°ìœ¨         |
| `Domain`     | ìƒíƒœ ë³€ê²½, ê·œì¹™ ì ìš© ë“± í•µì‹¬ ë¡œì§ ë‹´ë‹¹                |
| `Result`     | í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•  ì‘ë‹µ ë°ì´í„° ëª¨ë¸                  |
| `Controller` | HTTP ìš”ì²­ì„ ìˆ˜ì‹ í•˜ê³  Commandë¡œ ë³€í™˜í•œ í›„ UseCase í˜¸ì¶œ |

------

### ğŸ“¦ ë””ë ‰í„°ë¦¬ êµ¬ì¡° ì˜ˆì‹œ

```
com.example.user
â”œâ”€â”€ controller
â”‚   â””â”€â”€ UserController.java
â”œâ”€â”€ command
â”‚   â””â”€â”€ RegisterUserCommand.java
â”œâ”€â”€ usecase
â”‚   â””â”€â”€ RegisterUserUseCase.java
â”œâ”€â”€ domain
â”‚   â””â”€â”€ User.java
â”œâ”€â”€ dto
â”‚   â””â”€â”€ RegisterUserRequest.java
â””â”€â”€ repository
    â””â”€â”€ UserRepository.java
```

## ë„ë©”ì¸ ë¡œì§ ì¡°í•© ë° íŠ¸ëœì­ì…˜ ì¡°ìœ¨

### ğŸ§© 1. ê°œë… ì •ë¦¬

| ìš©ì–´                 | ì˜ë¯¸                                                         |
| -------------------- | ------------------------------------------------------------ |
| **ë„ë©”ì¸ ë¡œì§ ì¡°í•©** | ì—¬ëŸ¬ ë„ë©”ì¸ ê°ì²´ ê°„ì˜ ì‘ì—…ì„ **ì¡°ìœ¨í•˜ê³  ì—°ê²°**í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ íë¦„ |
| **íŠ¸ëœì­ì…˜ ì¡°ìœ¨**    | ì—¬ëŸ¬ ì‘ì—…ì´ í•˜ë‚˜ì˜ **íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì›ìì„±**ì„ ê°€ì§€ë„ë¡ ê´€ë¦¬í•˜ëŠ” ê²ƒ (`@Transactional` ì‚¬ìš©) |

------

### ğŸ¯ 2. ì™œ ë¶„ë¦¬í•˜ê³  ì¡°í•©í•´ì•¼ í•˜ë‚˜?

- ë„ë©”ì¸ ê°ì²´ëŠ” **ìê¸° ì±…ì„ ë²”ìœ„ì˜ ìƒíƒœ**ë§Œ ë³€ê²½í•´ì•¼ í•¨.
- ë„ë©”ì¸ ê°ì²´ ê°„ í˜‘ë ¥ì´ í•„ìš”í•  ë•, **ì‘ìš© ê³„ì¸µ(Application Layer)**ì—ì„œ orchestrate í•´ì•¼ í•¨.
- DB ì‘ì—…, ì™¸ë¶€ API í˜¸ì¶œ, ì´ë²¤íŠ¸ ë°œí–‰ ë“±ì˜ **ê²½ê³„ ì„¤ì •ì´ ëª…í™•**í•´ì•¼ ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›€.

------

### ğŸ’¡ 3. ì±…ì„ ë¶„ë¦¬ í•µì‹¬ ê·œì¹™

| ê³„ì¸µ                  | ì±…ì„                                          |
| --------------------- | --------------------------------------------- |
| Domain                | ë‹¨ì¼ ê°ì²´ì˜ ë¶ˆë³€ì„±/ê·œì¹™/ìƒíƒœ ë³€ê²½             |
| Application / Service | ì—¬ëŸ¬ ë„ë©”ì¸ ê°„ í˜‘ë ¥, íŠ¸ëœì­ì…˜ ì¡°ì •, íë¦„ ì œì–´ |
| Repository            | ì˜ì†ì„± ì±…ì„ (ì €ì¥, ì¡°íšŒ, ì‚­ì œ)                |
| Infra                 | ì™¸ë¶€ ì‹œìŠ¤í…œ, ì´ë©”ì¼, ë©”ì‹œì§• ë“± ì²˜ë¦¬           |

------

### ğŸ“¦ 4. ì˜ˆì œ: ì£¼ë¬¸(Order) + ì¬ê³ (Inventory) + ê²°ì œ(Payment)

#### ìœ ìŠ¤ì¼€ì´ìŠ¤ ì‹œë‚˜ë¦¬ì˜¤:

> â€œìƒí’ˆì„ ì£¼ë¬¸í•˜ë©´ â†’ ì¬ê³ ë¥¼ ì°¨ê°í•˜ê³  â†’ ê²°ì œë¥¼ ìˆ˜í–‰í•˜ê³  â†’ ì£¼ë¬¸ì„ ì €ì¥í•´ì•¼ í•œë‹¤.â€

------

#### âœ” ë„ë©”ì¸ ê°ì²´ (ë‹¨ì¼ ì±…ì„ë§Œ ìˆ˜í–‰)

##### Order.java

```
public class Order {
    private OrderStatus status;

    public void markAsPaid() {
        if (this.status != OrderStatus.REQUESTED) {
            throw new IllegalStateException("ê²°ì œ ìƒíƒœ ì•„ë‹˜");
        }
        this.status = OrderStatus.PAID;
    }
}
```

##### Inventory.java

```
public class Inventory {
    private int quantity;

    public void decrease(int amount) {
        if (quantity < amount) throw new OutOfStockException();
        quantity -= amount;
    }
}
```

------

#### âœ” UseCase or Service Layer (ì¡°í•© + íŠ¸ëœì­ì…˜ ì¡°ìœ¨)

```
@Service
public class OrderService {

    private final OrderRepository orderRepository;
    private final InventoryRepository inventoryRepository;
    private final PaymentGateway paymentGateway;

    @Transactional
    public void placeOrder(OrderRequestDto dto) {
        Inventory inventory = inventoryRepository.findByItemId(dto.getItemId());
        inventory.decrease(dto.getQuantity());

        paymentGateway.pay(dto.getPaymentInfo()); // ì™¸ë¶€ ì‹œìŠ¤í…œ

        Order order = new Order(dto.getUserId(), dto.getItemId(), dto.getQuantity());
        order.markAsPaid();

        orderRepository.save(order);
    }
}
```

#### ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì¡°ìœ¨ í¬ì¸íŠ¸:

| ìœ„ì¹˜                      | ì„¤ëª…                                 |
| ------------------------- | ------------------------------------ |
| `inventory.decrease(...)` | ë„ë©”ì¸ ë‚´ë¶€ ê²€ì¦ í›„ ìƒíƒœ ë³€ê²½        |
| `paymentGateway.pay(...)` | ì™¸ë¶€ API í˜¸ì¶œ, ì˜ˆì™¸ ë°œìƒ ê°€ëŠ¥        |
| `@Transactional`          | ì „ì²´ íë¦„ì´ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì„ |
| `order.markAsPaid()`      | ë„ë©”ì¸ ê°ì²´ì˜ ìƒíƒœ ë³€í™” ì§ì ‘ í˜¸ì¶œ    |

------

### âš ï¸ 5. íŠ¸ëœì­ì…˜ ì£¼ì˜ì‚¬í•­

| í•­ëª©             | ì„¤ëª…                                                         |
| ---------------- | ------------------------------------------------------------ |
| íŠ¸ëœì­ì…˜ ê²½ê³„    | ë°˜ë“œì‹œ UseCase/Service ê³„ì¸µì—ì„œë§Œ `@Transactional` ì„ ì–¸      |
| ì˜ˆì™¸ ë°œìƒ        | ì˜ˆì™¸ ë°œìƒ ì‹œ ë¡¤ë°± (`RuntimeException` ê³„ì—´ë§Œ ê¸°ë³¸ ë¡¤ë°±)      |
| ì™¸ë¶€ ì‹œìŠ¤í…œ í˜¸ì¶œ | ì™¸ë¶€ ê²°ì œ API ë“±ì€ íŠ¸ëœì­ì…˜ ë°”ê¹¥ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ì¼ë°˜ì  (ë³´ìƒ íŠ¸ëœì­ì…˜ í•„ìš”) |
| ì¤‘ì²© íŠ¸ëœì­ì…˜    | ë‚´ë¶€ í˜¸ì¶œ ì‹œ `@Transactional`ì´ ì ìš©ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ (í”„ë¡ì‹œ ì£¼ì˜) |

------

### ğŸ” ë„ë©”ì¸ ì¡°í•© ì‹œ íŒ¨í„´

| íŒ¨í„´                       | ì„¤ëª…                                                         |
| -------------------------- | ------------------------------------------------------------ |
| Orchestration (ëª…ë ¹í˜•)     | UseCaseì—ì„œ ìˆœì„œë¥¼ ì •ì˜í•˜ê³  ê° ë„ë©”ì¸ì„ í˜¸ì¶œ                 |
| Choreography (ì´ë²¤íŠ¸ ê¸°ë°˜) | ë„ë©”ì¸ ê°„ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œì¼œ ë¹„ë™ê¸° í˜‘ë ¥ (ì˜ˆ: Spring Event, Kafka) |

------

### âœ… ìš”ì•½ ì •ë¦¬

| í•­ëª©             | ì—­í•                                                |
| ---------------- | -------------------------------------------------- |
| ë„ë©”ì¸ ë¡œì§ ì¡°í•© | ì—¬ëŸ¬ ë„ë©”ì¸ ëª¨ë¸ì˜ ê¸°ëŠ¥ì„ í•˜ë‚˜ì˜ ìœ ìŠ¤ì¼€ì´ìŠ¤ë¡œ í†µí•© |
| íŠ¸ëœì­ì…˜ ì¡°ìœ¨    | ë‹¨ì¼ íë¦„ìœ¼ë¡œ ë¬¶ì–´ DB ìƒíƒœë¥¼ ì¼ê´€ë˜ê²Œ ìœ ì§€         |
| ì±…ì„ ìœ„ì¹˜        | ë°˜ë“œì‹œ Application/Service Layerì—ì„œ ì¡°ìœ¨          |
| ë„ë©”ì¸           | ë…ë¦½ì  ìƒíƒœ ë³€ê²½ë§Œ ìˆ˜í–‰ (ì™¸ë¶€ ì˜ì¡´ ì—†ì´)           |
| @Transactional   | ì¡°ìœ¨ì˜ í•µì‹¬, rollback ì²˜ë¦¬ ê¸°ì¤€ í™•ì¸ í•„ìˆ˜          |

------

### ğŸ“š ë””ë ‰í„°ë¦¬ êµ¬ì¡° ì˜ˆì‹œ (ì¡°í•© ì¤‘ì‹¬)

```
order/
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ Order.java
â”‚   â”œâ”€â”€ Inventory.java
â”‚   â””â”€â”€ Payment.java
â”œâ”€â”€ repository/
â”‚   â”œâ”€â”€ OrderRepository.java
â”‚   â””â”€â”€ InventoryRepository.java
â”œâ”€â”€ application/
â”‚   â”œâ”€â”€ PlaceOrderUseCase.java
â”‚   â””â”€â”€ CancelOrderUseCase.java
â”œâ”€â”€ infra/
â”‚   â””â”€â”€ ExternalPaymentGateway.java
```

## ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ vs ë„ë©”ì¸ ì„œë¹„ìŠ¤

### ğŸ” 1. í•µì‹¬ ì •ì˜ ë¹„êµ

| êµ¬ë¶„      | ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ (Application Service) | ë„ë©”ì¸ ì„œë¹„ìŠ¤ (Domain Service)                      |
| --------- | ----------------------------------------- | --------------------------------------------------- |
| ìœ„ì¹˜      | ì‘ìš© ê³„ì¸µ (UseCase ê³„ì¸µ)                  | ë„ë©”ì¸ ê³„ì¸µ                                         |
| ëª©ì       | ìœ ìŠ¤ì¼€ì´ìŠ¤ ì¡°í•©, íŠ¸ëœì­ì…˜ ê´€ë¦¬, íë¦„ ì¡°ìœ¨ | ë„ë©”ì¸ ê·œì¹™ í‘œí˜„ (ë‹¨ì¼ ì—”í‹°í‹°ë¡œ í‘œí˜„í•˜ê¸° ì–´ë ¤ìš¸ ë•Œ) |
| ì—­í•       | ì—¬ëŸ¬ ë„ë©”ì¸ ê°ì²´/ì™¸ë¶€ ìš”ì†Œë¥¼ ì¡°í•©         | ë„ë©”ì¸ ê°ì²´ ê°„ í˜‘ë ¥ì— í•„ìš”í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰     |
| ìƒíƒœ ë³´ìœ  | âŒ (Stateless)                             | âŒ (Stateless)                                       |
| í˜¸ì¶œ ìœ„ì¹˜ | ì»¨íŠ¸ë¡¤ëŸ¬ â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤            | ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ or ë„ë©”ì¸ ì—”í‹°í‹° ë‚´ë¶€           |
| ê¸°ìˆ  ì˜ì¡´ | ìˆìŒ (íŠ¸ëœì­ì…˜, ë¦¬í¬ì§€í† ë¦¬ ë“±)            | ì—†ìŒ (ìˆœìˆ˜ ìë°” ì½”ë“œë¡œ ìœ ì§€)                        |

------

### ğŸ§© 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë€?

> í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ë°›ì•„ì„œ
>
> - ìœ íš¨ì„± ê²€ì‚¬
> - íŠ¸ëœì­ì…˜ ì‹œì‘
> - ì—¬ëŸ¬ ë„ë©”ì¸ ê°ì²´ì™€ ì™¸ë¶€ ì‹œìŠ¤í…œ í˜¸ì¶œ
> - ê²°ê³¼ ë°˜í™˜
>    ì„ ë‹´ë‹¹í•˜ëŠ” **ìœ ìŠ¤ì¼€ì´ìŠ¤ ì¤‘ì‹¬ ê³„ì¸µ**

#### ğŸ“¦ ì˜ˆì‹œ

```
@Service
public class TransferMoneyUseCase {

    private final AccountRepository accountRepository;
    private final EventPublisher eventPublisher;

    @Transactional
    public void transfer(TransferCommand cmd) {
        Account from = accountRepository.findById(cmd.fromId());
        Account to = accountRepository.findById(cmd.toId());

        from.withdraw(cmd.amount());
        to.deposit(cmd.amount());

        accountRepository.save(from);
        accountRepository.save(to);

        eventPublisher.publish(new MoneyTransferredEvent(cmd.fromId(), cmd.toId()));
    }
}
```

ğŸ§­ í•µì‹¬: íë¦„ì˜ ì¡°ìœ¨ì. ë„ë©”ì¸ì˜ **ë¡œì§ì€ í˜¸ì¶œë§Œ í•¨**, ìŠ¤ìŠ¤ë¡œ ê°€ì§€ì§€ ì•ŠìŒ.

------

### ğŸ§  3. ë„ë©”ì¸ ì„œë¹„ìŠ¤ë€?

> ë„ë©”ì¸ ê°ì²´ í•˜ë‚˜ë¡œ í‘œí˜„í•˜ê¸° ì–´ë ¤ìš´ **ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**ì„
>  ë„ë©”ì¸ ê³„ì¸µ ì•ˆì—ì„œ **ìˆœìˆ˜ ìë°” ë¡œì§**ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ê°ì²´

#### ì‚¬ìš© ì‹œì :

- í•˜ë‚˜ì˜ ì—”í‹°í‹°ì— ì±…ì„ì„ ë¶€ì—¬í•˜ê¸° ì• ë§¤í•œ ê²½ìš°
- ì—¬ëŸ¬ ì—”í‹°í‹°/VO ê°„ì˜ í˜‘ì—…ì´ í•„ìš”í•œ ë„ë©”ì¸ ê·œì¹™ì´ ìˆì„ ë•Œ

#### ğŸ“¦ ì˜ˆì‹œ

```
public class ShippingService {
    public boolean isFreeShipping(Order order, Member member) {
        return member.isVip() || order.totalPrice() > 100_000;
    }
}
```

> ğŸ“Œ ë„ë©”ì¸ ì„œë¹„ìŠ¤ëŠ” ìƒíƒœë¥¼ ê°€ì§€ì§€ ì•Šê³ , **ìˆœìˆ˜ ê³„ì‚°/íŒë‹¨ ë¡œì§**ë§Œ ê°€ì§.

------

### âš ï¸ 4. ì˜ëª» ì“°ê¸° ì‰¬ìš´ ì‚¬ë¡€ ë¹„êµ

#### âŒ ë‚˜ìœ ì˜ˆ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ì— ë„£ìŒ)

```
public void createDiscountedOrder(OrderRequestDto dto) {
    if (dto.price > 10000) {
        dto.discount = 0.1;
    }
    Order order = new Order(dto);
    ...
}
```

> ì´ëŸ° ë¹„ì¦ˆë‹ˆìŠ¤ ì¡°ê±´ì€ **ë„ë©”ì¸ ê·œì¹™**ì´ë©° â†’ ë„ë©”ì¸ or ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¡œ ë‚´ë ¤ë³´ë‚´ì•¼ í•¨.

------

### ğŸ“š 5. ì‹¤ì „ ë¹„êµ ì˜ˆì œ

#### âœ” ë„ë©”ì¸ ì„œë¹„ìŠ¤

```
public class PasswordStrengthChecker {
    public boolean isWeak(String password) {
        return password.length() < 8 || password.matches(".*1234.*");
    }
}
```

#### âœ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ì—ì„œ í˜¸ì¶œ

```
public class UserRegistrationUseCase {

    private final PasswordStrengthChecker passwordChecker;

    public void register(RegisterUserCommand cmd) {
        if (passwordChecker.isWeak(cmd.password())) {
            throw new WeakPasswordException();
        }
        ...
    }
}
```

------

### âœ… ìš”ì•½ ì •ë¦¬í‘œ

| í•­ëª©      | Application Service            | Domain Service            |
| --------- | ------------------------------ | ------------------------- |
| ëª©ì       | ìœ ìŠ¤ì¼€ì´ìŠ¤ íë¦„ ì œì–´           | ë„ë©”ì¸ ê·œì¹™ ì •ì˜          |
| ìœ„ì¹˜      | ì‘ìš© ê³„ì¸µ                      | ë„ë©”ì¸ ê³„ì¸µ               |
| ìƒíƒœ ë³´ìœ  | âŒ                              | âŒ                         |
| ìˆœìˆ˜ì„±    | íŠ¸ëœì­ì…˜, ë¦¬í¬ì§€í† ë¦¬ ì‚¬ìš© ê°€ëŠ¥ | ê¸°ìˆ  ë…ë¦½, ìˆœìˆ˜ ìë°” ë¡œì§ |
| í…ŒìŠ¤íŠ¸    | Mocking í•„ìš”                   | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë§¤ìš° ì‰¬ì›€     |
| ì˜ì¡´ì„±    | ì™¸ë¶€ ì‹œìŠ¤í…œ ì˜ì¡´ ê°€ëŠ¥          | ë„ë©”ì¸ ê°ì²´ë§Œ ì˜ì¡´ ê°€ëŠ¥   |

------

### ğŸ§± ë””ë ‰í„°ë¦¬ êµ¬ì¡° ì˜ˆì‹œ

```
user/
â”œâ”€â”€ application/
â”‚   â””â”€â”€ RegisterUserUseCase.java
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ User.java
â”‚   â””â”€â”€ PasswordStrengthChecker.java  â† ë„ë©”ì¸ ì„œë¹„ìŠ¤
â”œâ”€â”€ command/
â”‚   â””â”€â”€ RegisterUserCommand.java
```

------

### âœ… ê²°ë¡ 

| ìƒí™©                                  | ì„ íƒ                |
| ------------------------------------- | ------------------- |
| íë¦„ ì¡°ìœ¨, ì™¸ë¶€ ì‹œìŠ¤í…œ í˜¸ì¶œ, íŠ¸ëœì­ì…˜ | Application Service |
| í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™, ì—”í‹°í‹° ì™¸ë¶€ íŒë‹¨  | Domain Service      |

## ì˜ˆ: `UserRegistrationService`, `OrderApplicationService`

### âœ… ì˜ˆì‹œ 1: `UserRegistrationService` (íšŒì›ê°€ì… ìœ ìŠ¤ì¼€ì´ìŠ¤)

------

#### ğŸ“Œ ìš”êµ¬ì‚¬í•­

- ì‚¬ìš©ìê°€ ì´ë¦„, ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´
- ì´ë©”ì¼ ì¤‘ë³µì„ í™•ì¸í•˜ê³ 
- ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”í•´ì„œ
- ìƒˆ ì‚¬ìš©ìë¥¼ ë“±ë¡í•˜ê³ 
- ì´ë©”ì¼ ì•Œë¦¼ì„ ë°œì†¡í•œë‹¤

------

#### ğŸ“¦ Command ê°ì²´

```
public record RegisterUserCommand(String name, String email, String password) {}
```

------

#### ğŸ“¦ ë„ë©”ì¸ ê°ì²´

```
@Entity
public class User {
    @Id @GeneratedValue
    private Long id;

    private String name;
    private String email;
    private String encryptedPassword;

    protected User() {}

    public User(String name, String email, String encryptedPassword) {
        this.name = name;
        this.email = email;
        this.encryptedPassword = encryptedPassword;
    }
}
```

------

#### ğŸ“¦ ë„ë©”ì¸ ì„œë¹„ìŠ¤ (ì„ íƒ)

```
public class PasswordPolicyService {
    public boolean isWeak(String password) {
        return password.length() < 8 || password.contains("1234");
    }
}
```

------

#### âš™ï¸ Application Service (UserRegistrationService)

```
@Service
public class UserRegistrationService {

    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;
    private final EmailSender emailSender;
    private final PasswordPolicyService passwordPolicy;

    @Transactional
    public void register(RegisterUserCommand cmd) {
        if (userRepository.existsByEmail(cmd.email())) {
            throw new DuplicateEmailException();
        }

        if (passwordPolicy.isWeak(cmd.password())) {
            throw new WeakPasswordException();
        }

        String encryptedPassword = passwordEncoder.encode(cmd.password());
        User user = new User(cmd.name(), cmd.email(), encryptedPassword);
        userRepository.save(user);

        emailSender.sendWelcome(cmd.email());
    }
}
```

------

### âœ… êµ¬ì¡° ìš”ì•½

| êµ¬ì„±ìš”ì†Œ            | í´ë˜ìŠ¤                                             |
| ------------------- | -------------------------------------------------- |
| Command             | `RegisterUserCommand`                              |
| Application Service | `UserRegistrationService`                          |
| Domain Entity       | `User`                                             |
| Domain Service      | `PasswordPolicyService`                            |
| Infra ì˜ì¡´          | `UserRepository`, `EmailSender`, `PasswordEncoder` |

------

### âœ… ì˜ˆì‹œ 2: `OrderApplicationService` (ì£¼ë¬¸ ì²˜ë¦¬ ìœ ìŠ¤ì¼€ì´ìŠ¤)

------

### ğŸ“Œ ìš”êµ¬ì‚¬í•­

- ì‚¬ìš©ìê°€ ìƒí’ˆì„ ì£¼ë¬¸í•˜ë©´
- ì¬ê³ ë¥¼ ì°¨ê°í•˜ê³ 
- ê²°ì œë¥¼ ìš”ì²­í•œ í›„
- ì£¼ë¬¸ ìƒíƒœë¥¼ "ê²°ì œ ì™„ë£Œ"ë¡œ ë³€ê²½í•˜ê³  ì €ì¥í•œë‹¤

------

#### ğŸ“¦ Command ê°ì²´

```
public record PlaceOrderCommand(Long userId, Long itemId, int quantity, PaymentInfo paymentInfo) {}
```

------

#### ğŸ“¦ ë„ë©”ì¸ ì—”í‹°í‹°

```
@Entity
public class Order {
    @Id @GeneratedValue
    private Long id;

    private Long userId;
    private Long itemId;
    private int quantity;
    private OrderStatus status;

    public Order(Long userId, Long itemId, int quantity) {
        this.userId = userId;
        this.itemId = itemId;
        this.quantity = quantity;
        this.status = OrderStatus.REQUESTED;
    }

    public void markAsPaid() {
        if (status != OrderStatus.REQUESTED) {
            throw new IllegalStateException("ì´ë¯¸ ì²˜ë¦¬ëœ ì£¼ë¬¸ì…ë‹ˆë‹¤.");
        }
        this.status = OrderStatus.PAID;
    }
}
```

------

#### ğŸ“¦ ë„ë©”ì¸ ì„œë¹„ìŠ¤ (ì˜ˆ: ë°°ì†¡ ì •ì±… íŒë‹¨ ë“±)

```
public class ShippingPolicy {
    public boolean isFreeShipping(int quantity) {
        return quantity >= 5;
    }
}
```

------

#### âš™ï¸ Application Service (OrderApplicationService)

```
@Service
public class OrderApplicationService {

    private final InventoryRepository inventoryRepository;
    private final OrderRepository orderRepository;
    private final PaymentGateway paymentGateway;

    @Transactional
    public void placeOrder(PlaceOrderCommand cmd) {
        Inventory inventory = inventoryRepository.findByItemId(cmd.itemId());
        inventory.decrease(cmd.quantity());

        paymentGateway.charge(cmd.paymentInfo());

        Order order = new Order(cmd.userId(), cmd.itemId(), cmd.quantity());
        order.markAsPaid();
        orderRepository.save(order);
    }
}
```

------

### âœ… êµ¬ì¡° ìš”ì•½

| êµ¬ì„±ìš”ì†Œ            | í´ë˜ìŠ¤                                                     |
| ------------------- | ---------------------------------------------------------- |
| Command             | `PlaceOrderCommand`                                        |
| Application Service | `OrderApplicationService`                                  |
| Domain Entity       | `Order`, `Inventory`                                       |
| Domain Service      | `ShippingPolicy` (ì„ íƒ)                                    |
| Infra ì˜ì¡´          | `OrderRepository`, `InventoryRepository`, `PaymentGateway` |

------

### ğŸ“ ê³µí†µ ì„¤ê³„ ì›ì¹™

| ì›ì¹™                    | ì„¤ëª…                                                |
| ----------------------- | --------------------------------------------------- |
| ìœ ìŠ¤ì¼€ì´ìŠ¤ ë‹¨ìœ„ë¡œ ë¶„ë¦¬  | `register()`, `placeOrder()`ëŠ” ê°ê° ë…ë¦½ ìœ ìŠ¤ì¼€ì´ìŠ¤ |
| Command â†’ Domain ì „í™˜   | ì§ì ‘ `User`, `Order` ê°ì²´ ìƒì„± ë˜ëŠ” íŒ©í† ë¦¬ ì‚¬ìš©     |
| íŠ¸ëœì­ì…˜ ì¡°ìœ¨ ìœ„ì¹˜ ëª…í™• | í•­ìƒ Application Serviceì— `@Transactional` ì„ ì–¸    |
| ì™¸ë¶€ ì‹œìŠ¤í…œ í˜¸ì¶œ        | ê²°ì œ, ì´ë©”ì¼ ë°œì†¡ ë“±ì€ ë„ë©”ì¸ ë°–ì—ì„œ ìˆ˜í–‰           |
| ë„ë©”ì¸ì€ ìˆœìˆ˜í•˜ê²Œ ìœ ì§€  | ì™¸ë¶€ API, DB ì ‘ê·¼, Validation ì±…ì„ ì—†ìŒ             |

## DTO/Command ê°ì²´ íŒ¨í„´

### ğŸ§© 1. ìš©ì–´ ì •ë¦¬

| ê°œë…                           | ì„¤ëª…                                                         |
| ------------------------------ | ------------------------------------------------------------ |
| **DTO** (Data Transfer Object) | í´ë¼ì´ì–¸íŠ¸ â†” ì„œë²„ ê°„ ë°ì´í„° ì „ë‹¬ìš© ê°ì²´. API ì…ì¶œë ¥ì— íŠ¹í™”   |
| **Command**                    | ìœ ìŠ¤ì¼€ì´ìŠ¤ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ **ë„ë©”ì¸ ë‚´ë¶€ ì „ë‹¬ ê°ì²´**, DTOë³´ë‹¤ ë” ë„ë©”ì¸ ì¹œí™”ì  |
| **Result DTO / Response DTO**  | ìœ ìŠ¤ì¼€ì´ìŠ¤ ìˆ˜í–‰ ê²°ê³¼ë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µí•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê°ì²´  |

------

### ğŸ¯ 2. ì™œ ë¶„ë¦¬í•˜ëŠ”ê°€?

| ì´ìœ                   | ì„¤ëª…                                                         |
| --------------------- | ------------------------------------------------------------ |
| ğŸ” ë„ë©”ì¸ ëª¨ë¸ ë³´í˜¸    | ì™¸ë¶€ ìš”ì²­ì´ ë„ë©”ì¸ ëª¨ë¸ì„ ì§ì ‘ ê±´ë“œë¦¬ì§€ ì•Šë„ë¡ ìº¡ìŠí™”        |
| ğŸ§­ ê³„ì¸µ ê°„ ì±…ì„ ëª…í™•í™” | Presentation â†” Application â†” Domain ê³„ì¸µ ê°„ ê²½ê³„ ìœ ì§€        |
| ğŸ”„ ì¬ì‚¬ìš©ì„± í–¥ìƒ       | CommandëŠ” ìœ ìŠ¤ì¼€ì´ìŠ¤ ë‚´ë¶€ì—ì„œ ì¬ì‚¬ìš© ê°€ëŠ¥, DTOëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ì „ìš© |
| ğŸ§ª í…ŒìŠ¤íŠ¸ í¸ì˜ì„±       | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹œ Commandë§Œ ì£¼ì…í•˜ë©´ ë¨ (ë³µì¡í•œ ì»¨íŠ¸ë¡¤ëŸ¬ ì•ˆ ì¨ë„ ë¨) |

------

### ğŸ§· 3. ê³„ì¸µ íë¦„ êµ¬ì¡°

```
Client JSON
   â†“
@RequestBody DTO
   â†“ (toCommand)
Command ê°ì²´
   â†“
Application Service
   â†“
Domain Entity / Domain Service
   â†“
Result DTO or Response
   â†“
ResponseEntity<DTO>
   â†“
Client
```

------

### ğŸ”¨ 4. ì‹¤ì „ ì˜ˆì‹œ: ì‚¬ìš©ì íšŒì›ê°€ì… íë¦„

------

#### ğŸ“¥ ìš”ì²­ DTO (API ìš”ì²­ ìˆ˜ì‹ )

```
public class RegisterUserRequest {

    @NotBlank private String name;
    @Email private String email;
    @NotBlank private String password;

    public RegisterUserCommand toCommand() {
        return new RegisterUserCommand(name, email, password);
    }
}
```

- ì‚¬ìš©ìê°€ JSONìœ¼ë¡œ ë³´ë‚¸ ë°ì´í„°ì™€ **1:1 ëŒ€ì‘**
- `@Valid` ë“±ì„ ë¶™ì—¬ **ì…ë ¥ ê²€ì¦ ì „ìš©**
- ë„ë©”ì¸ì—ì„œëŠ” ì ˆëŒ€ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ

------

#### ğŸ§¾ Command ê°ì²´ (Application/Domain ì „ë‹¬ìš©)

```
public record RegisterUserCommand(
    String name,
    String email,
    String password
) {}
```

- ìœ ìŠ¤ì¼€ì´ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ëŠ” **ì˜ë¯¸ ìˆëŠ” ì…ë ¥ ë°ì´í„°**
- ìˆœìˆ˜ Java íƒ€ì…, ê°’ë§Œ ê°–ê³  ìˆê³  ë¡œì§ ì—†ìŒ
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹œ ì§ì ‘ ìƒì„±í•´ì„œ ë°”ë¡œ ì£¼ì… ê°€ëŠ¥

------

#### ğŸ“¤ ì‘ë‹µ DTO (ê²°ê³¼ ë°˜í™˜ìš©)

```
public class RegisterUserResponse {
    private Long userId;
    private String name;

    public RegisterUserResponse(User user) {
        this.userId = user.getId();
        this.name = user.getName();
    }
}
```

- ë„ë©”ì¸ ê°ì²´ â†’ ì‘ë‹µìœ¼ë¡œ ê°€ê³µí•  ë•Œ ì‚¬ìš©
- í´ë¼ì´ì–¸íŠ¸ì— í•„ìš”í•œ ì •ë³´ë§Œ ë‹´ìŒ
- ë³´ì•ˆìƒ ë…¸ì¶œí•˜ë©´ ì•ˆ ë˜ëŠ” ë°ì´í„°ëŠ” ìˆ¨ê¹€

------

#### âš™ï¸ Application Service

```
@Service
public class UserRegistrationService {

    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;

    @Transactional
    public User register(RegisterUserCommand cmd) {
        if (userRepository.existsByEmail(cmd.email())) {
            throw new DuplicateEmailException();
        }

        String encrypted = passwordEncoder.encode(cmd.password());
        User user = new User(cmd.name(), cmd.email(), encrypted);
        return userRepository.save(user);
    }
}
```

------

#### ğŸ® Controller

```
@RestController
@RequestMapping("/api/users")
public class UserController {

    private final UserRegistrationService userRegistrationService;

    @PostMapping
    public ResponseEntity<RegisterUserResponse> register(
        @RequestBody @Valid RegisterUserRequest request
    ) {
        User user = userRegistrationService.register(request.toCommand());
        return ResponseEntity.status(HttpStatus.CREATED)
                             .body(new RegisterUserResponse(user));
    }
}
```

------

### âœ… DTO vs Command vs Response ì°¨ì´ ìš”ì•½í‘œ

| êµ¬ë¶„   | DTO (Request)            | Command                 | Response DTO             |
| ------ | ------------------------ | ----------------------- | ------------------------ |
| ìœ„ì¹˜   | Controller               | Application Layer ë‚´ë¶€  | Controller (ì‘ë‹µ)        |
| ëª©ì    | API ìš”ì²­ ë§¤í•‘            | ìœ ìŠ¤ì¼€ì´ìŠ¤ ì‹¤í–‰         | API ì‘ë‹µ ê°€ê³µ            |
| ë‚´ìš©   | í´ë¼ì´ì–¸íŠ¸ì™€ 1:1         | ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ë¯¸ ì¤‘ì‹¬      | ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì¤„ ë°ì´í„° |
| ê²€ì¦   | `@Valid`, `@NotBlank` ë“± | ë³´í†µ ì—†ìŒ (ì´ë¯¸ ê²€ì¦ë¨) | ë³´ì•ˆ í•„í„°ë§ í¬í•¨ ê°€ëŠ¥    |
| í…ŒìŠ¤íŠ¸ | Mock MVCì— ì í•©          | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì— ì í•©      | JSON ìŠ¤í™ ë¬¸ì„œí™”ì— ì í•©  |

------

### ğŸ›  ì‹¤ì „ ê°œë°œ íŒ

| íŒ                               | ì„¤ëª…                                                         |
| -------------------------------- | ------------------------------------------------------------ |
| DTOì—ëŠ” ë¡œì§ ë„£ì§€ ë§ê¸°           | getter/setter ë˜ëŠ” toCommandë§Œ í—ˆìš©                          |
| Commandì—ëŠ” ê²€ì¦ ë¡œì§ ë„£ì§€ ë§ê¸°  | ê²€ì¦ì€ Controller ë˜ëŠ” Validatorì—ì„œ                         |
| DTOì™€ Command ì´ë¦„ êµ¬ë¶„          | `UserRequest`, `UserCommand`, `UserResponse`ë¡œ ëª…í™•íˆ ë‚˜ëˆ ì•¼ |
| Value Objectì™€ Command í˜¼ë™ ê¸ˆì§€ | CommandëŠ” ì…ë ¥ê°’, VOëŠ” ë„ë©”ì¸ ì†ì„±                           |

------

### ğŸ§± ë””ë ‰í† ë¦¬ êµ¬ì¡° ì˜ˆì‹œ

```
user/
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ UserController.java
â”œâ”€â”€ dto/
â”‚   â”œâ”€â”€ RegisterUserRequest.java
â”‚   â””â”€â”€ RegisterUserResponse.java
â”œâ”€â”€ command/
â”‚   â””â”€â”€ RegisterUserCommand.java
â”œâ”€â”€ application/
â”‚   â””â”€â”€ UserRegistrationService.java
â”œâ”€â”€ domain/
â”‚   â””â”€â”€ User.java
```

------

### âœ… ë§ˆë¬´ë¦¬ í•µì‹¬ ìš”ì•½

| ê·œì¹™                                                       | ì„¤ëª…                                                         |
| ---------------------------------------------------------- | ------------------------------------------------------------ |
| API â†” DTO â†” Command â†” Domain ìˆœìœ¼ë¡œ íë¥¸ë‹¤                 | ì™¸ë¶€ ìš”ì²­ì€ DTOë¡œ ë°›ê³ , ë‚´ë¶€ì—ì„œëŠ” Command ê°ì²´ë¡œ ì „ë‹¬í•œ ë’¤, ë„ë©”ì¸ ë¡œì§ì—ì„œ ì²˜ë¦¬í•¨.<br />**ì—­ë°©í–¥ìœ¼ë¡œ íë¥´ë©´ ê³„ì¸µ ê°„ ì±…ì„ì´ ì„ì—¬ êµ¬ì¡°ê°€ ë¬´ë„ˆì§**. |
| CommandëŠ” Application Layerì˜ ì…ë ¥ ëª¨ë¸ì´ë‹¤                | CommandëŠ” DTOê°€ ì•„ë‹˜. `ìœ ìŠ¤ì¼€ì´ìŠ¤ ì‹¤í–‰ì— í•„ìš”í•œ í•„ìˆ˜ ë°ì´í„°`ë§Œì„ ë‹´ì€ **ë‚´ë¶€ ì „ë‹¬ ê°ì²´**ì´ë©°,<br />Application Layerê°€ ë„ë©”ì¸ì„ í˜¸ì¶œí•  ë•Œ ì‚¬ìš©í•˜ëŠ” **ì˜ë¯¸ ì¤‘ì‹¬ì˜ ëª¨ë¸**ì´ë‹¤. |
| DTOëŠ” Web ìš”ì²­/ì‘ë‹µì—ë§Œ ì‚¬ìš©ë˜ì–´ì•¼ í•œë‹¤                    | DTOëŠ” Controllerì—ë§Œ êµ­í•œë˜ì–´ì•¼ í•˜ë©°,<br />ë„ë©”ì¸ ë˜ëŠ” Application Serviceì— ì§ì ‘ ë„˜ê¸°ë©´ **í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µì´ ë„ë©”ì¸ì„ ì¹¨ë²”**í•˜ëŠ” êµ¬ì¡°ê°€ ëœë‹¤. |
| ì‘ë‹µ DTOëŠ” ë„ë©”ì¸ ì—”í‹°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ë…¸ì¶œí•˜ì§€ ì•Šë„ë¡ êµ¬ì„±í•œë‹¤ | `User`, `Order` ê°™ì€ ë„ë©”ì¸ ê°ì²´ë¥¼ JSONìœ¼ë¡œ ì§ì ‘ ì‘ë‹µí•˜ë©´<br />* ë³´ì•ˆ ì´ìŠˆ (ë¹„ë°€ë²ˆí˜¸, ë‚´ë¶€ ìƒíƒœ ë…¸ì¶œ)<br />* ìˆœí™˜ ì°¸ì¡° ë¬¸ì œ<br />* API ë²„ì „ ê´€ë¦¬ ì–´ë ¤ì›€<br/> ì´ ìƒê¹€. â†’ ë°˜ë“œì‹œ `Response DTO`ë¥¼ ë³„ë„ë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•´ì•¼ í•œë‹¤. |
| ê³„ì¸µ ê°„ ê°ì²´ëŠ” ì ˆëŒ€ ì„ì´ì§€ ë§ì•„ì•¼ í•œë‹¤ (ìˆœí™˜, ê²°í•© ìœ„í—˜)   | * `DTO`ê°€ ë„ë©”ì¸ ê°ì²´ë¥¼ ì˜ì¡´í•˜ê±°ë‚˜<br />* `ë„ë©”ì¸ ê°ì²´`ê°€ DTO ë˜ëŠ” Controllerë¥¼ ì•Œê²Œ ë˜ë©´<br/> â†’ **ì˜ì¡´ ë°©í–¥ì´ ì—­ì „**ë˜ì–´ SRP/DI ì›ì¹™ì´ ë¬´ë„ˆì§.<br/> ê³„ì¸µë§ˆë‹¤ **ë…ë¦½ì„±ê³¼ ì±…ì„ì˜ ê²½ê³„ë¥¼ ì² ì €íˆ ì§€ì¼œì•¼ ìœ ì§€ë³´ìˆ˜ ê°€ëŠ¥í•œ ì‹œìŠ¤í…œì´ ëœë‹¤.** |

### âœ… ìš”ì•½ ì •ë¦¬

| ê³„ì¸µ                | ê°ì²´                   | ì—­í•                         |
| ------------------- | ---------------------- | --------------------------- |
| Controller          | DTO (Request/Response) | ìš”ì²­ ë°”ì¸ë”©, ì‘ë‹µ ìƒì„± ì „ìš© |
| Application Service | Command                | ìœ ìŠ¤ì¼€ì´ìŠ¤ ì‹¤í–‰ìš© ì…ë ¥ ëª¨ë¸ |
| Domain              | Entity/VO              | ë¹„ì¦ˆë‹ˆìŠ¤ ìƒíƒœ, ê·œì¹™ ì²˜ë¦¬    |