# 스프링 프레임워크 시작하기

스프링 웹 개발에 필요한 개발 환경을 구축한다.

개발 환경은 AWS EC2, Ubuntu OS, JDK, STS, Apache 서버, Tomcat 서버, MariaDB 순으로 설치한다.

## 개발 환경 구축

### JDK 설치

JDK는 오라클 홈페이지에 접속하면 무료로 내려받을 수 있다. JDK를 내려받을 수 있는 위치는 버전에 따라 다르기도 하고 URL 정보가 자주 변경되므로 구체적으로 기술하지는 않으나, 개발 환경의 버전을 알맞게 구성하는 것은 매우 중요한 일이다. 가급적 LTS 버전을 사용한다.

### STS 설치

### Apache, Tomcat 설치

### 데이터베이스 구축

## 실습 프로젝트 생성

### 프로젝트 생성

1. File - New - Spring Legacy Project - Project name 설정 - Templates : 'Spring MVC Project' 선택 후 Next 버튼

2. 최상위 패키지를 지정하는 화면

   패키지 경로에 최소 세 개 이상의 패키지가 지정되어야 Finish 버튼이 활성화되고 프로젝트를 생성할 수 있다. 

   입력란에 "com.springbook.biz"라고 입력하고 Finish 버튼 클릭

### 프로젝트 설정 변경

STS를 이용하여 'Spring MVC Project' 프로젝트를 생성하면 JRE 버전도 맞지 않고 서버 라이브러리도 등록되지 않으므로 이를 적절히 변경해야 한다. 이클립스의 프로젝트 탐색창에서 Board Web 프로젝트를 선택한 상태에서 마우스 오른쪽 버튼을 클릭하여 맨 아래에 [Properties]를 선택한다.

우선 왼쪽에서 [Project Facets]를 선택하고 Java 버전을 설치한 버전으로 수정한다.

그리고 오른쪽에 [Runtimes] 탭을 선택하고 'Apache Tomcat' 버전을 설치한 버전으로 체크한 후에 Apply, OK 버튼을 누른다.

설정을 마치고 다시 왼쪽에서 Java Build Path를 클릭하고 Libraries 탭을 클릭하여 경로를 확인했을 때 BuildPath는 이전에 선택한 3가지가 있어야 한다.

프로젝트가 생성되고 나면 스프링 기반의 웹 프로젝트 수행에 필요한 기본 설정 파일들과 소스들이 자동으로 생성된다. 이 파일들을 정리해야 앞으로 진행할 실습이 의미가 있다. 우선 src/main/resources 소스 폴더에 log4j.xml 파일을 제외한 나머지(패키지, 폴더, 파일들)는 모두 삭제한다.

그리고 src/main/webapp/WEB-INF 아래에 있는 spring과 views 폴더도 삭제한다.

# 프레임워크 개요

## 프레임 워크 개념

### 프레임워크의 등장 배경

프레임워크의 사전적 의미는 뼈대 혹은 틀로서 이 의미를 소프트웨어 관점에서 접근하면 아키텍처에 해당하는 골격 코드다.

### 프레임워크의 장점

잘 만들어진 프레임워크를 사용하면 애플리케이션에 대한 분석, 설계, 구현 모두에서 재사용성이 증가하는데, 이를 통해 다음과 같은 장점들을 얻을 수 있다.

### 자바 기반의 프레임워크

자바 기반의 프레임워크는 대부분 오픈소스 형태로 제공된다. 따라서 별도의 라이선스나 비용을 지불하지 않고 누구나 사용할 수 있으며, 기존의 프레임워크를 이용하여 자신만의 프레임워크를 구축할 수도 있다.

대표적인 자바 기반의 프레임워크로는 다음과 같은 것들이 있다.

## 스프링 프레임워크

### 스프링 탄생 배경

스프링 프레임워크는 로드 존슨이 2004년에 만든 오픈소스 프레임워크다. 스프링 프레임워크가 등장하기 이전에 자바 기반의 엔터프라이즈 애플리케이션은 대부분 EJB(Enterprise Java Beans)로 개발되었다. 그러나 EJB 기술은 EJB 컨테이너가 제공하는 많은 기능과 나름의 장점에도 불구하고 다음과 같은 여러 문제점 때문에 개발자들로부터 외면받을 수밖에 없었다.

### 스프링 프레임워크의 특징

스프링의 특징을 한 줄로 서술하면, "IoC와 AOP를 지원하는 경량의 컨테이너 프레임워크"로 표현할 수 있다.

## IoC(Inversion of Control) 컨테이너

스프링 프레임워크를 이해하는 데 가장 중요한 개념이 컨테이너이다. 컨테이너의 개념은 스프링에서 처음 사용된 것은 아니며, 기존의 서블릿이나 EJB 기술에서 이미 사용해왔다. 그리고 대부분의 컨테이너는 비슷한 구조와 동작 방식을 가지고 있으므로 서블릿 컨테이너를 통해 스프링 컨테이너의 동작 방식을 유추해볼 수 있다.

다음과 같이 간단한 서블릿 클래스를 만들었다고 가정한다.

### 결합도(Coupling)가 높은 프로그램

결합도란 하나의 클래스가 다른 클래스와 얼마나 많이 연결되어 있는지를 나타내는 표현이며, 결합도가 높은 프로그램은 유지보수가 어렵다. 이 결합도와 유지보수 관계를 이해하기 위해서 간단한 실습을 진행한다.

BoardWeb 프로젝트 src/main/java 소스 폴더에 SamsungTV 클래스를 작성한다.

### 다형성 이용하기

결합도를 낮추기 위해서 다양한 방법을 사용할 수 있겠지만, 가장 쉽게 생각할 수 있는 것이 객체지향 언어의 핵심 개념인 다형성(Polymorphism)을 이용하는 것이다. 앞에서 작성한 프로그램을 다형성을 이용하여 수정해본다. 다형성을 이용하려면 상속과 메소드 재정의(Overriding), 그리고 형변환이 필요하며, 자바 같은 객체지향 언어는 이를 문법으로 지원한다.

### 디자인 패턴 이용하기

결합도를 낮추기 위한 또 다른 방법으로 디자인 패턴을 이용하는 방법이 있다. 앞에서 살펴본 다형성을 이용하는 방법은 메소드를 호출할 때 인터페이스를 이용함으로써 좀 더 쉽게 TV를 교체할 수 있었다. 하지만 이 방법 역시 TV를 변경하고자 할 때, TV 클래스 객체를 생성하는 소스를 수정해야만 한다.

# 스프링 컨테이너 및 설정 파일

대부분 IoC 컨테이너는 각 컨테이너에서 관리할 객체들을 위한 별도의 설정 파일이 있다. Servlet 컨테이너는 web.xml 파일에, EJB 컨테이너는 ejb-jar.xml 파일에 해당 컨테이너가 생성하고 관리할 클래스들을 등록한다.

스프링 프레임워크도 다른 컨테이너와 마찬가지로 자신이 관리할 클래스들이 등록된 XML 설정 파일이 필요하다. 스프링 컨테이너가 사용할 XML 파일은 앞에서 설치한 STS를 이용하면 간단하게 만들 수 있다.

## 스프링 IoC 시작하기

### 스프링 설정 파일 생성

BoardWeb 프로젝트의 src/main/resources 소스 폴더를 선택하고 마우스 오른쪽 버튼을 클릭한다. 그리고 new - Other 메뉴를 클릭하면 아래와 같은 화면이 나온다. 여기서 'Spring' 폴더에 있는 'Spring Bean Configuration File'을 선택하고 Next를 클릭한다.

### 스프링 컨테이너 구동 및 테스트

스프링 설정 파일을 작성했으면 이제 TV 객체를 테스트하는 클라이언트를 만든다.

### 스프링 컨테이너의 종류

스프링에서는 BeanFactory와 이를 상속한 ApplicationContext 두 가지 유형의 컨테이너를 제공한다. 먼저 BeanFactory는 스프링 설정 파일에 등록된 bean 객체를 생성하고 관리하는 가장 기본적인 컨테이너 기능만 제공한다. 그리고 컨테이너가 구동될 때 bean 객체를 생성하는 것이 아니라, 클라이언트의 요청(Lookup)에 의해서만 bean 객체가 생성되는 지연 로딩(Lazy Loading) 방식을 사용한다. 따라서 일반적인 스프링 프로젝트에서 BeanFactory를 사용할 일은 전혀 없다.

## 스프링 XML 설정

### beans 루트 엘리먼트

스프링 컨테이너는 bean 저장소에 해당하는 XML 설정 파일을 참조하여 bean의 생명주기를 관리하고 여러 가지 서비스를 제공한다. 따라서 스프링 프로젝트 전체에서 가장 중요한 역할을 담당하며, 이 설정 파일을 정확하게 작성하고 관리하는 것이 무엇보다 중요하다.

### import 엘리먼트

스프링 설정 파일 하나에 우리가 만든 모든 클래스를 bean으로 등록하고 관리할 수도 있다. 하지만 스프링 기반의 애플리케이션은 단순한 bean 등록 외에도 트랜잭션 관리, 예외처리, 다국어 처리 등 복잡하고 다양한 설정이 필요하다.

### bean 엘리먼트

스프링 설정 파일에 클래스를 등록하려면 bean 엘리먼트를 사용한다. 이때 id와 class 속성을 사용하는데, id 속성은 생략할 수 있지만 class 속성은 필수이다. class 속성에 클래스를 등록할 때는 정확한 패키지 경로와 클래스 이름을 지정해야 한다. 따라서 될 수 있으면 STS의 자동 완성 기능을 이용하여 클래스를 정확하게 등록하기를 권장한다.

