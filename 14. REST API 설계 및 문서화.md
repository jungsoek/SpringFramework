# 14. REST API ì„¤ê³„ ë° ë¬¸ì„œí™”

## RESTful API ì„¤ê³„ ì›ì¹™

### ğŸ§© 1. RESTë€?

> **REpresentational State Transfer**ì˜ ì•½ì
>  ìì›(Resource)ì„ URIë¡œ í‘œí˜„í•˜ê³ , ìƒíƒœ(í–‰ìœ„)ëŠ” HTTP ë©”ì„œë“œë¡œ ì „ë‹¬í•˜ëŠ”
>  **ì›¹ ê¸°ë°˜ì˜ ì•„í‚¤í…ì²˜ ìŠ¤íƒ€ì¼**

ğŸ“Œ í•µì‹¬ ì² í•™:

- URLì€ **ìì›(Resource)**ì„ í‘œí˜„í•˜ê³ 
- HTTP MethodëŠ” **í–‰ìœ„(Action)**ë¥¼ í‘œí˜„í•¨

------

### ğŸ“ 2. RESTful URI ì„¤ê³„ ì›ì¹™

| ì›ì¹™                            | ì„¤ëª…                                                |
| ------------------------------- | --------------------------------------------------- |
| **ìì› ì¤‘ì‹¬**                   | ë™ì‚¬ëŠ” ì“°ì§€ ì•Šê³ , ëª…ì‚¬ë¡œ í‘œí˜„                       |
| **ê³„ì¸µ êµ¬ì¡°**                   | í•˜ìœ„ ìì›ì„ í¬í•¨í•  ë• ì¤‘ì²© í‘œí˜„                     |
| **ë³µìˆ˜í˜• ëª…ì‚¬ ì‚¬ìš©**            | ì¼ê´€ì„± ìˆê²Œ ì„¤ê³„ (`users`, `orders`, `products`)    |
| **ì¿¼ë¦¬ëŠ” í•„í„°ë§/ê²€ìƒ‰ì—ë§Œ ì‚¬ìš©** | ê²€ìƒ‰ ì¡°ê±´, ì •ë ¬, í˜ì´ì§€ ë“±ì€ query parameterë¡œ ì²˜ë¦¬ |

#### âœ… ì˜ˆì‹œ

| ê¸°ëŠ¥             | URI                             |
| ---------------- | ------------------------------- |
| ì‚¬ìš©ì ì „ì²´ ì¡°íšŒ | `GET /users`                    |
| ì‚¬ìš©ì ë‹¨ê±´ ì¡°íšŒ | `GET /users/{id}`               |
| ì‚¬ìš©ì ìƒì„±      | `POST /users`                   |
| ì‚¬ìš©ì ìˆ˜ì •      | `PUT /users/{id}`               |
| ì‚¬ìš©ì ì‚­ì œ      | `DELETE /users/{id}`            |
| ì¡°ê±´ ê²€ìƒ‰        | `GET /users?age=20&gender=male` |
| í•˜ìœ„ ìì› ì¡°íšŒ   | `GET /users/{id}/orders`        |

------

### ğŸ“¦ 3. HTTP ë©”ì„œë“œ ì„¤ê³„ ì›ì¹™

| Method   | ìš©ë„      | íŠ¹ì§•                            |
| -------- | --------- | ------------------------------- |
| `GET`    | ì¡°íšŒ      | ì•ˆì „í•˜ê³  ë©±ë“±                   |
| `POST`   | ìƒì„±      | ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±, ìƒíƒœ ë³€ê²½        |
| `PUT`    | ì „ì²´ ìˆ˜ì • | ë©±ë“±, ë¦¬ì†ŒìŠ¤ ì—†ìœ¼ë©´ ìƒì„± ê°€ëŠ¥   |
| `PATCH`  | ë¶€ë¶„ ìˆ˜ì • | ì¼ë¶€ í•„ë“œë§Œ ìˆ˜ì •                |
| `DELETE` | ì‚­ì œ      | ë©±ë“±, ì—†ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•´ë„ OK |

> ğŸ“Œ "ë©±ë“±(idempotent)"ì´ë€: ê°™ì€ ìš”ì²­ì„ ì—¬ëŸ¬ ë²ˆ ë³´ë‚´ë„ ê²°ê³¼ê°€ ê°™ë‹¤ëŠ” ëœ»

------

### ğŸ¯ 4. HTTP ì‘ë‹µ ìƒíƒœ ì½”ë“œ ì„¤ê³„

| ìƒíƒœ ì½”ë“œ                   | ì˜ë¯¸                          | ì‚¬ìš© ì˜ˆ              |
| --------------------------- | ----------------------------- | -------------------- |
| `200 OK`                    | ì •ìƒ ì²˜ë¦¬                     | ì¼ë°˜ ì¡°íšŒ, ìˆ˜ì •      |
| `201 Created`               | ìƒì„± ì„±ê³µ                     | `POST /users` í›„     |
| `204 No Content`            | ì„±ê³µí–ˆì§€ë§Œ ë°˜í™˜í•  ë°ì´í„° ì—†ìŒ | ì‚­ì œ í›„              |
| `400 Bad Request`           | ì˜ëª»ëœ ìš”ì²­                   | í•„ìˆ˜ í•„ë“œ ëˆ„ë½ ë“±    |
| `401 Unauthorized`          | ì¸ì¦ í•„ìš”                     | í† í° ì—†ìŒ            |
| `403 Forbidden`             | ê¶Œí•œ ë¶€ì¡±                     | ì ‘ê·¼ ë¶ˆê°€ ë¦¬ì†ŒìŠ¤     |
| `404 Not Found`             | ìì› ì—†ìŒ                     | ì—†ëŠ” ID ì¡°íšŒ         |
| `409 Conflict`              | ì¤‘ë³µ ì¶©ëŒ                     | ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë°ì´í„° |
| `500 Internal Server Error` | ì„œë²„ ì˜¤ë¥˜                     | ì˜ˆì™¸ ë¯¸ì²˜ë¦¬ ì‹œ       |

------

### ğŸ§ª 5. ì‘ë‹µ êµ¬ì¡° ì„¤ê³„ (í‘œì¤€í™” ì¶”ì²œ)

```
{
  "success": true,
  "data": {
    "id": 1,
    "name": "Jeongseok"
  },
  "error": null
}
```

ì‹¤ë¬´ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ í‘œì¤€ êµ¬ì¡°ê°€ ë§ì´ ì“°ì„:

```
{
  "code": "USER_NOT_FOUND",
  "message": "ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
  "status": 404
}
```

------

### ğŸ§  6. ê³„ì¸µì  ìì› ì„¤ê³„

#### âœ… ì¤‘ì²©ëœ ìì›

| ìì›                  | URI                                    |
| --------------------- | -------------------------------------- |
| íŠ¹ì • ì‚¬ìš©ì ì£¼ë¬¸ ëª©ë¡ | `GET /users/{userId}/orders`           |
| íŠ¹ì • ì‚¬ìš©ì íŠ¹ì • ì£¼ë¬¸ | `GET /users/{userId}/orders/{orderId}` |

> í•„ìš” ì‹œ `orders/{id}` ë‹¨ë… ê²½ë¡œë„ ë³‘í–‰ ì„¤ê³„ ê°€ëŠ¥

------

### ğŸ” 7. ë³´ì•ˆ & ë²„ì „ ê´€ë¦¬

#### âœ… ë²„ì „ ê´€ë¦¬

| ë°©ì‹          | ì˜ˆì‹œ                                      |
| ------------- | ----------------------------------------- |
| URI ë°©ì‹      | `/api/v1/users` âœ… ì‹¤ë¬´ì—ì„œ ê°€ì¥ í”í•¨      |
| í—¤ë” ë°©ì‹     | `Accept: application/vnd.company.v1+json` |
| íŒŒë¼ë¯¸í„° ë°©ì‹ | `GET /users?version=1` (ê¶Œì¥ ì•ˆ í•¨)       |

#### âœ… ë³´ì•ˆ

| í•­ëª©       | ì„¤ëª…                                                         |
| ---------- | ------------------------------------------------------------ |
| ì¸ì¦       | JWT, OAuth2                                                  |
| HTTPS ì‚¬ìš© | ëª¨ë“  APIëŠ” HTTPS í•„ìˆ˜                                        |
| CORS ì„¤ì •  | í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ ì‹œ `@CrossOrigin` ë˜ëŠ” ê¸€ë¡œë²Œ ì„¤ì •           |
| ì…ë ¥ ê²€ì¦  | `@Valid`, `BindingResult`, ì˜ˆì™¸ ì²˜ë¦¬ (`@ControllerAdvice`) í•„ìˆ˜ |

------

### ğŸ§© 8. ê¸°íƒ€ ì‹¤ë¬´ ì„¤ê³„ í¬ì¸íŠ¸

| í•­ëª©          | ì„¤ê³„ ê¸°ì¤€                                                    |
| ------------- | ------------------------------------------------------------ |
| í˜ì´ì§•        | `GET /users?page=1&size=10`                                  |
| ì •ë ¬          | `sort=createdDate,desc`                                      |
| í•„í„°ë§        | `GET /products?category=shoes&brand=nike`                    |
| ìƒíƒœ ë³€ê²½ API | `PATCH /orders/{id}/cancel`, ë˜ëŠ” `/orders/{id}` + `"status": "CANCELLED"` |
| íŒŒì¼ ì—…ë¡œë“œ   | `POST /files` (Content-Type: multipart/form-data)            |
| ì‘ë‹µ ìºì‹±     | ETag, Cache-Control í—¤ë” ì‚¬ìš©                                |

------

### âœ… ë§ˆë¬´ë¦¬ ìš”ì•½í‘œ

| í•­ëª©        | ì›ì¹™                                                         |
| ----------- | ------------------------------------------------------------ |
| URI         | ìì› ì¤‘ì‹¬, ë³µìˆ˜í˜• ëª…ì‚¬ ì‚¬ìš©                                  |
| HTTP ë©”ì„œë“œ | í–‰ìœ„ í‘œí˜„, ì˜ë¯¸ì— ë§ê²Œ ì‚¬ìš© (`GET`, `POST`, `PUT`, `DELETE`) |
| ìƒíƒœ ì½”ë“œ   | ì ì ˆí•œ ì‘ë‹µ ì½”ë“œë¡œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ í”¼ë“œë°±                     |
| ì‘ë‹µ êµ¬ì¡°   | í†µì¼ëœ JSON êµ¬ì¡° ì‚¬ìš©                                        |
| ë²„ì „ ê´€ë¦¬   | URI ë°©ì‹ ì¶”ì²œ (`/api/v1`)                                    |
| ë³´ì•ˆ        | ì¸ì¦ í•„ìˆ˜, HTTPS ê¸°ë³¸, ê²€ì¦ ì²˜ë¦¬ ëª…í™•íˆ                      |
| REST ì² í•™   | ìƒíƒœ ì—†ëŠ”, í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ë¶„ë¦¬ êµ¬ì¡° ìœ ì§€                    |

## ìƒíƒœ ì½”ë“œ ì •ì˜

### ğŸ§© 1. ìƒíƒœ ì½”ë“œë€?

> HTTP ì‘ë‹µì˜ **ìƒíƒœë¥¼ ìˆ«ì ì½”ë“œë¡œ ë‚˜íƒ€ë‚´ëŠ” í‘œì¤€ ê·œê²©**
>  í´ë¼ì´ì–¸íŠ¸ëŠ” ì´ ìˆ«ìë¥¼ í†µí•´ **ìš”ì²­ì´ ì„±ê³µí–ˆëŠ”ì§€, ì‹¤íŒ¨í–ˆëŠ”ì§€, ì™œ ì‹¤íŒ¨í–ˆëŠ”ì§€**ë¥¼ ì´í•´í•¨

------

### ğŸ“¦ 2. ìƒíƒœ ì½”ë“œ 5ëŒ€ ë¶„ë¥˜

| ë²”ìœ„ | ë¶„ë¥˜ëª…            | ì˜ë¯¸                    |
| ---- | ----------------- | ----------------------- |
| 1xx  | **Informational** | ì²˜ë¦¬ ì¤‘ (ê±°ì˜ ì•ˆ ì”€)    |
| 2xx  | **Success**       | ìš”ì²­ ì„±ê³µ               |
| 3xx  | **Redirection**   | ìš”ì²­ ë¦¬ë‹¤ì´ë ‰ì…˜ í•„ìš”    |
| 4xx  | **Client Error**  | í´ë¼ì´ì–¸íŠ¸ ì˜ëª»         |
| 5xx  | **Server Error**  | ì„œë²„ ì˜¤ë¥˜ (ê°œë°œì ì±…ì„) |

------

### âœ… 3. ì‹¤ë¬´ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ìƒíƒœ ì½”ë“œ ì •ë¦¬

#### âœ”ï¸ 2xx: ì„±ê³µ

| ì½”ë“œ               | ì˜ë¯¸                      | ì„¤ëª…                                     |
| ------------------ | ------------------------- | ---------------------------------------- |
| **200 OK**         | ì¼ë°˜ ì„±ê³µ                 | ë°ì´í„° ì¡°íšŒ, ìˆ˜ì • ë“±                     |
| **201 Created**    | ë¦¬ì†ŒìŠ¤ ìƒì„± ì„±ê³µ          | `POST /users` ì´í›„                       |
| **202 Accepted**   | ìš”ì²­ ìˆ˜ë½ (ë¹„ë™ê¸° ì²˜ë¦¬)   | ì¦‰ì‹œ ì²˜ë¦¬ X                              |
| **204 No Content** | ì„±ê³µí•˜ì§€ë§Œ ì‘ë‹µ ë³¸ë¬¸ ì—†ìŒ | `DELETE`, `PUT` ì™„ë£Œ í›„ ìì› ë°˜í™˜ ë¶ˆí•„ìš” |

------

#### âœ”ï¸ 4xx: í´ë¼ì´ì–¸íŠ¸ ì˜ëª»

| ì½”ë“œ                         | ì˜ë¯¸                      | ì„¤ëª…                                                     |
| ---------------------------- | ------------------------- | -------------------------------------------------------- |
| **400 Bad Request**          | ì˜ëª»ëœ ìš”ì²­               | íŒŒë¼ë¯¸í„° ì˜¤ë¥˜, JSON êµ¬ì¡° ì˜¤ë¥˜ ë“±                         |
| **401 Unauthorized**         | ì¸ì¦ í•„ìš”                 | ë¡œê·¸ì¸ í•„ìš”, í† í° ëˆ„ë½                                   |
| **403 Forbidden**            | ì ‘ê·¼ ê¸ˆì§€                 | ì¸ì¦ì€ ëì§€ë§Œ ê¶Œí•œ ì—†ìŒ                                  |
| **404 Not Found**            | ìì› ì—†ìŒ                 | ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ID ë“±                                      |
| **405 Method Not Allowed**   | í—ˆìš©ë˜ì§€ ì•Šì€ HTTP ë©”ì„œë“œ | `POST`ë§Œ ê°€ëŠ¥í•œë° `PUT` ìš”ì²­                             |
| **409 Conflict**             | ë¦¬ì†ŒìŠ¤ ì¶©ëŒ               | ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê°’, ì¤‘ë³µ ìš”ì²­ ë“±                           |
| **422 Unprocessable Entity** | ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨          | JSON í˜•ì‹ì€ ë§ì§€ë§Œ ë‚´ìš©ì´ ìœ íš¨í•˜ì§€ ì•ŠìŒ (ì…ë ¥ ê²€ì¦ ì‹¤íŒ¨) |

------

#### âœ”ï¸ 5xx: ì„œë²„ ì˜¤ë¥˜

| ì½”ë“œ                          | ì˜ë¯¸             | ì„¤ëª…                                      |
| ----------------------------- | ---------------- | ----------------------------------------- |
| **500 Internal Server Error** | ì¼ë°˜ ì„œë²„ ì—ëŸ¬   | NPE, DB ì˜¤ë¥˜ ë“±                           |
| **502 Bad Gateway**           | ê²Œì´íŠ¸ì›¨ì´ ì˜¤ë¥˜  | í”„ë¡ì‹œë‚˜ API Gateway ì—°ë™ ì‹¤íŒ¨            |
| **503 Service Unavailable**   | ì„œë¹„ìŠ¤ ì¼ì‹œ ì¤‘ì§€ | ìœ ì§€ë³´ìˆ˜, ê³¼ë¶€í•˜ ë“±                       |
| **504 Gateway Timeout**       | ì‘ë‹µ ì§€ì—°        | íƒ€ì„ì•„ì›ƒ ë°œìƒ (DB, ì™¸ë¶€ API ì‘ë‹µ ì—†ìŒ ë“±) |

------

### ğŸ§  4. ì‹¤ë¬´ ì„¤ê³„ ê¸°ì¤€

| ìƒí™©               | ê¶Œì¥ ìƒíƒœ ì½”ë“œ                               |
| ------------------ | -------------------------------------------- |
| ì¡°íšŒ ì„±ê³µ          | `200 OK`                                     |
| ìƒì„± ì„±ê³µ          | `201 Created` + `Location` í—¤ë” (ìƒì„±ëœ URI) |
| ìˆ˜ì • í›„            | `200 OK` ë˜ëŠ” `204 No Content`               |
| ì‚­ì œ í›„            | `204 No Content`                             |
| ìš”ì²­ íŒŒë¼ë¯¸í„° ì˜¤ë¥˜ | `400 Bad Request`                            |
| ì¸ì¦ ì•ˆë¨          | `401 Unauthorized` (í† í° ì—†ìŒ)               |
| ê¶Œí•œ ì—†ìŒ          | `403 Forbidden` (í† í°ì€ ìœ íš¨í•˜ë‚˜ Role ë¯¸ë‹¬)  |
| ë¦¬ì†ŒìŠ¤ ì—†ìŒ        | `404 Not Found`                              |
| ì¤‘ë³µ ë“±ë¡ ì‹œ       | `409 Conflict`                               |
| ì…ë ¥ ìœ íš¨ì„± ì‹¤íŒ¨   | `422 Unprocessable Entity`                   |
| ì„œë²„ ì˜ˆì™¸          | `500 Internal Server Error`                  |

------

### ğŸ” 5. ì‚¬ìš©ì ì •ì˜ ìƒíƒœ ì½”ë“œ? â†’ âŒ

> âš ï¸ 612, 777, 999 ê°™ì€ **ë¹„í‘œì¤€ ì½”ë“œ ì‚¬ìš©ì€ ì ˆëŒ€ ì§€ì–‘**
>  â†’ HTTPëŠ” **í‘œì¤€ í”„ë¡œí† ì½œ**ì´ë©°, **ëª¨ë“  í´ë¼ì´ì–¸íŠ¸/í”„ë¡ì‹œ/ë„êµ¬ê°€ 3ìë¦¬ ìˆ«ì**ë§Œ ì¸ì‹

âœ… ëŒ€ì‹  **ì‘ë‹µ ë°”ë””ì— ë¹„ì¦ˆë‹ˆìŠ¤ ì—ëŸ¬ ì½”ë“œë¥¼ ì •ì˜**í•˜ì:

```
{
  "code": "USER_ALREADY_EXISTS",
  "message": "ì´ë¯¸ ê°€ì…ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤.",
  "status": 409
}
```

------

### ğŸ” 6. ì‘ë‹µ ì˜ˆì‹œ

#### âœ… 201 Created + Location

```
POST /users
â†’

HTTP/1.1 201 Created
Location: /users/1004
```

------

#### âœ… 204 No Content (ì‚­ì œ í›„)

```
DELETE /users/1004
â†’

HTTP/1.1 204 No Content
```

------

#### âœ… 400 Bad Request (ì…ë ¥ ì˜¤ë¥˜)

```
HTTP/1.1 400 Bad Request

{
  "code": "INVALID_INPUT",
  "message": "ì´ë©”ì¼ í˜•ì‹ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
}
```

------

### âœ… ë§ˆë¬´ë¦¬ ìš”ì•½í‘œ

| ë²”ìœ„          | ì˜ë¯¸            | ëŒ€í‘œ ì½”ë“œ                         | ì‚¬ìš© ìš©ë„                               |
| ------------- | --------------- | --------------------------------- | --------------------------------------- |
| 2xx           | ì„±ê³µ            | `200`, `201`, `204`               | CRUD ì„±ê³µ                               |
| 4xx           | í´ë¼ì´ì–¸íŠ¸ ì˜ëª» | `400`, `401`, `403`, `404`, `409` | ì…ë ¥/ì¸ì¦/ê¶Œí•œ ì˜¤ë¥˜                     |
| 5xx           | ì„œë²„ ì˜ëª»       | `500`, `503`, `504`               | ì½”ë“œ ì˜ˆì™¸, íƒ€ ì‹œìŠ¤í…œ ì˜¤ë¥˜               |
| âŒ ì‚¬ìš©ì ì •ì˜ | âŒ               | `999`, `777` ë“±                   | âŒ ì ˆëŒ€ ì§€ì–‘ â€“ ë°”ë””ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ì½”ë“œ ì „ë‹¬ |

## REST ì˜ˆì™¸ ì²˜ë¦¬ ì „ëµ

### ğŸ§© 1. ëª©í‘œ

- í´ë¼ì´ì–¸íŠ¸ê°€ **ì˜ˆì™¸ ìƒí™©ì„ ëª…í™•í•˜ê²Œ ì´í•´í•  ìˆ˜ ìˆë„ë¡**
- HTTP ìƒíƒœ ì½”ë“œ + ëª…í™•í•œ ë©”ì‹œì§€ + í‘œì¤€í™”ëœ ì‘ë‹µ í˜•ì‹ ì œê³µ

------

### âœ… 2. ê¸°ë³¸ ì²˜ë¦¬ íë¦„

```
ì˜ˆì™¸ ë°œìƒ
  â†“
Spring Exception Resolver
  â†“
â†’ @ExceptionHandler (ê°œë³„)
â†’ @ControllerAdvice (ê¸€ë¡œë²Œ)
â†’ Default Exception ì²˜ë¦¬
```

------

### ğŸ¯ 3. ì˜ˆì™¸ ì²˜ë¦¬ ë°©ì‹ 3ë‹¨ê³„

| ë°©ì‹                  | ì„¤ëª…                                                 |
| --------------------- | ---------------------------------------------------- |
| âœ… `@ExceptionHandler` | íŠ¹ì • ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì˜ˆì™¸ë¥¼ ì§ì ‘ ì²˜ë¦¬                   |
| âœ… `@ControllerAdvice` | ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì— ëŒ€í•œ ê¸€ë¡œë²Œ ì˜ˆì™¸ ì²˜ë¦¬            |
| âœ… `ResponseEntity<T>` | ì˜ˆì™¸ ë°œìƒ ì—¬ë¶€ì— ê´€ê³„ì—†ì´ ëª…í™•í•œ ì‘ë‹µ í¬ë§· ë°˜í™˜ ê°€ëŠ¥ |

------

### ğŸ“˜ 4. ResponseEntity ê¸°ë³¸ ì˜ˆì œ

```
@GetMapping("/users/{id}")
public ResponseEntity<UserDto> getUser(@PathVariable Long id) {
    User user = userRepository.findById(id)
        .orElseThrow(() -> new NotFoundException("ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."));

    return ResponseEntity.ok(UserDto.of(user));
}
```

------

### ğŸ“¦ 5. ì˜ˆì™¸ í´ë˜ìŠ¤ ì •ì˜ (Custom Exception)

```
public class NotFoundException extends RuntimeException {
    public NotFoundException(String message) {
        super(message);
    }
}
```

------

### âœ… 6. ê¸€ë¡œë²Œ ì˜ˆì™¸ ì²˜ë¦¬ with `@ControllerAdvice`

```
@RestControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(NotFoundException.class)
    public ResponseEntity<ErrorResponse> handleNotFound(NotFoundException ex) {
        return ResponseEntity
            .status(HttpStatus.NOT_FOUND)
            .body(new ErrorResponse("NOT_FOUND", ex.getMessage()));
    }

    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<ErrorResponse> handleValidation(MethodArgumentNotValidException ex) {
        String message = ex.getBindingResult().getFieldError().getDefaultMessage();
        return ResponseEntity
            .badRequest()
            .body(new ErrorResponse("INVALID_INPUT", message));
    }

    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleAll(Exception ex) {
        return ResponseEntity
            .status(HttpStatus.INTERNAL_SERVER_ERROR)
            .body(new ErrorResponse("INTERNAL_ERROR", "ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."));
    }
}
```

------

### ğŸ“„ 7. í‘œì¤€ ì—ëŸ¬ ì‘ë‹µ êµ¬ì¡°

```
{
  "code": "INVALID_INPUT",
  "message": "ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.",
  "status": 400
}
```

#### âœ… ErrorResponse í´ë˜ìŠ¤ ì˜ˆì‹œ

```
public class ErrorResponse {
    private final String code;
    private final String message;
    private final int status;

    public ErrorResponse(String code, String message) {
        this.code = code;
        this.message = message;
        this.status = resolveStatus(code);
    }

    // Optional: code â†’ status ë§¤í•‘ ë¡œì§ ì¶”ê°€
}
```

------

### ğŸ”’ 8. ì‹¤ë¬´ ì„¤ê³„ ê¸°ì¤€

| í•­ëª©                                      | ì„¤ê³„ ë°©ì‹                                                 |
| ----------------------------------------- | --------------------------------------------------------- |
| **ì˜ˆì™¸ëŠ” ë°˜ë“œì‹œ ì½”ë“œ/ë©”ì‹œì§€/ìƒíƒœê°’ í¬í•¨** | ErrorResponse í´ë˜ìŠ¤ ê³ ì •í™”                               |
| **ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ**            | ì˜ˆì™¸ ì²˜ë¦¬ ë¡œì§ì€ ì „ë¶€ `@ControllerAdvice`ë¡œ ë¶„ë¦¬          |
| **í´ë¼ì´ì–¸íŠ¸ê°€ í•´ì„í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°**      | code ê°’ì€ ë¬¸ìì—´ (`USER_NOT_FOUND`, `TOKEN_EXPIRED`) í˜•íƒœ |
| **ìƒíƒœ ì½”ë“œì™€ ì¼ì¹˜**                      | 404 ì˜ˆì™¸ â†’ 404 ì‘ë‹µ, 400 â†’ 400                            |
| **ìœ íš¨ì„± ê²€ì¦ ì˜ˆì™¸ ì²˜ë¦¬**                 | `MethodArgumentNotValidException`, `BindException` ëŒ€ì‘   |
| **Exceptionì€ ë§ˆì§€ë§‰ catch**              | ë¡œê·¸ ë‚¨ê¸°ê³  ëª¨í˜¸í•œ ì˜ˆì™¸ëŠ” `500` ì²˜ë¦¬                      |

------

### ğŸš« 9. ì ˆëŒ€ í•˜ë©´ ì•ˆ ë˜ëŠ” ê²ƒ

| ì˜ëª»ëœ íŒ¨í„´                     | ì´ìœ                                              |
| ------------------------------- | ------------------------------------------------ |
| ì˜ˆì™¸ë¥¼ ë¬´ì‹œí•˜ê³  null ë°˜í™˜       | ë””ë²„ê¹…, ë¡œê¹…, ë³´ì•ˆ ìœ„í—˜                          |
| ëª¨ë“  ì˜ˆì™¸ì— 200 OK ë°˜í™˜         | í´ë¼ì´ì–¸íŠ¸ê°€ ì •ìƒìœ¼ë¡œ ì¸ì‹                       |
| ìƒíƒœ ì½”ë“œ ì—†ì´ "message"ë§Œ ì „ë‹¬ | ê¸°ê³„ê°€ í•´ì„ ë¶ˆê°€ëŠ¥í•¨                             |
| ì‚¬ìš©ì ì •ì˜ ìƒíƒœì½”ë“œ (e.g. 999) | HTTP í‘œì¤€ ìœ„ë°˜, í”„ë¡ì‹œÂ·API Gatewayì—ì„œ ì˜¤ë¥˜ ë°œìƒ |

------

### âœ… ë§ˆë¬´ë¦¬ ìš”ì•½í‘œ

| í•­ëª©                | ì„¤ëª…                                             |
| ------------------- | ------------------------------------------------ |
| `@ControllerAdvice` | ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ ë‹´ë‹¹                              |
| `@ExceptionHandler` | ê°œë³„ ì˜ˆì™¸ í´ë˜ìŠ¤ ì²˜ë¦¬                            |
| `ResponseEntity`    | ìƒíƒœ ì½”ë“œ + ì‘ë‹µ êµ¬ì¡° ì§€ì • ê°€ëŠ¥                  |
| Error êµ¬ì¡°          | code, message, status í¬í•¨                       |
| ì‹¤ë¬´ ê¸°ì¤€           | í‘œì¤€ ì‘ë‹µ í¬ë§·, ê³µí†µ ì½”ë“œ ê´€ë¦¬, ëª…í™•í•œ ìƒíƒœ ë§¤í•‘ |
| í…ŒìŠ¤íŠ¸ ì „ëµ         | ì˜ˆì™¸ ë°œìƒ ì¼€ì´ìŠ¤ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í•„ìˆ˜                |

## í‘œì¤€ ì‘ë‹µ êµ¬ì¡° ì„¤ê³„

### ğŸ§© 1. ì™œ í•„ìš”í•œê°€?

- ë‹¤ì–‘í•œ í´ë¼ì´ì–¸íŠ¸(iOS, Android, Web)ê°€ APIë¥¼ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ íŒŒì‹±í•  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•¨
- ìƒíƒœ ì½”ë“œë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•œ **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì˜¤ë¥˜ íŒë‹¨** ê°€ëŠ¥
- âœ… ìœ ì§€ë³´ìˆ˜, ë””ë²„ê¹…, ë¬¸ì„œí™”ì— **ì¼ê´€ì„±ê³¼ ì•ˆì •ì„±** ì œê³µ

------

### ğŸ“¦ 2. ì‘ë‹µ ë¶„ë¥˜: 3ê°€ì§€

| ìœ í˜•        | ì„¤ëª…                            | ìƒíƒœ ì½”ë“œ                        |
| ----------- | ------------------------------- | -------------------------------- |
| âœ… ì„±ê³µ ì‘ë‹µ | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì„±ê³µ              | 200, 201, 204 ë“±                 |
| âœ… ì‹¤íŒ¨ ì‘ë‹µ | ìš”ì²­ì€ ì„±ê³µí–ˆì§€ë§Œ ë¹„ì¦ˆë‹ˆìŠ¤ ì‹¤íŒ¨ | 200 (ì‹¤ë¬´ì—ì„œ ìì£¼ ì‚¬ìš©) or 400+ |
| âœ… ì˜ˆì™¸ ì‘ë‹µ | ì‹œìŠ¤í…œ ì˜¤ë¥˜, ìœ íš¨ì„± ì˜¤ë¥˜ ë“±     | 400, 404, 500 ë“±                 |

------

### ğŸ“ 3. ê¸°ë³¸ ì‘ë‹µ í¬ë§· (ê³µí†µ êµ¬ì¡°)

```
{
  "success": true,
  "code": "SUCCESS",
  "message": "ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "data": {
    "id": 1,
    "name": "jeongseok"
  }
}
```

------

#### âŒ ì‹¤íŒ¨ ë˜ëŠ” ì˜ˆì™¸ì¼ ë•Œ

```
{
  "success": false,
  "code": "USER_NOT_FOUND",
  "message": "í•´ë‹¹ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
  "data": null
}
```

> â˜ï¸ `HTTP status`ëŠ” 404, 400, 500 ë“± ì‹¤ì œ ìƒíƒœ ì½”ë“œë¡œ ì„¤ì •í•˜ê³ 
>  ë³¸ë¬¸ì€ ì´ì²˜ëŸ¼ **í‘œì¤€í™”ëœ ë©”ì‹œì§€ êµ¬ì¡°**ë¡œ ì‘ë‹µ

------

### âœ… 4. ì‘ë‹µ í´ë˜ìŠ¤ ì„¤ê³„ (Generic ê¸°ë°˜)

```
public class ApiResponse<T> {

    private final boolean success;
    private final String code;
    private final String message;
    private final T data;

    private ApiResponse(boolean success, String code, String message, T data) {
        this.success = success;
        this.code = code;
        this.message = message;
        this.data = data;
    }

    public static <T> ApiResponse<T> success(T data) {
        return new ApiResponse<>(true, "SUCCESS", "ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.", data);
    }

    public static <T> ApiResponse<T> error(String code, String message) {
        return new ApiResponse<>(false, code, message, null);
    }

    // Getter ìƒëµ
}
```

------

### ğŸ¯ 5. ì‘ë‹µ ì½”ë“œ ê´€ë¦¬ ë°©ì‹

```
public enum ErrorCode {
    USER_NOT_FOUND("USER_NOT_FOUND", HttpStatus.NOT_FOUND, "ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),
    INVALID_INPUT("INVALID_INPUT", HttpStatus.BAD_REQUEST, "ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."),
    INTERNAL_ERROR("INTERNAL_ERROR", HttpStatus.INTERNAL_SERVER_ERROR, "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");

    private final String code;
    private final HttpStatus status;
    private final String message;
}
```

â†’ ì˜ˆì™¸ ë°œìƒ ì‹œ `ErrorCode`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ `ApiResponse.error()` ìƒì„±

------

### ğŸ’» 6. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì‚¬ìš© ì˜ˆì‹œ

```
@GetMapping("/users/{id}")
public ResponseEntity<ApiResponse<UserDto>> getUser(@PathVariable Long id) {
    User user = userRepository.findById(id)
        .orElseThrow(() -> new CustomException(ErrorCode.USER_NOT_FOUND));

    return ResponseEntity.ok(ApiResponse.success(UserDto.of(user)));
}
```

------

### ğŸ“˜ 7. ê¸€ë¡œë²Œ ì˜ˆì™¸ ì²˜ë¦¬ ì ìš©

```
@ExceptionHandler(CustomException.class)
public ResponseEntity<ApiResponse<Void>> handleCustom(CustomException ex) {
    ErrorCode code = ex.getErrorCode();
    return ResponseEntity
        .status(code.getStatus())
        .body(ApiResponse.error(code.getCode(), code.getMessage()));
}
```

------

### ğŸ§  8. ì‹¤ë¬´ ì„¤ê³„ ê¸°ì¤€

| í•­ëª©           | ê¸°ì¤€                                                  |
| -------------- | ----------------------------------------------------- |
| ì‘ë‹µ í˜•ì‹      | í•­ìƒ ê°™ì€ êµ¬ì¡° (`success`, `code`, `message`, `data`) |
| ì„±ê³µ ì‘ë‹µ      | 200~204 + `success: true`, `code: SUCCESS`            |
| ì‹¤íŒ¨ ì‘ë‹µ      | 400, 404, 409 ë“± + `success: false`, ëª…í™•í•œ code      |
| ì—ëŸ¬ ì½”ë“œ ê´€ë¦¬ | enum ê¸°ë°˜ ê´€ë¦¬ (ì¤‘ì•™ ì§‘ì¤‘í™”)                          |
| ì˜ˆì™¸ ë©”ì‹œì§€    | ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ ì œê³µ (ë³´ì•ˆ ì •ë³´ ìˆ¨ê¸°ê¸°)          |
| Swagger ì—°ë™   | ì‘ë‹µ êµ¬ì¡° ëª…ì„¸í™” (`@ApiResponse`, `@Schema`) ê°€ëŠ¥     |

------

### âœ… ë§ˆë¬´ë¦¬ ìš”ì•½í‘œ

| í•­ëª©             | ì„¤ëª…                                                 |
| ---------------- | ---------------------------------------------------- |
| ì‘ë‹µ êµ¬ì¡°        | `success`, `code`, `message`, `data` 4ê°€ì§€ í•„ë“œ ê³ ì • |
| ì„±ê³µ             | `success: true` + 2xx ìƒíƒœ ì½”ë“œ                      |
| ì‹¤íŒ¨             | `success: false` + 4xx/5xx + ëª…í™•í•œ code/message     |
| ì œë„¤ë¦­ ì‘ë‹µ ê°ì²´ | `ApiResponse<T>` í™œìš©                                |
| ì½”ë“œ ê´€ë¦¬        | `ErrorCode enum`ìœ¼ë¡œ ì¤‘ì•™ ì§‘ì¤‘                       |

## API ë²„ì „ ê´€ë¦¬ ì „ëµ

### ğŸ§© 1. ì™œ API ë²„ì „ ê´€ë¦¬ê°€ í•„ìš”í•œê°€?

- í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” **ê¸°ì¡´ APIë¥¼ ê¹¨ì§€ ì•Šê³ **,
- ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ë‚˜ ë³€ê²½ëœ ê·œì¹™ì„ **ì ì§„ì ìœ¼ë¡œ ì ìš©**í•  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•´

ì˜ˆ:

> `GET /users/1` ì‘ë‹µ êµ¬ì¡°ê°€ ë°”ë€Œë©´ êµ¬ í´ë¼ì´ì–¸íŠ¸ëŠ” íŒŒì‹±ì— ì‹¤íŒ¨í•¨ â†’ **í˜¸í™˜ì„± ê¹¨ì§**

------

### ğŸ¯ 2. API ë²„ì „ ê´€ë¦¬ ë°©ì‹ 3ê°€ì§€

| ë°©ì‹               | ì˜ˆì‹œ                                      | íŠ¹ì§•                                  |
| ------------------ | ----------------------------------------- | ------------------------------------- |
| âœ… URI ë²„ì „ ë°©ì‹    | `/api/v1/users`                           | ëª…í™•, ì§ê´€ì , ë¸Œë¼ìš°ì €/ë¬¸ì„œí™” ì‰¬ì›€    |
| í—¤ë” ê¸°ë°˜ ë°©ì‹     | `Accept: application/vnd.company.v1+json` | REST ì² í•™ ì§€í–¥, êµ¬í˜„ ë³µì¡             |
| íŒŒë¼ë¯¸í„° ê¸°ë°˜ ë°©ì‹ | `/users?version=1`                        | ì‰¬ì›€, RESTfulí•˜ì§€ ì•ŠìŒ (âŒ ê¶Œì¥ ì•ˆ í•¨) |

------

### âœ… 3. URI ë²„ì „ ë°©ì‹ (ê¶Œì¥)

```
GET /api/v1/users
GET /api/v2/users
```

- ê° ë²„ì „ë§ˆë‹¤ ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¥¼ **ë³„ë„ë¡œ ë¶„ë¦¬**
- Swagger ë¬¸ì„œë„ ë²„ì „ë³„ ìƒì„± ê°€ëŠ¥
- í´ë¼ì´ì–¸íŠ¸ê°€ ëª…í™•íˆ ë²„ì „ í˜¸ì¶œ ê°€ëŠ¥

```
@RestController
@RequestMapping("/api/v1/users")
public class UserControllerV1 { ... }

@RestController
@RequestMapping("/api/v2/users")
public class UserControllerV2 { ... }
```

------

### ğŸ“¦ 4. í—¤ë” ê¸°ë°˜ ë°©ì‹ (Header Versioning)

```
GET /users
Accept: application/vnd.myapp.v1+json
```

- ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ í—¤ë” ì¡°ê±´ìœ¼ë¡œ ë¶„ê¸°

```
@GetMapping(value = "/users", headers = "X-API-VERSION=1")
public UserResponseV1 getV1() { ... }

@GetMapping(value = "/users", headers = "X-API-VERSION=2")
public UserResponseV2 getV2() { ... }
```

> ğŸ“Œ Springì—ì„œëŠ” `@RequestMapping`ì˜ `headers` ì†ì„±ìœ¼ë¡œ ì¡°ê±´ ì œì–´ ê°€ëŠ¥

------

### ğŸ§ª 5. Media Type ë°©ì‹ (Content Negotiation)

```
Accept: application/vnd.company.user.v2+json
```

- ë³µì¡í•˜ì§€ë§Œ ì—„ë°€í•œ REST ìŠ¤íƒ€ì¼
- `produces` ì†ì„±ìœ¼ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ ë¶„ê¸° ê°€ëŠ¥

```
@GetMapping(value = "/users", produces = "application/vnd.company.v2+json")
```

> í•˜ì§€ë§Œ ë¸Œë¼ìš°ì €ì—ì„œ í˜¸ì¶œ í…ŒìŠ¤íŠ¸ ë¶ˆí¸, ë„ì… ì–´ë ¤ì›€

------

### âš ï¸ 6. ë°©ì‹ ë¹„êµ ìš”ì•½

| í•­ëª©            | URI ë°©ì‹    | í—¤ë” ë°©ì‹        | Media Type ë°©ì‹ |
| --------------- | ----------- | ---------------- | --------------- |
| ì§ê´€ì„±          | âœ… ë§¤ìš° ë†’ìŒ | âŒ ë‚®ìŒ           | âŒ ë‚®ìŒ          |
| ë¸Œë¼ìš°ì € ì¹œí™”ì„± | âœ… ì¢‹ìŒ      | âŒ í—¤ë” ì¶”ê°€ í•„ìš” | âŒ               |
| Swagger ë¬¸ì„œí™”  | âœ… ì‰¬ì›€      | âš ï¸ ì„¤ì • í•„ìš”      | âŒ ì–´ë ¤ì›€        |
| êµ¬í˜„ ë‚œì´ë„     | ì‰¬ì›€        | ì¤‘ê°„             | ë³µì¡            |
| REST ì² í•™       | ì•½ê°„ ìœ„ë°˜   | âœ… ì í•©           | âœ… ì í•©          |
| ì‹¤ë¬´ ì í•©ì„±     | âœ… ìµœê³       | âš ï¸ ëŒ€ê·œëª¨ ê¸°ì—…ìš©  | âŒ ê±°ì˜ ì•ˆ ì”€    |

> ì‹¤ë¬´ì—ì„œëŠ” **URI ë°©ì‹** + Swagger ë¬¸ì„œí™”ê°€ ê°€ì¥ ë§ì´ ì“°ì„

------

### ğŸ§  7. ì‹¤ë¬´ ìš´ì˜ ì „ëµ

| ì „ëµ                                | ì„¤ëª…                                                |
| ----------------------------------- | --------------------------------------------------- |
| **ë²„ì „ì€ ìµœëŒ€ 2ê°œ ì´í•˜ ìœ ì§€**       | v1 + v2ê¹Œì§€ë§Œ ìœ ì§€í•˜ê³ , ì´í›„ì—” í•˜ë‚˜ êµì²´            |
| **v1ì„ Deprecated í‘œì‹œ í›„ v2 ê³µì§€** | ë¬¸ì„œí™” ë„êµ¬(Swagger)ì— â€œdeprecatedâ€ í‘œì‹œ            |
| **ì‘ë‹µ í¬ë§· ì¼ê´€ ìœ ì§€**             | v1ê³¼ v2ëŠ” êµ¬ì¡°ë§Œ ë°”ë€Œì§€, í˜•íƒœëŠ” ìœ ì‚¬í•˜ê²Œ ìœ ì§€       |
| **ë²„ì „ë§ˆë‹¤ DTO ë¶„ë¦¬**               | `UserResponseV1`, `UserResponseV2` ë“±ìœ¼ë¡œ ì„¤ê³„ ë¶„ë¦¬ |
| **í…ŒìŠ¤íŠ¸ ìë™í™”**                   | ë²„ì „ë³„ í†µí•© í…ŒìŠ¤íŠ¸ êµ¬ì„± í•„ìˆ˜                        |

------

### ğŸ“˜ 8. Swagger ë¬¸ì„œ ë¶„ë¦¬ ì˜ˆì‹œ (Springdoc ê¸°ì¤€)

```
springdoc:
  group-configs:
    - group: v1
      paths-to-match: /api/v1/**
    - group: v2
      paths-to-match: /api/v2/**
```

```
@RestController
@RequestMapping("/api/v2/users")
@Tag(name = "User API v2", description = "ì‹ ê·œ ì‚¬ìš©ì API")
public class UserControllerV2 { ... }
```

------

### ğŸ” 9. DTO ë²„ì „ ë¶„ë¦¬ íŒ¨í„´

```
public class UserResponseV1 {
    private String name;
    private String email;
}

public class UserResponseV2 {
    private String name;
    private String email;
    private LocalDateTime registeredAt;
}
```

â†’ ë²„ì „ì— ë”°ë¼ DTO, ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤ ê³„ì¸µê¹Œì§€ **ë…ë¦½ ìœ ì§€**
 â†’ í´ë¼ì´ì–¸íŠ¸ ì˜¤ë¥˜ ë°©ì§€

------

### âœ… ë§ˆë¬´ë¦¬ ìš”ì•½í‘œ

| í•­ëª©      | ì„¤ëª…                                            |
| --------- | ----------------------------------------------- |
| ê¸°ë³¸ ë°©ì‹ | `URI ë°©ì‹ (/api/v1)`ì´ ì‹¤ë¬´ì—ì„œ ê°€ì¥ ì•ˆì •ì      |
| ë²„ì „ ì „ëµ | DTO/Controller ì™„ì „ ë¶„ë¦¬, í…ŒìŠ¤íŠ¸ë„ ë²„ì „ë³„ë¡œ     |
| ë¬¸ì„œí™”    | Swaggerì—ì„œ group ë³„ ë¶„ë¦¬ ì¶”ì²œ                  |
| ìš´ì˜ ì •ì±… | v1ì€ Deprecated í‘œì‹œ í›„ ì¼ì • ê¸°ê°„ ìœ ì§€          |
| ê¶Œì¥ ì¡°í•© | `URI + Swagger ë¬¸ì„œ + ë²„ì „ë³„ DTO + ìë™ í…ŒìŠ¤íŠ¸` |

## Swagger UI ì„¤ì •

### ğŸ§© 1. Swaggerë€?

> REST API ëª…ì„¸ë¥¼ **ìë™ ìƒì„±í•˜ê³  UIë¡œ ë¬¸ì„œí™”**í•´ì£¼ëŠ” ë„êµ¬.
>  Spring Bootì—ì„œëŠ” Springfox ëŒ€ì‹  **Springdoc OpenAPI 3** ì‚¬ìš©ì„ ê¶Œì¥ (Spring Boot 3 í˜¸í™˜ì„± â†‘)

------

### ğŸ“¦ 2. ì˜ì¡´ì„± ì„¤ì •

#### âœ… Maven

```
<dependency>
  <groupId>org.springdoc</groupId>
  <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
  <version>2.2.0</version>
</dependency>
```

#### âœ… Gradle

```
implementation("org.springdoc:springdoc-openapi-starter-webmvc-ui:2.2.0")
```

------

### ğŸ”— 3. Swagger UI ì ‘ì† ê²½ë¡œ

Spring Boot ì‹¤í–‰ í›„:

```
http://localhost:8080/swagger-ui.html
```

or (ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¨)

```
http://localhost:8080/swagger-ui/index.html
```

------

### ğŸ“˜ 4. ê¸°ë³¸ ì„¤ì • ì˜ˆì‹œ (`application.yml`)

```
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: method
    display-request-duration: true
```

------

### âœ… 5. API ë¬¸ì„œ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì–´ë…¸í…Œì´ì…˜

| ì–´ë…¸í…Œì´ì…˜                                                   | ì„¤ëª…           |
| ------------------------------------------------------------ | -------------- |
| `@Tag(name = "User", description = "ì‚¬ìš©ì ê´€ë ¨ API")`       | API ê·¸ë£¹ ë¶„ë¥˜  |
| `@Operation(summary = "íšŒì› ì¡°íšŒ", description = "íšŒì› IDë¡œ ì¡°íšŒí•©ë‹ˆë‹¤.")` | ë©”ì„œë“œ ì„¤ëª…    |
| `@Parameter(name = "id", description = "íšŒì› ID", required = true)` | íŒŒë¼ë¯¸í„° ì„¤ëª…  |
| `@Schema(description = "ì‚¬ìš©ì ì‘ë‹µ DTO")`                   | DTO í•„ë“œ ì„¤ëª…  |
| `@ApiResponse(responseCode = "200", description = "ì„±ê³µ")`   | ìƒíƒœ ì½”ë“œ ì„¤ëª… |

------

### ğŸ“‚ 6. ì˜ˆì‹œ Controller

```
@RestController
@RequestMapping("/api/v1/users")
@Tag(name = "User", description = "ì‚¬ìš©ì API")
public class UserController {

    @Operation(summary = "íšŒì› ì¡°íšŒ", description = "íšŒì› IDë¡œ ì¡°íšŒ")
    @ApiResponse(responseCode = "200", description = "ì¡°íšŒ ì„±ê³µ")
    @GetMapping("/{id}")
    public ResponseEntity<UserDto> getUser(
        @Parameter(description = "íšŒì› ID") @PathVariable Long id) {
        return ResponseEntity.ok(...);
    }
}
```

------

### ğŸ“Š 7. ê·¸ë£¹ / ë²„ì „ ë¶„ë¦¬ (ë©€í‹° API)

```
springdoc:
  group-configs:
    - group: v1
      paths-to-match: /api/v1/**
    - group: v2
      paths-to-match: /api/v2/**
```

â¡ï¸ UIì—ì„œ `v1`, `v2` ê·¸ë£¹ì„ ì„ íƒí•  ìˆ˜ ìˆê²Œ ë¨

------

### ğŸ” 8. JWT ë³´ì•ˆ í—¤ë” ì¶”ê°€ (Authorization ì„¤ì •)

```
springdoc:
  swagger-ui:
    persist-authorization: true
components:
  securitySchemes:
    bearer-key:
      type: http
      scheme: bearer
      bearerFormat: JWT
security:
  - bearer-key: []
```

```
@SecurityRequirement(name = "bearer-key")
@Operation(summary = "ë³´í˜¸ëœ API", security = { @SecurityRequirement(name = "bearer-key") })
```

â†’ Swagger UIì— **Authorize** ë²„íŠ¼ì´ ìƒê¸°ê³ , JWT í† í°ì„ ì…ë ¥í•˜ë©´ `Authorization: Bearer xxx` í—¤ë”ê°€ ìë™ ì¶”ê°€ë¨

------

### ğŸ§  9. ì‹¤ë¬´ íŒ

| íŒ                                                           | ì„¤ëª… |
| ------------------------------------------------------------ | ---- |
| DTOë§ˆë‹¤ `@Schema(description = "...")` ë¶™ì´ë©´ ìë™ ë¬¸ì„œí™”ë¨  |      |
| í…ŒìŠ¤íŠ¸ìš© Token ì…ë ¥ì€ `Authorize` ë²„íŠ¼ìœ¼ë¡œ ìë™ ì²˜ë¦¬ ê°€ëŠ¥    |      |
| ì‘ë‹µ ì˜ˆì‹œëŠ” `@ExampleObject` ë˜ëŠ” `@ApiResponse`ë¡œ ëª…ì‹œ ê°€ëŠ¥ |      |
| ë¬¸ì„œ ìˆ¨ê¸°ê¸°: `@Hidden` ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©                       |      |
| ì„œë²„ URL ì„¤ì •: `@OpenAPIDefinition(servers = ...)` ì‚¬ìš©      |      |

------

### âœ… ë§ˆë¬´ë¦¬ ìš”ì•½

| í•­ëª©         | ë‚´ìš©                                                    |
| ------------ | ------------------------------------------------------- |
| UI ì ‘ì† ê²½ë¡œ | `/swagger-ui.html` or `/swagger-ui/index.html`          |
| ì˜ì¡´ì„±       | `springdoc-openapi-starter-webmvc-ui`                   |
| ê¸°ë³¸ ì„¤ì •    | `application.yml`ì—ì„œ ê²½ë¡œ ë° ì •ë ¬ ì„¤ì • ê°€ëŠ¥            |
| ì»¤ìŠ¤í„°ë§ˆì´ì§• | `@Tag`, `@Operation`, `@Schema` ë“±ìœ¼ë¡œ ë¬¸ì„œí™”           |
| ê·¸ë£¹í™”       | `group-configs`ë¡œ v1/v2 ë“± ë¬¸ì„œ ë¶„ë¦¬                    |
| ë³´ì•ˆ í—¤ë”    | JWT/OAuth2 ì¸ì¦ í—¤ë” ì¶”ê°€ ê°€ëŠ¥ (`@SecurityRequirement`) |

## SpringDoc OpenAPI ì„¤ì •

### ğŸ§© 1. SpringDoc OpenAPIë€?

> Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ REST APIë¥¼ ë¶„ì„í•´
>  **ìë™ìœ¼ë¡œ OpenAPI(Swagger) ë¬¸ì„œì™€ UIë¥¼ ìƒì„±**í•´ì£¼ëŠ” ë„êµ¬

âœ… `Springfox`ì˜ í›„ì† ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ Spring Boot 3.x í˜¸í™˜ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì´ ë›°ì–´ë‚¨

------

### ğŸ“¦ 2. ì˜ì¡´ì„± ì¶”ê°€

#### âœ… Gradle (Kotlin DSL ê¸°ì¤€)

```
implementation("org.springdoc:springdoc-openapi-starter-webmvc-ui:2.2.0")
```

> âœ… Spring Boot 3 ì´ìƒì€ `springdoc-openapi-starter-*` ë²„ì „ ì‚¬ìš©

------

### ğŸ”— 3. Swagger UI ì ‘ì† ê²½ë¡œ

ì„œë²„ ì‹¤í–‰ í›„:

```
http://localhost:8080/swagger-ui.html
or
http://localhost:8080/swagger-ui/index.html
```

OpenAPI ìŠ¤í™(JSON):

```
http://localhost:8080/v3/api-docs
```

------

### âš™ï¸ 4. application.yml ì„¤ì •

```
springdoc:
  swagger-ui:
    path: /swagger-ui.html
    display-request-duration: true
    operations-sorter: method
    tags-sorter: alpha
    try-it-out-enabled: true
  api-docs:
    enabled: true
    path: /v3/api-docs
```

------

### ğŸ“‚ 5. API ë¬¸ì„œ ê·¸ë£¹í™” (ë²„ì „ë³„, ë„ë©”ì¸ë³„)

```
springdoc:
  group-configs:
    - group: v1
      display-name: Version 1
      paths-to-match: /api/v1/**
    - group: v2
      display-name: Version 2
      paths-to-match: /api/v2/**
```

â¡ï¸ Swagger UIì—ì„œ `v1`, `v2` ë¬¸ì„œë¥¼ ì„ íƒ ê°€ëŠ¥

------

### ğŸ›¡ï¸ 6. ë³´ì•ˆ ì„¤ì • (JWT Bearer)

#### âœ… application.yml

```
springdoc:
  swagger-ui:
    persist-authorization: true
components:
  security-schemes:
    bearer-key:
      type: http
      scheme: bearer
      bearer-format: JWT
security:
  - bearer-key: []
```

#### âœ… ì»¨íŠ¸ë¡¤ëŸ¬ì— ì ìš©

```
@Operation(summary = "ì‚¬ìš©ì ì¡°íšŒ", security = { @SecurityRequirement(name = "bearer-key") })
@GetMapping("/users")
public UserResponse getUser() { ... }
```

â¡ï¸ Swagger UI ìƒë‹¨ì— **Authorize ë²„íŠ¼** ìƒì„±ë¨

------

### ğŸ“˜ 7. DTO & Controller ì£¼ì„ ì–´ë…¸í…Œì´ì…˜

| ëŒ€ìƒ      | ì–´ë…¸í…Œì´ì…˜                                | ì˜ˆì‹œ                             |
| --------- | ----------------------------------------- | -------------------------------- |
| API ê·¸ë£¹  | `@Tag(name, description)`                 | ì»¨íŠ¸ë¡¤ëŸ¬ ë‹¨ì— ì ìš©               |
| ë©”ì„œë“œ    | `@Operation(summary, description)`        | API ì„¤ëª…                         |
| íŒŒë¼ë¯¸í„°  | `@Parameter(description)`                 | `@PathVariable`, `@RequestParam` |
| DTO í•„ë“œ  | `@Schema(description, example, required)` | ìš”ì²­/ì‘ë‹µ DTOì— ì ìš©             |
| ì‘ë‹µ ì½”ë“œ | `@ApiResponse(responseCode, description)` | ì„±ê³µ/ì‹¤íŒ¨ ëª…ì„¸ ì¶”ê°€              |

#### âœ… ì˜ˆì‹œ

```
@Tag(name = "User", description = "ì‚¬ìš©ì ê´€ë ¨ API")
@RestController
@RequestMapping("/api/v1/users")
public class UserController {

    @Operation(summary = "ì‚¬ìš©ì ë‹¨ê±´ ì¡°íšŒ", description = "IDë¡œ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ")
    @ApiResponse(responseCode = "200", description = "ì¡°íšŒ ì„±ê³µ")
    @GetMapping("/{id}")
    public UserDto getUser(@Parameter(description = "ì‚¬ìš©ì ID") @PathVariable Long id) {
        ...
    }
}
```

------

### ğŸ“‘ 8. ì˜ˆì™¸ ì‘ë‹µ ë¬¸ì„œí™”

SpringDocì€ ê¸°ë³¸ì ìœ¼ë¡œ `@ExceptionHandler`ê¹Œì§€ ë¬¸ì„œí™”í•˜ì§€ ì•Šì§€ë§Œ,
 `@ApiResponse`, `@ApiResponses`ë¡œ ëª…ì‹œ ê°€ëŠ¥:

```
@ApiResponses({
    @ApiResponse(responseCode = "404", description = "ì‚¬ìš©ì ì—†ìŒ"),
    @ApiResponse(responseCode = "400", description = "ìš”ì²­ ì˜¤ë¥˜")
})
```

ë˜ëŠ” ì „ì²´ ê³µí†µ ì˜ˆì™¸ëŠ” `@ControllerAdvice` + Swagger ì£¼ì„ ì¡°í•© í•„ìš”

------

### ğŸ§  9. ì‹¤ë¬´ íŒ

| íŒ                                                           | ì„¤ëª… |
| ------------------------------------------------------------ | ---- |
| DTOì— `@Schema(description, example)` ì¶”ê°€ ì‹œ ìë™ ë¬¸ì„œí™”    |      |
| `@Hidden` ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ Swaggerì—ì„œ ì œì™¸ ê°€ëŠ¥               |      |
| Swagger UIì—ì„œ Try it out â†’ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥                      |      |
| ë¬¸ì„œ ë¹„ê³µê°œ ì‹œì—ëŠ” `springdoc.api-docs.enabled=false` ì„¤ì • ê°€ëŠ¥ |      |
| í´ë¼ì´ì–¸íŠ¸ SDK ìƒì„± ê°€ëŠ¥ (OpenAPI Generator ì‚¬ìš©)            |      |

------

### âœ… ë§ˆë¬´ë¦¬ ìš”ì•½

| í•­ëª©              | ì„¤ëª…                                                         |
| ----------------- | ------------------------------------------------------------ |
| ê¸°ë³¸ URL          | `/swagger-ui.html`, `/v3/api-docs`                           |
| ê·¸ë£¹í™”            | `group-configs`ë¡œ ë²„ì „ë³„/ë„ë©”ì¸ë³„ ë¬¸ì„œ ë¶„ë¦¬                  |
| ë³´ì•ˆ ì—°ë™         | JWT ì„¤ì • ì‹œ `@SecurityRequirement(name = "bearer-key")`      |
| ë¬¸ì„œ ì»¤ìŠ¤í„°ë§ˆì´ì§• | `@Tag`, `@Operation`, `@Schema`, `@Parameter`, `@ApiResponse` ë“± |
| ì‹¤ë¬´ í™œìš©ë„       | UI ê¸°ë°˜ í…ŒìŠ¤íŠ¸ + ë¬¸ì„œí™” + API ë²„ì „ ê´€ë¦¬ ê°€ëŠ¥                 |

## REST Docs

### ğŸ§© 1. Spring REST Docsë€?

> **í…ŒìŠ¤íŠ¸ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì œ API ìš”ì²­/ì‘ë‹µì„ ë¬¸ì„œí™”**í•˜ëŠ” Spring ê³µì‹ ë¬¸ì„œí™” ë„êµ¬.
>  Swaggerì²˜ëŸ¼ ì‹¤í–‰ ì¤‘ì¸ ì„œë²„ì—ì„œ ë™ì‘í•˜ëŠ” UIê°€ ì•„ë‹ˆë¼,
>  âœ… **ì •ì  ë¬¸ì„œ(HTML, PDF ë“±)ë¡œ ë°°í¬ ê°€ëŠ¥**í•˜ë©°,
>  âœ… **ë¬¸ì„œ = ì‹¤ì œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ê²°ê³¼**ë¼ëŠ” ì ì´ ê°€ì¥ ê°•ë ¥í•œ ì¥ì .

------

### ğŸ”„ 2. Swagger vs REST Docs ë¹„êµ

| í•­ëª©        | Swagger (SpringDoc)              | Spring REST Docs                 |
| ----------- | -------------------------------- | -------------------------------- |
| ì‘ë™ ë°©ì‹   | ì½”ë“œ/ì–´ë…¸í…Œì´ì…˜ ê¸°ë°˜ ìë™ ìƒì„±   | í…ŒìŠ¤íŠ¸ ê²°ê³¼ ê¸°ë°˜ ë¬¸ì„œí™”          |
| UI          | âœ… Swagger UI                     | âŒ ì—†ìŒ (HTML/PDFë¡œ ìƒì„±)         |
| ì‹ ë¢°ë„      | ì–´ë…¸í…Œì´ì…˜ â†’ ì‹¤ì œì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ | âœ… í…ŒìŠ¤íŠ¸ ê²°ê³¼ = ë¬¸ì„œ ë‚´ìš©        |
| ë¬¸ì„œ í˜•ì‹   | JSON(OpenAPI) â†’ Swagger UI       | AsciiDoc â†’ HTML/PDF              |
| ì‹¤ë¬´ ì í•©ì„± | ì´ˆê¸° ê°œë°œ, ì¸í„°ë™í‹°ë¸Œ            | âœ… ëŒ€ê¸°ì—…, ê¸ˆìœµê¶Œ, ë¦´ë¦¬ì¦ˆ ë¬¸ì„œ ë“± |

> âœ… REST DocsëŠ” "ì§„ì§œ ë¬¸ì„œ = ì‹¤ì œ í…ŒìŠ¤íŠ¸ ì„±ê³µ ì‘ë‹µ"ì„ ë³´ì¥í•¨

------

### ğŸ“¦ 3. ì˜ì¡´ì„± ì„¤ì • (Gradle ê¸°ì¤€)

```
dependencies {
    implementation("org.springframework.boot:spring-boot-starter-web")
    testImplementation("org.springframework.restdocs:spring-restdocs-mockmvc")
    testImplementation("org.springframework.boot:spring-boot-starter-test")
}

plugins {
    id("org.asciidoctor.jvm.convert") version "3.3.2"
}
```

------

### ğŸ› ï¸ 4. ì„¤ì • ì¶”ê°€ (`build.gradle.kts`)

```
tasks.test {
    outputs.dir(snippetsDir)
    useJUnitPlatform()
}

val snippetsDir by extra { file("build/generated-snippets") }

tasks.named<org.asciidoctor.gradle.jvm.AsciidoctorTask>("asciidoctor") {
    inputs.dir(snippetsDir)
    dependsOn(tasks.test)
    sourceDir.set(file("src/docs/asciidoc"))
    outputDir.set(file("build/docs/asciidoc"))
    attributes(
        mapOf("snippets" to snippetsDir)
    )
}
```

------

### ğŸ“„ 5. í…ŒìŠ¤íŠ¸ ê¸°ë°˜ ë¬¸ì„œ ìƒì„± ì˜ˆì‹œ

#### âœ… ì»¨íŠ¸ë¡¤ëŸ¬

```
@RestController
@RequestMapping("/api/users")
public class UserController {
    @GetMapping("/{id}")
    public ResponseEntity<UserResponse> getUser(@PathVariable Long id) {
        return ResponseEntity.ok(new UserResponse(id, "jeongseok"));
    }
}
```

------

#### âœ… í…ŒìŠ¤íŠ¸ ì½”ë“œ (MockMvc + REST Docs)

```
@WebMvcTest
@AutoConfigureRestDocs
class UserControllerDocsTest {

    @Autowired
    private MockMvc mockMvc;

    @Test
    void ì‚¬ìš©ì_ì¡°íšŒ_ë¬¸ì„œí™”() throws Exception {
        mockMvc.perform(get("/api/users/{id}", 1L)
                .accept(MediaType.APPLICATION_JSON))
            .andExpect(status().isOk())
            .andDo(document("get-user",
                pathParameters(
                    parameterWithName("id").description("ì‚¬ìš©ì ID")
                ),
                responseFields(
                    fieldWithPath("id").description("ì‚¬ìš©ì ID"),
                    fieldWithPath("name").description("ì‚¬ìš©ì ì´ë¦„")
                )
            ));
    }
}
```

â¡ï¸ ì‹¤í–‰ ì‹œ: `build/generated-snippets/get-user/` ê²½ë¡œì— `.adoc` ìŠ¤ë‹ˆí« ìƒì„±

------

### ğŸ“˜ 6. AsciiDoc ë¬¸ì„œ ì‘ì„± (`src/docs/asciidoc/index.adoc`)

```
= REST API ë¬¸ì„œ
:toc: left
:toclevels: 2
:sectlinks:

== ì‚¬ìš©ì API

=== ì‚¬ìš©ì ë‹¨ê±´ ì¡°íšŒ

include::{snippets}/get-user/path-parameters.adoc[]
include::{snippets}/get-user/response-fields.adoc[]
```

------

### ğŸ“Š 7. ë¬¸ì„œ ë¹Œë“œ ëª…ë ¹

```
./gradlew clean build asciidoctor
```

â¡ï¸ `build/docs/asciidoc/index.html` ìƒì„±ë¨

------

### ğŸ” 8. ë³´ì•ˆ í…ŒìŠ¤íŠ¸ í¬í•¨ ì‹œ

- ì¸ì¦ í—¤ë” ì¶”ê°€:

```
.header("Authorization", "Bearer sample.token")
```

- `@AutoConfigureRestDocs(uriScheme = "https", uriHost = "api.example.com", uriPort = 443)`
   ë¡œ ì‹¤ì œ ë°°í¬ í™˜ê²½ ê²½ë¡œ ì„¤ì • ê°€ëŠ¥

------

### ğŸ§  9. ì‹¤ë¬´ ì„¤ê³„ íŒ

| íŒ                                                           | ì„¤ëª… |
| ------------------------------------------------------------ | ---- |
| REST DocsëŠ” ì‹¤ì œ API ì‘ë‹µ ê¸°ë°˜ì´ë¼ ë¬¸ì„œ ì‹ ë¢°ë„ ìµœê³           |      |
| DTOê°€ ë°”ë€Œë©´ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ â†’ ë¬¸ì„œ ìë™ ë³€ê²½ë¨                  |      |
| ë¬¸ì„œ ìë™í™” + CI í†µí•© ê°€ëŠ¥ (`./gradlew asciidoctor` í¬í•¨)    |      |
| Spring REST Docs + Swagger UI ë³‘í–‰ë„ ê°€ëŠ¥ (ì´ˆê¸° + ì •ì‹ ë²„ì „ ë¬¸ì„œ ë¶„ë¦¬) |      |
| `spring-restdocs-webtestclient`ë„ WebClient ê¸°ë°˜ ë¬¸ì„œí™” ì§€ì›í•¨ |      |

------

### âœ… ë§ˆë¬´ë¦¬ ìš”ì•½

| í•­ëª©           | ë‚´ìš©                                            |
| -------------- | ----------------------------------------------- |
| ë¬¸ì„œí™” ë°©ì‹    | í…ŒìŠ¤íŠ¸ ì½”ë“œ ê¸°ë°˜ (`MockMvc` or `WebTestClient`) |
| ë¬¸ì„œ í˜•ì‹      | `.adoc` â†’ HTML, PDF ë“±                          |
| ì‹ ë¢°ë„         | âœ… í…ŒìŠ¤íŠ¸ ê²°ê³¼ = ë¬¸ì„œ ë‚´ìš©                       |
| ë¹Œë“œ           | `./gradlew asciidoctor`                         |
| ì¶œë ¥ ìœ„ì¹˜      | `build/docs/asciidoc/index.html`                |
| Swaggerì™€ ë¹„êµ | UIëŠ” ì—†ìŒ, ì •ì  ë¬¸ì„œí™” + ë°°í¬ì— ì í•©            |

