# 11. í…ŒìŠ¤íŠ¸ì™€ í’ˆì§ˆ ê´€ë¦¬

## ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì™€ í†µí•© í…ŒìŠ¤íŠ¸

Spring ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(Unit Test)**ì™€ **í†µí•© í…ŒìŠ¤íŠ¸(Integration Test)**ëŠ”
 ì½”ë“œì˜ í’ˆì§ˆê³¼ ì•ˆì •ì„±ì„ í™•ë³´í•˜ê¸° ìœ„í•œ í•µì‹¬ ê¸°ë²•ì…ë‹ˆë‹¤.
 ë‘ í…ŒìŠ¤íŠ¸ëŠ” **ëŒ€ìƒ ë²”ìœ„, ì‹¤í–‰ ì†ë„, êµ¬ì„± ë³µì¡ë„, ê²€ì¦ ëª©ì ** ë“±ì´ ì„œë¡œ ë‹¤ë¦…ë‹ˆë‹¤.

ë‹¤ìŒì€ Springì—ì„œì˜ **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ vs í†µí•© í…ŒìŠ¤íŠ¸ì˜ ê°œë…, ì°¨ì´ì , ì„¤ì •, ì‚¬ìš© ë„êµ¬, ì–´ë…¸í…Œì´ì…˜, ì‹¤ë¬´ ì „ëµ**ê¹Œì§€ í¬í•¨í•œ
 ê°€ì¥ ê¹Šì´ ìˆê³  ì²´ê³„ì ì¸ ì„¤ëª…ì…ë‹ˆë‹¤.

------

### ğŸ“˜ 1. ê°œë… ë¹„êµ

| êµ¬ë¶„                | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Unit Test)    | í†µí•© í…ŒìŠ¤íŠ¸ (Integration Test)                            |
| ------------------- | -------------------------- | --------------------------------------------------------- |
| í…ŒìŠ¤íŠ¸ ëŒ€ìƒ         | **í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë‚˜ ë©”ì„œë“œ** | **ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ ê°„ ì‹¤ì œ ë™ì‘ íë¦„ ì „ì²´**                  |
| ë²”ìœ„                | ì‘ìŒ                       | í¼                                                        |
| Spring Context ì‚¬ìš© | âŒ ì—†ìŒ ë˜ëŠ” ìµœì†Œí•œë§Œ ì‚¬ìš©  | âœ… ì „ì²´ ApplicationContext ë¡œë“œ                            |
| ì†ë„                | ë¹ ë¦„                       | ëŠë¦¼ (DB, ë„¤íŠ¸ì›Œí¬ ë“± I/O í¬í•¨)                           |
| ëª©ì                 | ë¡œì§ ê²€ì¦, ê²½ê³„ ì¡°ê±´ í™•ì¸  | Bean ì—°ê²°, DB íŠ¸ëœì­ì…˜, REST, ë³´ì•ˆ íë¦„ ë“± ì‹¤ì œ ë™ì‘ ê²€ì¦ |
| ê²©ë¦¬ë„              | ë†’ìŒ (Mocking ì¤‘ì‹¬)        | ë‚®ìŒ (ì‹¤ì œ í™˜ê²½ ì¤‘ì‹¬)                                     |

------

### ğŸ”§ 2. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸: í•µì‹¬ ì„¤ì •ê³¼ ì˜ˆì‹œ

#### âœ… ì‚¬ìš© ì–´ë…¸í…Œì´ì…˜

| ì–´ë…¸í…Œì´ì…˜                            | ì„¤ëª…                |
| ------------------------------------- | ------------------- |
| `@ExtendWith(MockitoExtension.class)` | JUnit 5 + Mockito   |
| `@Mock`, `@InjectMocks`               | ì˜ì¡´ì„± ëª¨í‚¹         |
| `@Test`                               | JUnit í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ |

#### âœ… ì˜ˆì œ

```
@ExtendWith(MockitoExtension.class)
class UserServiceTest {

    @Mock
    private UserRepository userRepository;

    @InjectMocks
    private UserService userService;

    @Test
    void findUserById_success() {
        User user = new User(1L, "kim");
        given(userRepository.findById(1L)).willReturn(Optional.of(user));

        User result = userService.findById(1L);

        assertEquals("kim", result.getName());
    }
}
```

â†’ ì‹¤ì œ DB ì—°ê²° ì—†ì´ **UserServiceë§Œ ê²€ì¦**

------

### ğŸ” 3. í†µí•© í…ŒìŠ¤íŠ¸: ì „ì²´ ìŠ¤í”„ë§ ì»¨í…ìŠ¤íŠ¸ í¬í•¨

#### âœ… ì‚¬ìš© ì–´ë…¸í…Œì´ì…˜

| ì–´ë…¸í…Œì´ì…˜              | ì„¤ëª…                                   |
| ----------------------- | -------------------------------------- |
| `@SpringBootTest`       | ì „ì²´ ApplicationContext ë¡œë“œ           |
| `@Transactional`        | í…ŒìŠ¤íŠ¸ í›„ ìë™ ë¡¤ë°±                    |
| `@AutoConfigureMockMvc` | `MockMvc` ìë™ ì„¤ì •                    |
| `@TestRestTemplate`     | ì‹¤ì œ HTTP ìš”ì²­ í…ŒìŠ¤íŠ¸ (ì„œë²„ ë¶€íŒ… í•„ìš”) |

#### âœ… ì˜ˆì œ

```
@SpringBootTest
@AutoConfigureMockMvc
class UserControllerIntegrationTest {

    @Autowired
    private MockMvc mockMvc;

    @Test
    void getUser_success() throws Exception {
        mockMvc.perform(get("/users/1"))
            .andExpect(status().isOk())
            .andExpect(jsonPath("$.name").value("kim"));
    }
}
```

â†’ `UserController` + `Service` + `Repository` + DBê¹Œì§€ í†µí•©ëœ íë¦„ì„ í…ŒìŠ¤íŠ¸

------

### ğŸ§ª 4. í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì„±

#### âœ… application.yml (í…ŒìŠ¤íŠ¸ ì „ìš©)

```
spring:
  datasource:
    url: jdbc:h2:mem:testdb
  jpa:
    hibernate:
      ddl-auto: create-drop
```

â†’ `@SpringBootTest`ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `application-test.yml`ì„ ì‚¬ìš© ê°€ëŠ¥
 â†’ ë©”ëª¨ë¦¬ DBë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ ê°„ ê²©ë¦¬ ë° ì†ë„ í™•ë³´

------

### âš™ï¸ 5. MockMvc vs TestRestTemplate

| ë„êµ¬               | ì„¤ëª…                                          |
| ------------------ | --------------------------------------------- |
| `MockMvc`          | ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸ ì—†ì´ í…ŒìŠ¤íŠ¸ (ë¹ ë¦„) |
| `TestRestTemplate` | ì‹¤ì œ í¬íŠ¸ì—ì„œ ì „ì²´ ì„œë²„ ë¶€íŒ… í›„ í…ŒìŠ¤íŠ¸ (ëŠë¦¼) |

â†’ ë‹¨ì¼ ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸: `MockMvc`, E2E í…ŒìŠ¤íŠ¸: `TestRestTemplate`

------

### ğŸ§  6. ì‹¤ë¬´ ì „ëµ

| ì „ëµ                                | ì„¤ëª…                                          |
| ----------------------------------- | --------------------------------------------- |
| **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¡œ ê¸°ë³¸ ë¡œì§ ë³´ì¥**    | Service, Util ë“±ì€ Mockitoë¡œ ì™„ì „ ê²©ë¦¬ í…ŒìŠ¤íŠ¸ |
| **í†µí•© í…ŒìŠ¤íŠ¸ë¡œ ì—°ê²°ì„± ë³´ì¥**       | ì»¨íŠ¸ë¡¤ëŸ¬ â†’ ì„œë¹„ìŠ¤ â†’ DBê¹Œì§€ íë¦„ ì ê²€          |
| **ë°°í¬ ì „ íšŒê·€ í…ŒìŠ¤íŠ¸ë¡œ ì „ì²´ í™•ì¸** | `@SpringBootTest` + `TestContainers` (ì‹¤DB)   |
| **Mockì€ ë‹¨ìœ„ì—ì„œë§Œ ì‚¬ìš©**          | í†µí•©ì—ì„œëŠ” ì‹¤ì œ í™˜ê²½ì„ ì„ í˜¸                   |

------

### âš ï¸ 7. ì£¼ì˜ì‚¬í•­

| í•­ëª©                               | ì„¤ëª…                                      |
| ---------------------------------- | ----------------------------------------- |
| ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì— DB ì˜ì¡´ì„± í¬í•¨ ê¸ˆì§€  | â†’ í†µí•© í…ŒìŠ¤íŠ¸ë¡œ ë¶„ë¦¬í•  ê²ƒ                 |
| í†µí•© í…ŒìŠ¤íŠ¸ì—ì„œ ìºì‹œ/ì‹œíë¦¬í‹° ì£¼ì˜ | @WithMockUser ë“± ì‚¬ìš© í•„ìš”                |
| í…ŒìŠ¤íŠ¸ ê°„ ìƒíƒœ ê³µìœ  ë°©ì§€           | @DirtiesContext ë˜ëŠ” íŠ¸ëœì­ì…˜ ë¡¤ë°± ì‚¬ìš©   |
| í…ŒìŠ¤íŠ¸ì™€ ìš´ì˜ í™˜ê²½ ë¶„ë¦¬            | `application-test.yml` ì‚¬ìš© + í”„ë¡œí•„ ì„¤ì • |

------

### ğŸ“Œ 8. ìš”ì•½ ë¹„êµ

| í•­ëª©           | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸                   | í†µí•© í…ŒìŠ¤íŠ¸                         |
| -------------- | ----------------------------- | ----------------------------------- |
| ì†ë„           | âœ… ë¹ ë¦„                        | âŒ ëŠë¦¼                              |
| ëŒ€ìƒ           | ë‹¨ì¼ í´ë˜ìŠ¤, ë‹¨ì¼ ë©”ì„œë“œ      | ì»¨íŠ¸ë¡¤ëŸ¬~DB ì „ì²´                    |
| ì˜ì¡´ì„±         | ëŒ€ë¶€ë¶„ Mock                   | ì‹¤ì œ ì»´í¬ë„ŒíŠ¸                       |
| Spring Context | âŒ ì—†ì´ë„ ê°€ëŠ¥ (`@ExtendWith`) | âœ… ì „ì²´ or ì¼ë¶€ ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©        |
| ì–´ë…¸í…Œì´ì…˜     | `@Mock`, `@InjectMocks`       | `@SpringBootTest`, `@Transactional` |
| ê²€ì¦ ëª©ì       | ë¡œì§ ì •í™•ì„±                   | íë¦„/ì—°ê²°/í™˜ê²½ êµ¬ì„± ê²€ì¦            |

## JUnit 5 ì„¤ì •

Spring Bootì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” **JUnit 5**(ì •ì‹ ëª…ì¹­: *JUnit Jupiter*)ëŠ” **í˜„ëŒ€ ìë°” í…ŒìŠ¤íŠ¸ í‘œì¤€ í”„ë ˆì„ì›Œí¬**ì…ë‹ˆë‹¤.
 JUnit 5ëŠ” ì´ì „ ë²„ì „(JUnit 4)ê³¼ëŠ” ì•„í‚¤í…ì²˜, ì–´ë…¸í…Œì´ì…˜, í™•ì¥ì„±ì—ì„œ ë§ì€ ì°¨ì´ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°,
 Spring Boot 2.2+ë¶€í„°ëŠ” **ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì—”ì§„**ìœ¼ë¡œ JUnit 5ê°€ ì±„íƒë˜ì–´ ë³„ë„ ì„¤ì • ì—†ì´ë„ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ JUnit 5ì˜ **ì „ì²´ ì„¤ì • êµ¬ì¡°, Gradle/Maven ì˜ì¡´ì„±, ì£¼ìš” ì–´ë…¸í…Œì´ì…˜, Spring ì—°ë™ ë°©ì‹, í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ êµ¬ì¡°, ì‹¤ë¬´ íŒ**ê¹Œì§€ í¬í•¨í•œ ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…ì…ë‹ˆë‹¤.

------

### ğŸ“˜ 1. JUnit 5 êµ¬ì¡° ê°œìš”

JUnit 5ëŠ” 3ê°œì˜ ëª¨ë“ˆë¡œ êµ¬ì„±ë¨:

| êµ¬ì„± ìš”ì†Œ          | ì„¤ëª…                                                        |
| ------------------ | ----------------------------------------------------------- |
| **JUnit Platform** | í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ê¸°ë°˜ (`IDE`, `ë¹Œë“œ íˆ´`, `Console Launcher`)     |
| **JUnit Jupiter**  | ì‹¤ì œ í…ŒìŠ¤íŠ¸ API (`@Test`, `@BeforeEach`, `@DisplayName` ë“±) |
| **JUnit Vintage**  | JUnit 4 ì´ì „ ë²„ì „ í˜¸í™˜ ì‹¤í–‰ê¸° (ì„ íƒì‚¬í•­)                    |

------

### âš™ï¸ 2. Gradle ì„¤ì •

```
dependencies {
    testImplementation 'org.springframework.boot:spring-boot-starter-test' // í¬í•¨ë¨
    testImplementation 'org.junit.jupiter:junit-jupiter'
}
```

#### ì¶”ê°€ ì„¤ì • (build.gradle)

```
test {
    useJUnitPlatform()  // í•„ìˆ˜: JUnit5 ì—”ì§„ í™œì„±í™”
}
```

------

### âš™ï¸ 3. Maven ì„¤ì •

```
<dependencies>
  <dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-test</artifactId>
    <scope>test</scope>
    <exclusions>
      <exclusion>
        <groupId>org.junit.vintage</groupId>
        <artifactId>junit-vintage-engine</artifactId>
      </exclusion>
    </exclusions>
  </dependency>
</dependencies>
```

â†’ Spring Boot 2.4 ì´ìƒì€ `junit-jupiter` ìë™ ì„¤ì •ë¨

------

### ğŸ§ª 4. JUnit 5 ì£¼ìš” ì–´ë…¸í…Œì´ì…˜

| ì–´ë…¸í…Œì´ì…˜            | ì„¤ëª…                                       |
| --------------------- | ------------------------------------------ |
| `@Test`               | í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì§€ì •                         |
| `@BeforeEach`         | ê° í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ ìˆ˜í–‰                     |
| `@AfterEach`          | ê° í…ŒìŠ¤íŠ¸ í›„ ì •ë¦¬                          |
| `@BeforeAll`          | ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹œì‘ ì „ 1íšŒ ìˆ˜í–‰ (static í•„ìš”) |
| `@AfterAll`           | ì „ì²´ í…ŒìŠ¤íŠ¸ ëë‚œ í›„ 1íšŒ ìˆ˜í–‰ (static í•„ìš”) |
| `@DisplayName("...")` | í…ŒìŠ¤íŠ¸ ì´ë¦„ ì„¤ì • (í•œê¸€ ê°€ëŠ¥)               |
| `@Nested`             | ì¤‘ì²© í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì‘ì„±                    |
| `@Disabled`           | í…ŒìŠ¤íŠ¸ ì¼ì‹œ ì¤‘ë‹¨                           |
| `@Tag("slow")`        | íƒœê·¸ ë¶„ë¥˜ë¡œ ì‹¤í–‰ í•„í„°ë§ ê°€ëŠ¥               |

------

### ğŸ” 5. Springê³¼ ì—°ë™

#### âœ… ê¸°ë³¸ Spring í…ŒìŠ¤íŠ¸ (í†µí•©)

```
@SpringBootTest
class MyServiceIntegrationTest {

    @Autowired
    MyService myService;

    @Test
    void ì„œë¹„ìŠ¤_ë™ì‘_í…ŒìŠ¤íŠ¸() {
        ...
    }
}
```

#### âœ… ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸

| ì–´ë…¸í…Œì´ì…˜     | ëŒ€ìƒ                              |
| -------------- | --------------------------------- |
| `@WebMvcTest`  | Controller ê³„ì¸µë§Œ ë¡œë“œ            |
| `@DataJpaTest` | Repository + EntityManagerë§Œ ë¡œë“œ |
| `@MockBean`    | Spring Beanì„ Mockìœ¼ë¡œ êµì²´       |

------

### ğŸ“‚ 6. ë””ë ‰í† ë¦¬ êµ¬ì¡° ì˜ˆì‹œ

```
src/
 â”œâ”€ main/
 â”‚   â””â”€ java/...
 â””â”€ test/
     â””â”€ java/
         â””â”€ com.example.MyServiceTest
```

------

### ğŸ§  7. í…ŒìŠ¤íŠ¸ ì˜ˆì œ

```
@DisplayName("ìœ ì € ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸")
class UserServiceTest {

    private UserService userService;

    @BeforeEach
    void setUp() {
        userService = new UserService();
    }

    @Test
    @DisplayName("ì´ë¦„ìœ¼ë¡œ ìœ ì € ì¡°íšŒ")
    void findByName() {
        User user = userService.findByName("kim");
        assertEquals("kim", user.getName());
    }
}
```

------

### âœ… 8. ì‹¤ë¬´ ì „ëµ

| ì „ëµ                                 | ì„¤ëª…                                    |
| ------------------------------------ | --------------------------------------- |
| í…ŒìŠ¤íŠ¸ ëª…ì¹­ í•œê¸€ ì‚¬ìš©                | `@DisplayName("íšŒì› ê°€ì… ì„±ê³µ í…ŒìŠ¤íŠ¸")` |
| í…ŒìŠ¤íŠ¸ ê²©ë¦¬                          | ëª¨ë“  í…ŒìŠ¤íŠ¸ëŠ” ìƒíƒœ ê³µìœ  ì—†ì´ ë…ë¦½ ì‹¤í–‰  |
| JUnit 5 + Mockito + AssertJ ì¡°í•©     | ê°€ë…ì„±ê³¼ í‘œí˜„ë ¥ ê°•í™”                    |
| CI/CD ì—°ë™ì„ ìœ„í•´ **íƒœê·¸ ì „ëµ** ì‚¬ìš© | `@Tag("integration")`ë¡œ ë¶„ë¥˜ ì‹¤í–‰ ê°€ëŠ¥  |
| ë°˜ë³µ í…ŒìŠ¤íŠ¸                          | `@RepeatedTest(n)` í™œìš© ê°€ëŠ¥            |

------

### âš ï¸ 9. ìì£¼ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜

| ë¬¸ì œ                       | ì›ì¸                                                      |
| -------------------------- | --------------------------------------------------------- |
| `No tests found`           | `useJUnitPlatform()` ëˆ„ë½                                 |
| `NoSuchMethodError`        | JUnit 4 + 5 í˜¼ìš© ì‹œ ë²„ì „ ì¶©ëŒ                             |
| `Method must be static`    | `@BeforeAll`, `@AfterAll`ëŠ” static í•„ìš”                   |
| `Spring Boot context ì˜¤ë¥˜` | í…ŒìŠ¤íŠ¸ ì‹œ `@SpringBootTest` â†’ DB ì„¤ì • ë˜ëŠ” Bean ëˆ„ë½ í™•ì¸ |

------

### ğŸ“Œ 10. ìš”ì•½

| í•­ëª©        | ì„¤ëª…                                             |
| ----------- | ------------------------------------------------ |
| ë²„ì „ êµ¬ì¡°   | Platform + Jupiter + Vintage                     |
| ê¸°ë³¸ ì„¤ì •   | `spring-boot-starter-test` í¬í•¨                  |
| ì‹¤í–‰ ë°©ì‹   | JUnit5: `useJUnitPlatform()` í•„ìˆ˜                |
| Spring ì—°ë™ | `@SpringBootTest`, `@WebMvcTest`, `@MockBean` ë“± |
| ì‹¤ë¬´ ì „ëµ   | `@DisplayName`, íƒœê·¸ ì „ëµ, ê²©ë¦¬ì„±, ë°˜ë³µì„± ë³´ì¥   |

## Spring TestContext Framework

**Spring TestContext Framework**ëŠ” Springì—ì„œ ì œê³µí•˜ëŠ” **í†µí•© í…ŒìŠ¤íŠ¸ ì§€ì› ì¸í”„ë¼**ì…ë‹ˆë‹¤.
 ë‹¨ìˆœíˆ `@SpringBootTest`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê·¸ ì´ìƒìœ¼ë¡œ,
 **ApplicationContext ê´€ë¦¬, íŠ¸ëœì­ì…˜ ì§€ì›, ì˜ì¡´ì„± ì£¼ì…, ì»¨í…ìŠ¤íŠ¸ ìºì‹±, í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì œì–´** ë“±
 í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì „ë°˜ì ì¸ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” **ë°±ê·¸ë¼ìš´ë“œ í”„ë ˆì„ì›Œí¬**ì…ë‹ˆë‹¤.

ë‹¤ìŒì€ Spring TestContext Frameworkì˜ **ì—­í• , êµ¬ì¡°, ë™ì‘ ì›ë¦¬, í•µì‹¬ ì–´ë…¸í…Œì´ì…˜, Context ìºì‹± ì „ëµ, í…ŒìŠ¤íŠ¸ ê³„ì¸µ ì„¤ê³„**,
 ê·¸ë¦¬ê³  **JUnit 5ì™€ì˜ í†µí•© ë°©ì‹**ê¹Œì§€ í¬í•¨í•œ **ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…**ì…ë‹ˆë‹¤.

------

### ğŸ“˜ 1. Spring TestContext Frameworkë€?

Springì´ **JUnit, TestNG, ê¸°íƒ€ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì™€ ë¬´ê´€í•˜ê²Œ**
 **ê³µí†µ í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥ì„ ì œê³µí•˜ê¸° ìœ„í•´ ë§Œë“  ë©”íƒ€ í”„ë ˆì„ì›Œí¬**ì´ë‹¤.

> â—ì¦‰, `@SpringBootTest`, `@WebMvcTest`, `@DataJpaTest` ë“±ì€ ì „ë¶€ ì´ TestContext Framework ìœ„ì—ì„œ ì‘ë™í•œë‹¤.

------

### ğŸ§± 2. í•µì‹¬ êµ¬ì„± ìš”ì†Œ

| êµ¬ì„± ìš”ì†Œ                 | ì„¤ëª…                                                         |
| ------------------------- | ------------------------------------------------------------ |
| `TestContextManager`      | ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì¡°ìœ¨í•˜ëŠ” ê´€ë¦¬ì                  |
| `TestContext`             | ApplicationContext, test instance, method, class ë“±ì„ í¬í•¨í•˜ëŠ” ì»¨í…ìŠ¤íŠ¸ |
| `TestExecutionListener`   | í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „/í›„ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë¦¬ìŠ¤ë„ˆ ì¸í„°í˜ì´ìŠ¤        |
| `ContextLoader`           | ApplicationContextë¥¼ ë¡œë“œí•˜ëŠ” ì „ëµ í´ë˜ìŠ¤                    |
| `@ContextConfiguration`   | ìˆ˜ë™ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ì„¤ì •í•  ë•Œ ì‚¬ìš©                             |
| `@TestExecutionListeners` | ë¦¬ìŠ¤ë„ˆë¥¼ í™•ì¥í•˜ê±°ë‚˜ ëŒ€ì²´í•  ë•Œ ì‚¬ìš©                           |

------

### ğŸ”§ 3. ì§€ì› ê¸°ëŠ¥ ìš”ì•½

| ê¸°ëŠ¥                         | ì„¤ëª…                                                         |
| ---------------------------- | ------------------------------------------------------------ |
| ApplicationContext ìë™ ë¡œë”© | `@SpringBootTest`, `@ContextConfiguration` ë“±ì„ í†µí•´ ë¡œë“œ    |
| DI ì§€ì›                      | `@Autowired`, `@Value`, `@MockBean` ë“± ìë™ ì£¼ì…             |
| íŠ¸ëœì­ì…˜ ì§€ì›                | `@Transactional` + ë¡¤ë°±                                      |
| ì»¨í…ìŠ¤íŠ¸ ìºì‹±                | í…ŒìŠ¤íŠ¸ ì†ë„ ìµœì í™”                                           |
| ë¦¬ìŠ¤ë„ˆ í™•ì¥                  | ì‹¤í–‰ ì „í›„ Hook (`beforeTestMethod`, `afterTestExecution` ë“±) |

------

### ğŸ§© 4. ëŒ€í‘œ ì–´ë…¸í…Œì´ì…˜ ë° ê¸°ëŠ¥

| ì–´ë…¸í…Œì´ì…˜                | ì—­í•                                |
| ------------------------- | ---------------------------------- |
| `@SpringBootTest`         | ì „ì²´ ì»¨í…ìŠ¤íŠ¸ ë¡œë“œ (í†µí•© í…ŒìŠ¤íŠ¸ìš©) |
| `@ContextConfiguration`   | ìˆ˜ë™ ApplicationContext êµ¬ì„± ì§€ì •  |
| `@TestExecutionListeners` | ë¦¬ìŠ¤ë„ˆ ì»¤ìŠ¤í„°ë§ˆì´ì§•                |
| `@DirtiesContext`         | í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„ ì»¨í…ìŠ¤íŠ¸ íê¸°       |
| `@Transactional`          | í…ŒìŠ¤íŠ¸ íŠ¸ëœì­ì…˜ + ìë™ ë¡¤ë°±        |
| `@Commit`, `@Rollback`    | ë¡¤ë°± ì—¬ë¶€ ì§€ì •                     |
| `@TestPropertySource`     | í…ŒìŠ¤íŠ¸ ì „ìš© í”„ë¡œí¼í‹° ì§€ì •          |
| `@Sql`                    | DB ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰            |

------

### âš™ï¸ 5. ë™ì‘ íë¦„

```
í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì‹¤í–‰
  â†“
JUnit â†” TestContextManager ì—°ë™
  â†“
ApplicationContext ë¡œë”© (ìºì‹œ or ìƒˆë¡œ ìƒì„±)
  â†“
DI ì£¼ì… (@Autowired ë“±)
  â†“
@BeforeEach â†’ @Test â†’ @AfterEach
  â†“
í•„ìš” ì‹œ íŠ¸ëœì­ì…˜ ë¡¤ë°±
```

------

### ğŸ§  6. ApplicationContext ìºì‹± ì „ëµ

- ê°™ì€ ì„¤ì • í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” í…ŒìŠ¤íŠ¸ëŠ” **ApplicationContextë¥¼ ìºì‹±**í•˜ì—¬ ì„±ëŠ¥ ìµœì í™”
- ë‹¨, `@DirtiesContext`ê°€ ë¶™ìœ¼ë©´ ì»¨í…ìŠ¤íŠ¸ ì¬ìƒì„±ë¨

```
@DirtiesContext
class UserServiceTest {
  // ì´ í…ŒìŠ¤íŠ¸ëŠ” ëë‚˜ê³  ì»¨í…ìŠ¤íŠ¸ íê¸°ë¨
}
```

------

### ğŸ§ª 7. ë¦¬ìŠ¤ë„ˆ í™•ì¥ ì˜ˆì‹œ

```
@TestExecutionListeners(
  value = CustomTestExecutionListener.class,
  mergeMode = MERGE_WITH_DEFAULTS
)
public class MyTest { ... }
```

â†’ `TestExecutionListener` êµ¬í˜„ì²´ë¥¼ ë“±ë¡í•˜ì—¬ `beforeTestClass`, `afterTestMethod` ë“± ì œì–´ ê°€ëŠ¥

------

### ğŸ” 8. JUnit 5ì™€ì˜ ì—°ë™

JUnit 5ì—ì„œëŠ” `@ExtendWith(SpringExtension.class)`ê°€ TestContextFrameworkë¥¼ í™œì„±í™”í•œë‹¤.

```
@ExtendWith(SpringExtension.class)
@SpringBootTest
public class MyTest { ... }
```

â†’ SpringExtensionì€ ë‚´ë¶€ì—ì„œ TestContextManagerë¥¼ ì´ˆê¸°í™”í•˜ê³  ì‹¤í–‰ íë¦„ì„ Springìœ¼ë¡œ ë„˜ê¸´ë‹¤.

------

### ğŸ“¦ 9. ë‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸ ìŠ¬ë¼ì´ìŠ¤ ì–´ë…¸í…Œì´ì…˜ë“¤ (TestContext ê¸°ë°˜)

| ì–´ë…¸í…Œì´ì…˜        | ì„¤ëª…                                     |
| ----------------- | ---------------------------------------- |
| `@WebMvcTest`     | ì»¨íŠ¸ë¡¤ëŸ¬ ê³„ì¸µ í…ŒìŠ¤íŠ¸ (WebContextë§Œ ë¡œë”©) |
| `@DataJpaTest`    | JPA Repository í…ŒìŠ¤íŠ¸                    |
| `@JdbcTest`       | JDBC ê¸°ë°˜ í…ŒìŠ¤íŠ¸                         |
| `@RestClientTest` | REST Template í…ŒìŠ¤íŠ¸                     |
| `@JsonTest`       | JSON ì§ë ¬í™” í…ŒìŠ¤íŠ¸                       |
| `@SpringBootTest` | ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ í…ŒìŠ¤íŠ¸                 |

â†’ ì „ë¶€ **TestContext Framework ìœ„ì—ì„œ ì‹¤í–‰**ë¨

------

### âœ… 10. ì‹¤ë¬´ ì „ëµ

| ì „ëµ                              | ì„¤ëª…                                                   |
| --------------------------------- | ------------------------------------------------------ |
| ì»¨í…ìŠ¤íŠ¸ ì¬ì‚¬ìš©ìœ¼ë¡œ ì†ë„ í™•ë³´     | ì„¤ì • í´ë˜ìŠ¤ ë˜ëŠ” Profile ë¶„ë¦¬ë¡œ ìºì‹± íš¨ê³¼ ê·¹ëŒ€í™”       |
| í•„ìš”í•œ ê¸°ëŠ¥ë§Œ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸     | `@WebMvcTest`, `@DataJpaTest` ë“± ì ê·¹ í™œìš©             |
| DB ìƒíƒœ ìœ ì§€í•˜ë ¤ë©´ `@Commit` ì‚¬ìš© | ê¸°ë³¸ì€ ìë™ ë¡¤ë°±ì´ë¯€ë¡œ ì£¼ì˜                            |
| í…ŒìŠ¤íŠ¸ ì‹¤í–‰ íë¦„ ì œì–´ ê°€ëŠ¥        | ì»¤ìŠ¤í…€ `TestExecutionListener` ë“±ë¡                    |
| íŠ¸ëœì­ì…˜ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ ë¡¤ë°± í™•ì¸ | DB ë³€ê²½ í™•ì¸ ìœ„í•´ `@Transactional` í…ŒìŠ¤íŠ¸ ì‹¤í–‰ í›„ ê²€ì¦ |

------

### ğŸ“Œ ìš”ì•½

| í•­ëª©       | ì„¤ëª…                                                         |
| ---------- | ------------------------------------------------------------ |
| ì •ì˜       | Spring í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì„ ê´€ë¦¬í•˜ëŠ” ê¸°ë°˜ í”„ë ˆì„ì›Œí¬                |
| í•µì‹¬ êµ¬ì„±  | TestContextManager, TestExecutionListener                    |
| ì£¼ìš” ê¸°ëŠ¥  | Context ë¡œë”©, DI, íŠ¸ëœì­ì…˜, ìºì‹œ, ì‹¤í–‰ í›…                    |
| ì–´ë…¸í…Œì´ì…˜ | `@SpringBootTest`, `@ContextConfiguration`, `@Transactional` ë“± |
| ì‹¤ë¬´ íŒ    | ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸, ìºì‹± ì „ëµ, ì»¤ìŠ¤í…€ ë¦¬ìŠ¤ë„ˆ í™œìš©               |

## `@SpringBootTest`, `@WebMvcTest`, `@DataJpaTest`

`@SpringBootTest`, `@WebMvcTest`, `@DataJpaTest`ëŠ” ëª¨ë‘ Spring Bootì—ì„œ ì œê³µí•˜ëŠ” **ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ ì–´ë…¸í…Œì´ì…˜**ìœ¼ë¡œ,
 **í…ŒìŠ¤íŠ¸ì˜ ëª©ì ê³¼ ë²”ìœ„ì— ë§ê²Œ í•„ìš”í•œ Beanë§Œ ë¡œë”©**í•˜ì—¬ ì„±ëŠ¥ê³¼ í…ŒìŠ¤íŠ¸ í’ˆì§ˆì„ í–¥ìƒì‹œì¼œ ì¤ë‹ˆë‹¤.

ë‹¤ìŒì€ ì´ ì„¸ ê°€ì§€ ì–´ë…¸í…Œì´ì…˜ì˜ **ê°œë…, ì ìš© ëŒ€ìƒ, ë¡œë”© ë²”ìœ„, ì°¨ì´ì , ì„¤ì • ë°©ë²•, ì‹¤ë¬´ ì „ëµ**ê¹Œì§€ í¬í•¨í•œ
 **ê°€ì¥ ê¹Šì´ ìˆëŠ” ë¹„êµ ì„¤ëª…**ì…ë‹ˆë‹¤.

------

### ğŸ“˜ 1. ì–´ë…¸í…Œì´ì…˜ ê°œìš” ë¹„êµ

| ì–´ë…¸í…Œì´ì…˜        | ëª©ì                            | ë¡œë”© ëŒ€ìƒ Bean ë²”ìœ„                       |
| ----------------- | ------------------------------ | ----------------------------------------- |
| `@SpringBootTest` | ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ í†µí•© í…ŒìŠ¤íŠ¸  | **ApplicationContext ì „ì²´ ë¡œë”©**          |
| `@WebMvcTest`     | ì»¨íŠ¸ë¡¤ëŸ¬(Web ê³„ì¸µ) ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ | **ì»¨íŠ¸ë¡¤ëŸ¬ + MVC êµ¬ì„± ìš”ì†Œë§Œ ë¡œë”©**       |
| `@DataJpaTest`    | JPA Repository í…ŒìŠ¤íŠ¸          | **Entity + Repository + JPA ì„¤ì •**ë§Œ ë¡œë”© |

------

### ğŸ§© 2. @SpringBootTest

#### âœ… ê°œìš”

- ì „ì²´ Spring Application Contextë¥¼ ë¡œë“œí•˜ì—¬ **ì™„ì „í•œ í†µí•© í…ŒìŠ¤íŠ¸ ìˆ˜í–‰**
- Service, Repository, Security, Web ë“± ëª¨ë“  Bean ì‚¬ìš© ê°€ëŠ¥

#### âœ… ì˜ˆì œ

```
@SpringBootTest
class UserServiceIntegrationTest {

    @Autowired
    UserService userService;

    @Test
    void saveUser() {
        ...
    }
}
```

#### âœ… íŠ¹ì§•

- ê¸°ë³¸ì ìœ¼ë¡œ ë‚´ì¥ ì›¹ ì„œë²„ë¥¼ ì‹œì‘í•˜ì§€ ì•ŠìŒ (ì„œë²„ í…ŒìŠ¤íŠ¸ëŠ” ë³„ë„ ì„¤ì • í•„ìš”)
- `@Transactional` ì‚¬ìš© ì‹œ í…ŒìŠ¤íŠ¸ í›„ ìë™ ë¡¤ë°±
- ì†ë„ ëŠë¦¼ (ì „ì²´ ì»¨í…ìŠ¤íŠ¸ ë¡œë”©)

------

### ğŸŒ 3. @WebMvcTest

#### âœ… ê°œìš”

- **Web ê³„ì¸µë§Œ í…ŒìŠ¤íŠ¸ (Controller, @ControllerAdvice ë“±)**
- `@Service`, `@Repository` ë“±ì€ ë¡œë”©ë˜ì§€ ì•ŠìŒ â†’ `@MockBean` í•„ìš”

#### âœ… ì˜ˆì œ

```
@WebMvcTest(UserController.class)
class UserControllerTest {

    @Autowired
    MockMvc mockMvc;

    @MockBean
    UserService userService;

    @Test
    void testGetUser() throws Exception {
        ...
    }
}
```

#### âœ… íŠ¹ì§•

- `MockMvc`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨íŠ¸ë¡¤ëŸ¬ ìš”ì²­ì„ ê°€ìƒìœ¼ë¡œ ìˆ˜í–‰
- ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ê´€ë ¨ëœ **DispatcherServlet, Filter, MessageConverter** ë“±ë§Œ í¬í•¨
- DB, Service, ComponentëŠ” ì§ì ‘ ì£¼ì… ë¶ˆê°€

------

### ğŸ—„ï¸ 4. @DataJpaTest

#### âœ… ê°œìš”

- JPA ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ (Entity, Repository, EmbeddedDatabase ë“±)ë§Œ ë¡œë“œ
- ì‹¤ì œ DB ë™ì‘ì„ ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” **ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸**

#### âœ… ì˜ˆì œ

```
@DataJpaTest
class UserRepositoryTest {

    @Autowired
    UserRepository userRepository;

    @Test
    void findByUsername() {
        ...
    }
}
```

#### âœ… íŠ¹ì§•

- ê¸°ë³¸ì ìœ¼ë¡œ **ì„ë² ë””ë“œ H2 DB**ë¡œ ë™ì‘ (`spring.datasource.url` ì˜¤ë²„ë¼ì´ë“œ ê°€ëŠ¥)
- `@Transactional` í¬í•¨ â†’ í…ŒìŠ¤íŠ¸ ì¢…ë£Œ ì‹œ ìë™ ë¡¤ë°±
- `@Import` ë˜ëŠ” `@ComponentScan` ì—†ì´ Service/ControllerëŠ” í¬í•¨ë˜ì§€ ì•ŠìŒ

------

### ğŸ§  5. ë¹„êµ ìš”ì•½í‘œ

| í•­ëª©                  | `@SpringBootTest`        | `@WebMvcTest`           | `@DataJpaTest`       |
| --------------------- | ------------------------ | ----------------------- | -------------------- |
| ëª©ì                   | ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ í…ŒìŠ¤íŠ¸ | Web ê³„ì¸µ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸    | JPA ê³„ì¸µ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ |
| ë¡œë”© ë²”ìœ„             | ì „ì²´ Bean                | Controller + MVC ê´€ë ¨   | Entity + Repository  |
| í…ŒìŠ¤íŠ¸ ì†ë„           | ëŠë¦¼                     | ë¹ ë¦„                    | ë¹ ë¦„                 |
| ê¸°ë³¸ DB ì„¤ì •          | ì‹¤ì œ DB or H2            | X (DB ì—†ìŒ)             | ê¸°ë³¸ H2 ë‚´ì¥         |
| `@Transactional` í¬í•¨ | âŒ ëª…ì‹œí•´ì•¼ í•¨            | âŒ                       | âœ… ìë™ ë¡¤ë°± í¬í•¨     |
| ë‚´ì¥ ì›¹ì„œë²„           | âŒ ê¸°ë³¸ ë¹„í™œì„±            | âŒ                       | âŒ                    |
| ì„œë¹„ìŠ¤ ì£¼ì…           | ê°€ëŠ¥                     | ë¶ˆê°€ (`@MockBean` í•„ìš”) | ë¶ˆê°€                 |

------

### âš™ï¸ 6. ì‹¤ë¬´ ì „ëµ

| ìƒí™©                             | ì¶”ì²œ ì–´ë…¸í…Œì´ì…˜                    |
| -------------------------------- | ---------------------------------- |
| ì „ì²´ API íë¦„ í…ŒìŠ¤íŠ¸             | `@SpringBootTest`                  |
| Controllerë§Œ ê²€ì¦ (MockMvc)      | `@WebMvcTest`                      |
| Repository + Entity í…ŒìŠ¤íŠ¸       | `@DataJpaTest`                     |
| Service + Repository í†µí•© í…ŒìŠ¤íŠ¸ | `@SpringBootTest + @Transactional` |
| Controller + ì‹¤ì œ DB í…ŒìŠ¤íŠ¸      | `@SpringBootTest + TestContainers` |

------

### âš ï¸ 7. ì£¼ì˜ì‚¬í•­

| í•­ëª©                               | ì„¤ëª…                                                   |
| ---------------------------------- | ------------------------------------------------------ |
| `@WebMvcTest`ì—ëŠ” DB ì ‘ê·¼ ë¶ˆê°€     | Service, Repository ëª¨ë‘ ì œì™¸ë¨                        |
| `@DataJpaTest`ì—ëŠ” Controller ì—†ìŒ | ìˆœìˆ˜ Repositoryë§Œ í…ŒìŠ¤íŠ¸í•´ì•¼ í•¨                        |
| Mock ì‚¬ìš© í•„ìš” ì‹œ                  | `@MockBean`ìœ¼ë¡œ ìˆ˜ë™ ì£¼ì…                              |
| H2 ëŒ€ì‹  ì‹¤ì œ DB ì“°ë ¤ë©´             | `application-test.yml`ì—ì„œ ì„¤ì • ë³€ê²½                   |
| WebMvcTestì—ì„œ JSON ë³€í™˜ ì‹¤íŒ¨      | `ObjectMapper`, `MessageConverter` í¬í•¨ ì—¬ë¶€ í™•ì¸ í•„ìš” |

------

### ğŸ“Œ 8. ìš”ì•½

| í…ŒìŠ¤íŠ¸ ëª©ì              | ì¶”ì²œ ì–´ë…¸í…Œì´ì…˜   |
| ----------------------- | ----------------- |
| í†µí•© í…ŒìŠ¤íŠ¸ (ì „ì²´ íë¦„) | `@SpringBootTest` |
| ë‹¨ì¼ Controller í…ŒìŠ¤íŠ¸  | `@WebMvcTest`     |
| JPA ë‹¨ìœ„ í…ŒìŠ¤íŠ¸         | `@DataJpaTest`    |

## Mockitoì™€ `@MockBean`

**`Mockito`**ëŠ” Javaì—ì„œ ê°€ì¥ ë„ë¦¬ ì“°ì´ëŠ” **Mocking í”„ë ˆì„ì›Œí¬**ì´ê³ ,
 **`@MockBean`**ì€ Spring Bootì—ì„œ Mockitoë¥¼ **Spring Context ì•ˆì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í†µí•©í•œ ì–´ë…¸í…Œì´ì…˜**ì…ë‹ˆë‹¤.
 ë‘˜ì„ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ **í…ŒìŠ¤íŠ¸ ëŒ€ìƒ í´ë˜ìŠ¤ì˜ ì˜ì¡´ì„±ì„ ê°€ì§œ(mock) ê°ì²´ë¡œ ëŒ€ì²´í•˜ê³ , ê·¸ í–‰ìœ„ë¥¼ ê²€ì¦**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ **Mockitoì˜ ê°œë…, `@Mock` vs `@MockBean` ì°¨ì´, ì‚¬ìš© ì˜ˆì œ, ë™ì‘ ì›ë¦¬, ì‹¤ë¬´ ì „ëµ**ê¹Œì§€ í¬í•¨í•œ
 **ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…ì…ë‹ˆë‹¤.**

------

### ğŸ“˜ 1. Mockitoë€?

- **í…ŒìŠ¤íŠ¸ ëŒ€ìƒ í´ë˜ìŠ¤ì˜ ì˜ì¡´ ê°ì²´ë¥¼ ê°€ì§œ(Mock)ë¡œ ìƒì„±**í•˜ê³ 
- ì´ Mock ê°ì²´ì˜ ë™ì‘ì„ **ì‚¬ì „ì— ì •ì˜**í•˜ê±°ë‚˜, **í˜¸ì¶œ ì—¬ë¶€ë¥¼ ê²€ì¦**í•  ìˆ˜ ìˆë„ë¡ ì§€ì›

#### âœ… ê¸°ë³¸ ìš©ë„

- ì™¸ë¶€ ì‹œìŠ¤í…œ/API/DB í˜¸ì¶œì„ ëŒ€ì²´
- ì„œë¹„ìŠ¤ ë¡œì§ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì—ì„œ Repository ë“±ì„ Mock ì²˜ë¦¬
- í…ŒìŠ¤íŠ¸ ì†ë„, ë…ë¦½ì„±, ì˜ˆì¸¡ì„± í–¥ìƒ

------

### ğŸ§© 2. @Mock vs @MockBean ì°¨ì´

| í•­ëª©           | `@Mock`                                    | `@MockBean`                                  |
| -------------- | ------------------------------------------ | -------------------------------------------- |
| ëŒ€ìƒ           | ìˆœìˆ˜ Mockito ì‚¬ìš©                          | Spring í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ì™€ í•¨ê»˜ ì‚¬ìš©           |
| ë“±ë¡ ìœ„ì¹˜      | í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ë‚´ë¶€ ë³€ìˆ˜ì—ë§Œ ì¡´ì¬           | **Spring ApplicationContextì— ë“±ë¡ë¨**       |
| ë™ì‘ ë²”ìœ„      | Spring ì»¨í…ìŠ¤íŠ¸ì™€ ë¬´ê´€                     | ì‹¤ì œ Beanì„ ëŒ€ì²´                             |
| ì‚¬ìš© ê°€ëŠ¥ ìœ„ì¹˜ | `@ExtendWith(MockitoExtension.class)` í•„ìˆ˜ | `@SpringBootTest`, `@WebMvcTest` ë“±ì—ì„œ ì‚¬ìš© |

------

#### âœ… í•µì‹¬ ì°¨ì´ ìš”ì•½

| ì˜ˆì‹œ                       | ì„¤ëª…                                                       |
| -------------------------- | ---------------------------------------------------------- |
| `@Mock UserRepository`     | í…ŒìŠ¤íŠ¸ ê°ì²´ ì•ˆì—ì„œë§Œ ì‚¬ìš©ë¨                                |
| `@MockBean UserRepository` | ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ Repository ë¹ˆì„ **mock ê°ì²´ë¡œ êµì²´í•¨** |

------

### ğŸ§ª 3. @MockBean ì˜ˆì œ (@SpringBootTest ë˜ëŠ” @WebMvcTest ë‚´ë¶€)

```
@SpringBootTest
class UserServiceTest {

    @Autowired
    UserService userService;

    @MockBean
    UserRepository userRepository;

    @Test
    void findUserById_success() {
        // given
        given(userRepository.findById(1L))
            .willReturn(Optional.of(new User(1L, "kim")));

        // when
        User result = userService.findById(1L);

        // then
        assertEquals("kim", result.getName());
        then(userRepository).should(times(1)).findById(1L);
    }
}
```

------

### ğŸ§° 4. Mockito í•µì‹¬ ë©”ì„œë“œ

| ë©”ì„œë“œ/ë„êµ¬                     | ì„¤ëª…                           |
| ------------------------------- | ------------------------------ |
| `given().willReturn()`          | Stub ì„¤ì • (Mockito BDD ìŠ¤íƒ€ì¼) |
| `when().thenReturn()`           | ì¼ë°˜ ìŠ¤íƒ€ì¼                    |
| `verify(mock).methodCall()`     | íŠ¹ì • í˜¸ì¶œì´ ìˆì—ˆëŠ”ì§€ ê²€ì¦      |
| `verify(..., times(n))`         | í˜¸ì¶œ íšŸìˆ˜ ê²€ì¦                 |
| `doThrow().when(mock).method()` | ì˜ˆì™¸ ì‹œë®¬ë ˆì´ì…˜                |
| `ArgumentCaptor<T>`             | ì „ë‹¬ëœ ì¸ì ê²€ì¦               |

------

### ğŸ”§ 5. Spring Bootì—ì„œì˜ `@MockBean` ì‘ë™ ì›ë¦¬

- í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ í•´ë‹¹ íƒ€ì…ì˜ **ì‹¤ì œ Beanì„ Spring Contextì—ì„œ ì œê±°**
- ëŒ€ì‹  Mockitoê°€ ë§Œë“  **Mock ê°ì²´ë¥¼ í•´ë‹¹ ë¹ˆ ìë¦¬ì— ì£¼ì…**
- `@Autowired`ë‚˜ `@InjectMocks`ê°€ ìˆëŠ” í´ë˜ìŠ¤ì—ëŠ” **Mockì´ ìë™ ì£¼ì…**

â†’ `@WebMvcTest`ì—ì„œëŠ” Service, Repositoryê°€ í¬í•¨ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°˜ë“œì‹œ `@MockBean`ìœ¼ë¡œ ë“±ë¡í•´ì•¼ ì‚¬ìš© ê°€ëŠ¥

------

### ğŸ§  6. ì‹¤ë¬´ í…ŒìŠ¤íŠ¸ êµ¬ì¡°

#### âœ… ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ (`@WebMvcTest`)

```
@WebMvcTest(UserController.class)
class UserControllerTest {

    @Autowired MockMvc mockMvc;
    @MockBean UserService userService;

    @Test
    void testGetUser() throws Exception {
        given(userService.findUser(anyLong()))
            .willReturn(new User(1L, "kim"));

        mockMvc.perform(get("/users/1"))
            .andExpect(status().isOk())
            .andExpect(jsonPath("$.name").value("kim"));
    }
}
```

------

### âš ï¸ 7. ì£¼ì˜ì‚¬í•­

| í•­ëª©                                           | ì„¤ëª…                                    |
| ---------------------------------------------- | --------------------------------------- |
| `@MockBean`ì€ ë°˜ë“œì‹œ Spring í…ŒìŠ¤íŠ¸ì—ì„œë§Œ ì‘ë™  | ì¼ë°˜ JUnit í…ŒìŠ¤íŠ¸ì—ì„œëŠ” `@Mock` ì‚¬ìš©    |
| ê°™ì€ íƒ€ì…ì˜ ë¹ˆì„ ì—¬ëŸ¬ ê°œ MockBeanìœ¼ë¡œ ë“±ë¡í•˜ë©´ | ì¤‘ë³µ ë“±ë¡ ì˜¤ë¥˜ ë°œìƒ                     |
| í…ŒìŠ¤íŠ¸ ê°„ ìƒíƒœ ê³µìœ  ë°©ì§€ í•„ìš”                  | MockitoëŠ” static ìºì‹œ ì‚¬ìš© ì•ˆ í•¨ â†’ ì•ˆì „ |
| `@SpyBean`ì€ ì‹¤ì œ Bean + ì¼ë¶€ë§Œ Mock ê°€ëŠ¥      | ì‹¤ì „ ë¡œì§ ì¼ë¶€ë§Œ ê²€ì¦í•  ë•Œ ìœ ìš©         |

------

### ğŸ“Œ 8. ìš”ì•½ ë¹„êµí‘œ

| í•­ëª©        | `@Mock`                    | `@MockBean`                         |
| ----------- | -------------------------- | ----------------------------------- |
| ìœ„ì¹˜        | Mockito ë‚´ë¶€ë§Œ             | Spring Context ë‚´ì˜ Bean ëŒ€ì²´       |
| í…ŒìŠ¤íŠ¸ ëŒ€ìƒ | ì¼ë°˜ Java í…ŒìŠ¤íŠ¸           | `@SpringBootTest`, `@WebMvcTest` ë“± |
| ì£¼ì… ë°©ì‹   | `@InjectMocks`ë¡œ ìˆ˜ë™ ì£¼ì… | Springì˜ DIë¡œ ìë™ ì£¼ì…             |
| ì£¼ ìš©ë„     | ì„œë¹„ìŠ¤ ë‹¨ìœ„ ë¡œì§ í…ŒìŠ¤íŠ¸    | Spring ê¸°ë°˜ ê³„ì¸µ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸        |

## í…ŒìŠ¤íŠ¸ ë”ë¸”

**í…ŒìŠ¤íŠ¸ ë”ë¸”(Test Double)**ì€ **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì—ì„œ ì‹¤ì œ ì˜ì¡´ ê°ì²´(real object)ë¥¼ ëŒ€ì²´**í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê°€ì§œ ê°ì²´ì…ë‹ˆë‹¤.
 "ìŠ¤í„´íŠ¸ ë”ë¸”(Stunt Double)"ì´ ì‹¤ì œ ë°°ìš° ëŒ€ì‹  ìœ„í—˜í•œ ì¥ë©´ì„ ìˆ˜í–‰í•˜ë“¯,
 **í…ŒìŠ¤íŠ¸ ëŒ€ìƒ í´ë˜ìŠ¤ê°€ ì˜ì¡´í•˜ëŠ” ê°ì²´ë¥¼ ëŒ€ì²´**í•˜ì—¬ ë…ë¦½ì ì´ê³  ì˜ˆì¸¡ ê°€ëŠ¥í•œ í…ŒìŠ¤íŠ¸ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

------

### ğŸ“˜ 1. í…ŒìŠ¤íŠ¸ ë”ë¸”ì´ë€?

> "í…ŒìŠ¤íŠ¸ ëŒ€ìƒì´ ì˜ì¡´í•˜ëŠ” ê°ì²´ì˜ ìë¦¬ë¥¼ ëŒ€ì‹ í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ë³´ì¡°í•˜ëŠ” ëª¨ë“  ê°€ì§œ ê°ì²´"

ğŸ“Œ ìš©ì–´ ì •ë¦¬:

- "í…ŒìŠ¤íŠ¸ ë”ë¸”"ì€ í†µì¹­ì´ë©°, ê·¸ ì•„ë˜ ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ì¡´ì¬í•¨ (Stub, Mock, Fake, Spy, Dummy)

------

### ğŸ§© 2. í…ŒìŠ¤íŠ¸ ë”ë¸”ì˜ 5ê°€ì§€ ì¢…ë¥˜ (xUnit íŒ¨í„´ ê¸°ì¤€)

| ì´ë¦„      | ì„¤ëª…                                                         |
| --------- | ------------------------------------------------------------ |
| **Dummy** | ì‚¬ìš©ë˜ì§€ ì•Šì§€ë§Œ ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ë¥¼ ì±„ìš°ê¸° ìœ„í•œ ê°ì²´ (`null` ëŒ€ìš©) |
| **Fake**  | **ì‹¤ì œ êµ¬í˜„ì´ ìˆì§€ë§Œ ê°„ë‹¨í•œ ë²„ì „** (ex. InMemory DB)         |
| **Stub**  | **ê³ ì •ëœ ì‘ë‹µì„ ë¦¬í„´**í•˜ëŠ” ê°ì²´                              |
| **Mock**  | **í˜¸ì¶œ ì—¬ë¶€, ìˆœì„œ, ì¸ì ë“±ì„ ê²€ì¦**í•˜ëŠ” ê°ì²´                 |
| **Spy**   | **ì‹¤ì œ ê°ì²´ë¥¼ ê°ì‹¸ì„œ ë™ì‘ì€ ì§„ì§œë¡œ í•˜ë˜**, í˜¸ì¶œ ì—¬ë¶€ ì¶”ì ë„ ê°€ëŠ¥ |

------

### ğŸ§ª 3. ì˜ˆì œ ë¹„êµ (UserService â†’ UserRepository ì˜ì¡´)

#### âœ… 1. Dummy

```
class DummyUserRepository implements UserRepository {
    // ì•„ë¬´ ë™ì‘ë„ í•˜ì§€ ì•ŠìŒ
}
```

â†’ ë‹¨ì§€ `UserRepository` ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œì¡±ì‹œí‚¤ê¸° ìœ„í•œ ê°ì²´

------

#### âœ… 2. Stub

```
class StubUserRepository implements UserRepository {
    public Optional<User> findById(Long id) {
        return Optional.of(new User(id, "kim"));
    }
}
```

â†’ í•­ìƒ ê°™ì€ ì‘ë‹µì„ ë¦¬í„´í•˜ì—¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¦

------

#### âœ… 3. Fake

```
class FakeUserRepository implements UserRepository {
    private Map<Long, User> store = new HashMap<>();

    public void save(User user) {
        store.put(user.getId(), user);
    }

    public Optional<User> findById(Long id) {
        return Optional.ofNullable(store.get(id));
    }
}
```

â†’ ì‹¤ì œ DB ì—†ì´ ì‘ë™í•˜ëŠ” InMemory êµ¬í˜„ (ì˜ˆ: FakeEmailSender, FakePaymentGateway ë“±)

------

#### âœ… 4. Mock (Mockito ì‚¬ìš©)

```
@Mock
UserRepository userRepository;

@Test
void shouldCallFindByIdOnce() {
    userService.findById(1L);
    verify(userRepository, times(1)).findById(1L);
}
```

â†’ í˜¸ì¶œ íšŸìˆ˜, ìˆœì„œ, íŒŒë¼ë¯¸í„° ë“± **í–‰ìœ„ë¥¼ ê²€ì¦**

------

#### âœ… 5. Spy (ì‹¤ì œ ê°ì²´ + ì¶”ì )

```
@Spy
UserRepository userRepository = new RealUserRepository();

@Test
void shouldCallRealMethodAndVerify() {
    userService.doSomething(); // ì‹¤ì œ ì €ì¥ ìˆ˜í–‰
    verify(userRepository).save(any());
}
```

â†’ ì§„ì§œ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë˜, Mockitoë¡œ ì¶”ì ë„ ê°€ëŠ¥

------

### ğŸ”§ 4. í…ŒìŠ¤íŠ¸ ë”ë¸” ì„ íƒ ê¸°ì¤€

| ëª©ì                           | ì„ íƒ  |
| ----------------------------- | ----- |
| ë‹¨ìˆœ ì‹œê·¸ë‹ˆì²˜ ì±„ì›€            | Dummy |
| ê³ ì •ëœ ê²°ê³¼ ë°˜í™˜              | Stub  |
| ì‹¤ì œ ë™ì‘í•˜ë˜ ë‹¨ìˆœí™”ëœ êµ¬ì¡°   | Fake  |
| í–‰ìœ„(í˜¸ì¶œ ì—¬ë¶€, ìˆœì„œ ë“±) ê²€ì¦ | Mock  |
| ì§„ì§œ ê°ì²´ + ê²€ì¦              | Spy   |

------

### ğŸ§  5. ì‹¤ë¬´ì—ì„œì˜ ì ìš© ì „ëµ

| ê³„ì¸µ                   | í…ŒìŠ¤íŠ¸ ë”ë¸” ì¶”ì²œ               | ì„¤ëª…                       |
| ---------------------- | ------------------------------ | -------------------------- |
| Repository (DB)        | **Fake**, Stub                 | InMemory ì €ì¥ì†Œ ìì£¼ ì‚¬ìš©  |
| ì™¸ë¶€ API Client        | **Stub**, Mock                 | í˜¸ì¶œ ì—¬ë¶€, ì‘ë‹µ ì˜ˆì¸¡ í•„ìš”  |
| EmailSender ë“± IO      | **Mock**, Spy                  | ì‹¤ì œ ì „ì†¡ ë°©ì§€ + í˜¸ì¶œ ê²€ì¦ |
| ì„œë¹„ìŠ¤ ë‚´ë¶€            | Stub or Mock                   | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¤‘ì‹¬ í…ŒìŠ¤íŠ¸  |
| í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ìš´ í´ë˜ìŠ¤ | ì¸í„°í˜ì´ìŠ¤ë¡œ ë¶„ë¦¬ í›„ Mock ì‚¬ìš© | í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í™•ë³´         |

------

### ğŸ“Œ 6. ìš”ì•½

| ë”ë¸” ì¢…ë¥˜ | ëª©ì                       | ì‚¬ìš© ì˜ˆì‹œ                      |
| --------- | ------------------------- | ------------------------------ |
| Dummy     | ì‹œê·¸ë‹ˆì²˜ ì±„ì›€ë§Œ í•„ìš”      | `null`, ë¹ˆ ê°ì²´                |
| Stub      | ê³ ì • ì‘ë‹µ ë¦¬í„´            | `given(...).willReturn(...)`   |
| Fake      | ì‹¤ì œ êµ¬í˜„ì´ì§€ë§Œ ë‹¨ìˆœ ë²„ì „ | InMemoryRepository             |
| Mock      | í˜¸ì¶œ/ìˆœì„œ/ì¸ì ê²€ì¦       | `verify(...)`, `times(...)`    |
| Spy       | ì§„ì§œ ë™ì‘ + ê²€ì¦          | `@Spy`, `doReturn().when(...)` |

## í…ŒìŠ¤íŠ¸ DB ì„¤ì •

Spring Bootì—ì„œ **í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •**ì€ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.
 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë‚˜ í†µí•© í…ŒìŠ¤íŠ¸ì—ì„œ **ìš´ì˜ DBì— ì˜í–¥ì„ ì£¼ì§€ ì•Šê³ **,
 **ì†ë„ì™€ ê²©ë¦¬ì„±, ì‹ ë¢°ì„±**ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ í…ŒìŠ¤íŠ¸ ì „ìš© DBë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.

ë‹¤ìŒì€ **H2 ë“± ì„ë² ë””ë“œ DB ì„¤ì •, Testcontainers í™œìš©, application-test.yml êµ¬ì„±, íŠ¸ëœì­ì…˜ ë¡¤ë°±, ë°ì´í„° ì´ˆê¸°í™” ì „ëµ**ê¹Œì§€ í¬í•¨í•œ
 **Spring Bootì˜ í…ŒìŠ¤íŠ¸ DB ì„¤ì •ì— ëŒ€í•œ ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…**ì…ë‹ˆë‹¤.

------

### ğŸ“˜ 1. í…ŒìŠ¤íŠ¸ DBì˜ í•„ìš”ì„±

| ì´ìœ                | ì„¤ëª…                             |
| ------------------ | -------------------------------- |
| ìš´ì˜ DB ì˜¤ì—¼ ë°©ì§€  | í…ŒìŠ¤íŠ¸ë¡œ ì¸í•œ ì‹¤ë°ì´í„° ì†ìƒ ì˜ˆë°© |
| í…ŒìŠ¤íŠ¸ ê²©ë¦¬ì„± í™•ë³´ | í…ŒìŠ¤íŠ¸ë§ˆë‹¤ ë…ë¦½ ì‹¤í–‰ ê°€ëŠ¥        |
| ì†ë„ ê°œì„           | ì¸ë©”ëª¨ë¦¬ DBë¡œ ë¹ ë¥¸ ìˆ˜í–‰          |
| í…ŒìŠ¤íŠ¸ ì¬í˜„ì„± ë³´ì¥ | ìƒíƒœ ì´ˆê¸°í™” ê°€ëŠ¥                 |
| CI/CD ìë™í™” ëŒ€ì‘  | ì™¸ë¶€ ì˜ì¡´ì„± ì—†ëŠ” í…ŒìŠ¤íŠ¸ ê°€ëŠ¥     |

------

### ğŸ§¾ 2. ê¸°ë³¸ ì„¤ì •: `application-test.yml`

```
spring:
  profiles:
    active: test

  datasource:
    url: jdbc:h2:mem:testdb
    driver-class-name: org.h2.Driver
    username: sa
    password:

  h2:
    console:
      enabled: true

  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: true
    properties:
      hibernate:
        format_sql: true
```

â†’ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œë§Œ ë¡œë“œë˜ë„ë¡ `@ActiveProfiles("test")`ë¥¼ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì— ëª…ì‹œ

```
@SpringBootTest
@ActiveProfiles("test")
class UserRepositoryTest { ... }
```

------

### ğŸ§© 3. ì¸ë©”ëª¨ë¦¬ DB ì¢…ë¥˜

| DB                 | íŠ¹ì§•                                 |
| ------------------ | ------------------------------------ |
| **H2**             | Java ê¸°ë°˜, ë§¤ìš° ë¹ ë¥´ê³  Spring ê¸°ë³¸ê°’ |
| HSQLDB             | H2ë³´ë‹¤ ê¸°ëŠ¥ ì ì§€ë§Œ ëŒ€ì²´ ê°€ëŠ¥         |
| Derby              | Java ë‚´ì¥ DB, Embedded ëª¨ë“œ ì§€ì›     |
| SQLite             | íŒŒì¼ ê¸°ë°˜, Androidì— íŠ¹í™”            |
| **Testcontainers** | Docker ê¸°ë°˜, ì‹¤ì œ DB ì‚¬ìš© ê°€ëŠ¥       |

------

### ğŸ”„ 4. í…ŒìŠ¤íŠ¸ íŠ¸ëœì­ì…˜ê³¼ ë¡¤ë°±

Spring í…ŒìŠ¤íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **`@Transactional` + ìë™ ë¡¤ë°±** ì „ëµ ì‚¬ìš©

```
@DataJpaTest  // includes @Transactional
class MyRepositoryTest {

    @Autowired
    MyRepository repo;

    @Test
    void testInsert() {
        repo.save(new MyEntity(...));
        // í…ŒìŠ¤íŠ¸ ëë‚˜ë©´ DB ë¡¤ë°±ë¨
    }
}
```

#### âœ… ìˆ˜ë™ ì»¤ë°‹ì´ í•„ìš”í•  ê²½ìš°

```
@Commit // í…ŒìŠ¤íŠ¸ í›„ ì»¤ë°‹
@Rollback(false) // ë¡¤ë°± ë°©ì§€
```

------

### ğŸ§ª 5. ë°ì´í„° ì´ˆê¸°í™” ì „ëµ

#### âœ… 1. SQL íŒŒì¼ ìë™ ì‹¤í–‰

```
-- src/test/resources/data.sql
INSERT INTO users (id, name) VALUES (1, 'test');
```

â†’ `spring.datasource.initialization-mode=always` ë˜ëŠ” Spring Boot 2.5+ëŠ” ìë™ ì‹¤í–‰

#### âœ… 2. `@Sql` ì–´ë…¸í…Œì´ì…˜

```
@Sql("/init/test-data.sql")
@Sql(scripts = "/init/cleanup.sql", executionPhase = Sql.ExecutionPhase.AFTER_TEST_METHOD)
class UserRepositoryTest { ... }
```

------

### ğŸ³ 6. Testcontainersë¥¼ í™œìš©í•œ ì‹¤DB í…ŒìŠ¤íŠ¸

**ì‹¤ì œ DB (MySQL, PostgreSQL ë“±)ë¥¼ Dockerë¡œ ë„ì›Œ í…ŒìŠ¤íŠ¸**

```
@Testcontainers
@SpringBootTest
@ActiveProfiles("test")
class IntegrationTest {

    @Container
    static PostgreSQLContainer<?> postgres = new PostgreSQLContainer<>("postgres:14")
        .withDatabaseName("testdb")
        .withUsername("user")
        .withPassword("pass");

    @DynamicPropertySource
    static void overrideProps(DynamicPropertyRegistry registry) {
        registry.add("spring.datasource.url", postgres::getJdbcUrl);
        registry.add("spring.datasource.username", postgres::getUsername);
        registry.add("spring.datasource.password", postgres::getPassword);
    }
}
```

â†’ ìš´ì˜ í™˜ê²½ê³¼ ê°€ì¥ ìœ ì‚¬í•œ ì¡°ê±´ì—ì„œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

------

### ğŸ“¦ 7. í…ŒìŠ¤íŠ¸ DB ì„¤ì • ì „ëµ ìš”ì•½

| í•­ëª©             | ì„¤ì • ì „ëµ                                  |
| ---------------- | ------------------------------------------ |
| ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ | H2, HSQL ë“± ì¸ë©”ëª¨ë¦¬ ì‚¬ìš©                  |
| ì‹¤ì œ í™˜ê²½ê³¼ ìœ ì‚¬ | Testcontainersë¡œ ì‹¤DB                      |
| ìƒíƒœ ì´ˆê¸°í™”      | `@Sql`, `data.sql`, íŠ¸ëœì­ì…˜ ë¡¤ë°±          |
| ì„¤ì • ë¶„ë¦¬        | `application-test.yml` + `@ActiveProfiles` |
| ë…ë¦½ì„± ë³´ì¥      | í…ŒìŠ¤íŠ¸ë§ˆë‹¤ DB ì´ˆê¸°í™” or íŠ¸ëœì­ì…˜ ê²©ë¦¬      |

------

### ğŸ“Œ 8. ìš”ì•½

| í•­ëª©          | ì„¤ëª…                                              |
| ------------- | ------------------------------------------------- |
| í…ŒìŠ¤íŠ¸ìš© DB   | ê¸°ë³¸: H2, ê³ ê¸‰: Testcontainers                    |
| í”„ë¡œí•„ ë¶„ë¦¬   | `application-test.yml`, `@ActiveProfiles("test")` |
| íŠ¸ëœì­ì…˜ ê´€ë¦¬ | `@Transactional` + ìë™ ë¡¤ë°±                      |
| ë°ì´í„° ì´ˆê¸°í™” | `data.sql`, `@Sql`, `@BeforeEach`                 |
| ì‹¤ë¬´ ê¶Œì¥     | ë¹ ë¥¸ í…ŒìŠ¤íŠ¸: H2 / ì •í™•í•œ ê²€ì¦: Testcontainers     |

## í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚½ì… (`@Sql`)

Springì—ì„œ **í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ì‚½ì…**ì„ í•  ë•Œ `@Sql` ì–´ë…¸í…Œì´ì…˜ì€ ë§¤ìš° ê°•ë ¥í•˜ê³  ìœ ì—°í•œ ë„êµ¬ì…ë‹ˆë‹¤.
 í…ŒìŠ¤íŠ¸ ë©”ì„œë“œë‚˜ í´ë˜ìŠ¤ ì‹¤í–‰ ì „í›„ì— SQL ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìë™ìœ¼ë¡œ ì‹¤í–‰í•˜ì—¬
 **í…ŒìŠ¤íŠ¸ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ì¤€ë¹„í•˜ê±°ë‚˜ ì •ë¦¬(cleanup)** í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ `@Sql`ì˜ **ê¸°ë³¸ ì‚¬ìš©ë²•, ì‹¤í–‰ ì‹œì , ì—¬ëŸ¬ ìŠ¤í¬ë¦½íŠ¸ ì§€ì •, íŠ¸ëœì­ì…˜ê³¼ì˜ ê´€ê³„, ì‹¤ë¬´ ì „ëµ**ê¹Œì§€ í¬í•¨í•œ
 **ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…ì…ë‹ˆë‹¤.**

------

### ğŸ“˜ 1. `@Sql`ì´ë€?

- **Spring TestContext Framework**ì—ì„œ ì œê³µí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜
- í…ŒìŠ¤íŠ¸ **ì‹¤í–‰ ì „ ë˜ëŠ” í›„ì— SQL ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰**í•  ìˆ˜ ìˆìŒ
- DB ì´ˆê¸°í™”, ìƒ˜í”Œ ë°ì´í„° ì‚½ì…, ì •ë¦¬ìš©ìœ¼ë¡œ ì‚¬ìš©

```
@Sql("/init/data.sql")
```

â†’ `src/test/resources/init/data.sql` íŒŒì¼ì„ í…ŒìŠ¤íŠ¸ ì‹œì‘ ì „ì— ì‹¤í–‰

------

### ğŸ§ª 2. ê¸°ë³¸ ì˜ˆì œ

#### âœ… í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì „ì²´ì— ì ìš©

```
@Sql("/sql/init.sql")
class UserRepositoryTest {
    
    @Test
    void testUserExists() {
        ...
    }
}
```

â†’ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì‹¤í–‰ ì „ì— `init.sql`ì´ ì‹¤í–‰ë¨

------

#### âœ… ê°œë³„ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œì— ì ìš©

```
@Sql("/sql/init-user.sql")
@Test
void testUser() {
    ...
}
```

------

### ğŸ•°ï¸ 3. ì‹¤í–‰ ì‹œì  ì§€ì •

```
@Sql(
  scripts = "/sql/init.sql",
  executionPhase = Sql.ExecutionPhase.BEFORE_TEST_METHOD
)
```

| ì˜µì…˜                          | ì„¤ëª…                             |
| ----------------------------- | -------------------------------- |
| `BEFORE_TEST_METHOD` (ê¸°ë³¸ê°’) | ê° í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì‹¤í–‰ ì „ì— ì‹¤í–‰  |
| `AFTER_TEST_METHOD`           | ê° í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì‹¤í–‰ í›„ ì‹¤í–‰    |
| `BEFORE_TEST_CLASS`           | í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì‹œì‘ ì „ì— 1íšŒ ì‹¤í–‰ |
| `AFTER_TEST_CLASS`            | í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì¢…ë£Œ í›„ 1íšŒ ì‹¤í–‰   |

------

### ğŸ§¾ 4. ì •ë¦¬ SQL í•¨ê»˜ ì‚¬ìš©

```
@Sql(scripts = "/sql/init.sql", executionPhase = Sql.ExecutionPhase.BEFORE_TEST_METHOD)
@Sql(scripts = "/sql/cleanup.sql", executionPhase = Sql.ExecutionPhase.AFTER_TEST_METHOD)
```

â†’ í…ŒìŠ¤íŠ¸ ì „ ì´ˆê¸°í™”, í…ŒìŠ¤íŠ¸ í›„ ì •ë¦¬

------

### ğŸ” 5. ë‹¤ì¤‘ ìŠ¤í¬ë¦½íŠ¸ ì§€ì •

```
@Sql({
    "/sql/init-users.sql",
    "/sql/init-orders.sql"
})
```

â†’ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë¨

------

### ğŸ”’ 6. íŠ¸ëœì­ì…˜ê³¼ì˜ ê´€ê³„

| ìƒí™©                             | ì„¤ëª…                              |
| -------------------------------- | --------------------------------- |
| `@Transactional`ê³¼ í•¨ê»˜ ì‚¬ìš© ì‹œ  | SQLë„ ê°™ì€ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì‹¤í–‰ë¨ |
| `@Rollback`ì´ ê¸°ë³¸ ì ìš©ë˜ì–´ ìˆìŒ | í…ŒìŠ¤íŠ¸ í›„ SQLë„ ë¡¤ë°±ë¨            |
| `@Commit` ì¶”ê°€ ì‹œ DBì— ë°˜ì˜ë¨    | í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„ ì‹¤ì œ ì ìš© ê°€ëŠ¥     |

------

### ğŸ§  7. ì‹¤ë¬´ íŒ

| ì „ëµ                                                | ì„¤ëª…                                                         |
| --------------------------------------------------- | ------------------------------------------------------------ |
| í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ëŠ” `test/resources/sql/` í´ë”ì— ê´€ë¦¬ | `@Sql("/sql/user-init.sql")` êµ¬ì¡°                            |
| í´ë˜ìŠ¤ ë‹¨ìœ„ë¡œ ê³µí†µ ë°ì´í„° êµ¬ì„±                      | `@Sql(scripts = "common.sql", executionPhase = BEFORE_TEST_CLASS)` |
| ì™¸ë¶€ì—ì„œ DB ì´ˆê¸°í™” ê´€ë¦¬ ì‹œ                          | Flyway/Migration ë„êµ¬ì™€ í•¨ê»˜ ì‚¬ìš© ê°€ëŠ¥                       |
| ì •ë¦¬(cleanup.sql)ì€ ì£¼ë¡œ `TRUNCATE`, `DELETE` ì‚¬ìš©  | ë°ì´í„° ì¶©ëŒ ë°©ì§€                                             |

------

### ğŸ§© 8. ìì£¼ ì“°ëŠ” SQL ì˜ˆì‹œ

```
-- init.sql
INSERT INTO users (id, name) VALUES (1, 'kim');
INSERT INTO users (id, name) VALUES (2, 'lee');

-- cleanup.sql
DELETE FROM users;
```

------

### âœ… 9. ìš”ì•½

| í•­ëª©               | ì„¤ëª…                                |
| ------------------ | ----------------------------------- |
| ëª©ì                | í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ì¤€ë¹„ ë° ì •ë¦¬        |
| ìœ„ì¹˜               | `src/test/resources/**/*.sql`       |
| ì‹¤í–‰ ì‹œì           | BEFORE / AFTER (METHOD / CLASS)     |
| íŠ¸ëœì­ì…˜ ì—°ë™      | `@Transactional`ì— ë¬¶ì´ë©° ë¡¤ë°± ê°€ëŠ¥ |
| ì—¬ëŸ¬ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© | `@Sql({ "a.sql", "b.sql" })` ê°€ëŠ¥   |

## í…ŒìŠ¤íŠ¸ ìë™í™”

**í…ŒìŠ¤íŠ¸ ìë™í™”(Test Automation)**ëŠ” ì½”ë“œ ë³€ê²½ì´ ë°œìƒí•  ë•Œë§ˆë‹¤ **ì‚¬ëŒì˜ ê°œì… ì—†ì´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰**í•˜ê³ ,
 ê·¸ ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ë§Œë“œëŠ” ì¼ë ¨ì˜ ì²´ê³„ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
 Spring Boot ê¸°ë°˜ì˜ ë°±ì—”ë“œ ì‹œìŠ¤í…œì—ì„œ í…ŒìŠ¤íŠ¸ ìë™í™”ëŠ” **ë¹Œë“œ, í…ŒìŠ¤íŠ¸ ì‹¤í–‰, ë¦¬í¬íŠ¸, ë°°í¬ ì „ ê²€ì¦**ê¹Œì§€ ì—°ê²°ë˜ëŠ” í•µì‹¬ ìš”ì†Œì…ë‹ˆë‹¤.

ë‹¤ìŒì€ **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸, CI íŒŒì´í”„ë¼ì¸ ì—°ê³„, ì»¤ë²„ë¦¬ì§€ ì¸¡ì •, í…ŒìŠ¤íŠ¸ ë¶„ë¦¬ ì „ëµ, ì‹¤ë¬´ ìë™í™” í™˜ê²½ êµ¬ì„±**ê¹Œì§€ í¬í•¨í•œ
 **Spring í”„ë¡œì íŠ¸ì—ì„œì˜ í…ŒìŠ¤íŠ¸ ìë™í™”ì— ëŒ€í•œ ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…**ì…ë‹ˆë‹¤.

------

### ğŸ“˜ 1. í…ŒìŠ¤íŠ¸ ìë™í™”ë€?

> â€œí…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì¼ì¼ì´ ì‹¤í–‰í•˜ì§€ ì•Šê³ , ì½”ë“œ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ ê²€ì¦ì´ ìˆ˜í–‰ë˜ë„ë¡ í•˜ëŠ” ì¼ë ¨ì˜ ì‹œìŠ¤í…œí™”ëœ í”„ë¡œì„¸ìŠ¤â€

ğŸ“Œ ëª©ì :

- ê°œë°œìì˜ ì‹¤ìˆ˜ ë°©ì§€
- ë¦´ë¦¬ì¦ˆ ì‹œì ì— ì‹ ë¢°ì„± í™•ë³´
- ì½”ë“œ ë³€ê²½ìœ¼ë¡œ ì¸í•œ íšŒê·€(regression) ë°©ì§€
- í’ˆì§ˆ ê´€ë¦¬ íš¨ìœ¨ì„± í–¥ìƒ

------

### ğŸ§© 2. í…ŒìŠ¤íŠ¸ ìë™í™”ì˜ êµ¬ì„± ìš”ì†Œ

| êµ¬ì„± ìš”ì†Œ            | ì—­í•                                    |
| -------------------- | -------------------------------------- |
| **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**      | ê¸°ëŠ¥ ë‹¨ìœ„ ê²€ì¦                         |
| **í†µí•© í…ŒìŠ¤íŠ¸**      | ì»´í¬ë„ŒíŠ¸ ê°„ ìƒí˜¸ì‘ìš© ê²€ì¦              |
| **E2E í…ŒìŠ¤íŠ¸**       | ì‹¤ì œ ì‚¬ìš©ì íë¦„ ì‹œë®¬ë ˆì´ì…˜            |
| **CI/CD íŒŒì´í”„ë¼ì¸** | ë³€ê²½ ì‚¬í•­ í‘¸ì‹œ ì‹œ í…ŒìŠ¤íŠ¸ ìë™ ì‹¤í–‰     |
| **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**  | í…ŒìŠ¤íŠ¸ê°€ ì½”ë“œë¥¼ ì–¼ë§ˆë‚˜ ê²€ì¦í•˜ëŠ”ì§€ í™•ì¸ |
| **ë¦¬í¬íŠ¸ ì‹œìŠ¤í…œ**    | ì‹¤íŒ¨ ì‹œ ë¡œê·¸, ì„±ê³µ ì‹œ ë¦¬í¬íŠ¸ ìë™ ì¶œë ¥ |

------

### âš™ï¸ 3. Spring Bootì—ì„œ ìë™í™” í™˜ê²½ êµ¬ì„±

#### âœ… í…ŒìŠ¤íŠ¸ ë„êµ¬ ìŠ¤íƒ

| ë²”ìœ„            | ë„êµ¬                                         |
| --------------- | -------------------------------------------- |
| ë‹¨ìœ„ í…ŒìŠ¤íŠ¸     | JUnit 5 + Mockito                            |
| í†µí•© í…ŒìŠ¤íŠ¸     | SpringBootTest + TestContainers              |
| REST API í…ŒìŠ¤íŠ¸ | MockMvc, RestAssured                         |
| ì»¤ë²„ë¦¬ì§€ ë¶„ì„   | JaCoCo                                       |
| ë¹Œë“œ ìë™í™”     | Gradle, Maven                                |
| CI/CD ìë™í™”    | GitHub Actions, Jenkins, GitLab CI, CircleCI |

------

#### âœ… í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ëª…ë ¹ì–´

#### Gradle

```
./gradlew test
```

#### Maven

```
mvn test
```

â†’ `src/test/java/**` ë‚´ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰

------

### ğŸ§ª 4. ìë™í™” êµ¬ì„± ì˜ˆì‹œ: GitHub Actions

```
# .github/workflows/test.yml
name: Test and Build

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up JDK
        uses: actions/setup-java@v3
        with:
          java-version: '17'

      - name: Build and test
        run: ./gradlew clean test

      - name: Upload test report
        uses: actions/upload-artifact@v3
        with:
          name: junit-report
          path: build/test-results/test/
```

------

### ğŸ“¦ 5. í…ŒìŠ¤íŠ¸ ìë™í™” + ì»¤ë²„ë¦¬ì§€ ì¸¡ì • (JaCoCo)

#### Gradle ì„¤ì •

```
plugins {
    id 'jacoco'
}

jacocoTestReport {
    reports {
        xml.required = true
        html.required = true
    }
}
```

#### ì‹¤í–‰

```
./gradlew test jacocoTestReport
```

â†’ `build/reports/jacoco/index.html`ì—ì„œ ì»¤ë²„ë¦¬ì§€ ì‹œê°í™”

------

### ğŸ§  6. ì‹¤ë¬´ ìë™í™” ì „ëµ

| ì „ëµ                           | ì„¤ëª…                                     |
| ------------------------------ | ---------------------------------------- |
| **ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸ ë¶„ë¦¬ ì‹¤í–‰** | `@Tag("integration")`, `test filtering`  |
| **ìŠ¬ë¡œìš° í…ŒìŠ¤íŠ¸ ë”°ë¡œ ê´€ë¦¬**    | `@Disabled`, `@Tag("slow")`ë¡œ ë¶„ë¦¬       |
| **PR ì‹œ ìë™ ì‹¤í–‰**            | GitHub Actions, Jenkins CIë¡œ ì—°ê²°        |
| **ì‹¤DB ê²€ì¦ì€ ì£¼ê¸°ì ë§Œ ì‹¤í–‰**  | TestContainersëŠ” ë¬´ê²ê¸° ë•Œë¬¸ì— ì„ íƒ ì‹¤í–‰ |
| **ë¹Œë“œ ì‹¤íŒ¨ = ë°°í¬ ì‹¤íŒ¨**      | í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ ë°°í¬ íŒŒì´í”„ë¼ì¸ ì¢…ë£Œ ì²˜ë¦¬ |

------

### ğŸ“Œ 7. ìš”ì•½

| í•­ëª©           | ì„¤ëª…                               |
| -------------- | ---------------------------------- |
| ëª©ì            | í…ŒìŠ¤íŠ¸ ë°˜ë³µ ìë™í™” â†’ í’ˆì§ˆ í–¥ìƒ     |
| ë„êµ¬           | JUnit, Mockito, JaCoCo, CI ì„œë²„    |
| ì‹¤í–‰ ë°©ì‹      | Git ì´ë²¤íŠ¸ ê¸°ë°˜ (Push, PR ë“±)      |
| ë³´ê³ ì„œ         | í…ŒìŠ¤íŠ¸ ë¦¬í¬íŠ¸ + ì»¤ë²„ë¦¬ì§€ HTML ì¶œë ¥ |
| ì‹¤ë¬´ ì ìš© ì „ëµ | íƒœê¹…/ë¶„ë¦¬/ìºì‹±/ì¡°ê±´ë¶€ ì‹¤í–‰ ì¡°í•©    |

## ì»¤ë²„ë¦¬ì§€ ì¸¡ì • ë„êµ¬

- ## JaCoCo, SonarQube

  **JaCoCo**ì™€ **SonarQube**ëŠ” **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ì¸¡ì • ë° ì½”ë“œ í’ˆì§ˆ ë¶„ì„**ì„ ìœ„í•œ ëŒ€í‘œì ì¸ ë„êµ¬ì…ë‹ˆë‹¤.
   ë‘˜ì€ ê°ì ì—­í• ì´ ë‹¤ë¥´ë©°, í•¨ê»˜ ì—°ë™í•  ê²½ìš° **ì •ì  ë¶„ì„ + í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ + ìœ ì§€ë³´ìˆ˜ì„± ë¶„ì„**ì„ ëª¨ë‘ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ë‹¤ìŒì€ **JaCoCoì˜ ê°œë… ë° ì„¤ì •, SonarQubeì˜ êµ¬ì¡° ë° ë¶„ì„ í•­ëª©, ë‘˜ì˜ ì—°ë™ ë°©ë²•, ì‹¤ë¬´ ì ìš© ì „ëµ**ê¹Œì§€ í¬í•¨í•œ
   **ê°€ì¥ ê¹Šì´ ìˆëŠ” ì„¤ëª…ì…ë‹ˆë‹¤.**

  ------

  ### ğŸ“˜ 1. JaCoCoë€?

  **Ja**va **Co**de **Co**verageì˜ ì•½ìì´ë©°,
   JUnit í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ **í…ŒìŠ¤íŠ¸ê°€ ì‹¤ì œ ì½”ë“œì˜ ëª‡ %ë¥¼ ì‹¤í–‰í–ˆëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ë„êµ¬**ì…ë‹ˆë‹¤.

  | í•­ëª©           | ì„¤ëª…                                              |
  | -------------- | ------------------------------------------------- |
  | íƒ€ì…           | **ì»¤ë²„ë¦¬ì§€ ì¸¡ì • ë„êµ¬** (ì˜¤í”ˆì†ŒìŠ¤, JVM ê¸°ë°˜)       |
  | ë¶„ì„ ëŒ€ìƒ      | `.class` íŒŒì¼ (ë°”ì´íŠ¸ì½”ë“œ ë‹¨ìœ„)                   |
  | í†µê³„ ì§€í‘œ      | Line, Branch, Instruction, Method, Class ì»¤ë²„ë¦¬ì§€ |
  | ê²°ê³¼ ë¦¬í¬íŠ¸    | XML, HTML, CSV ë“± ì§€ì›                            |
  | í†µí•© ê°€ëŠ¥ ë„êµ¬ | Gradle, Maven, SonarQube, Jenkins ë“±ê³¼ ì—°ë™ ê°€ëŠ¥  |

  ------

  #### âœ… JaCoCo ì»¤ë²„ë¦¬ì§€ ì¢…ë¥˜

  | í•­ëª©        | ì„¤ëª…                                  |
  | ----------- | ------------------------------------- |
  | Line        | ëª‡ ì¤„ì˜ ì½”ë“œê°€ ì‹¤í–‰ë˜ì—ˆëŠ”ê°€           |
  | Branch      | if/else ë“± ë¶„ê¸° ì¡°ê±´ì´ í…ŒìŠ¤íŠ¸ë˜ì—ˆëŠ”ê°€ |
  | Method      | ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ì—ˆëŠ”ê°€                 |
  | Instruction | JVM ëª…ë ¹ì–´ ê¸°ì¤€ ì‹¤í–‰ ì—¬ë¶€             |
  | Class       | í´ë˜ìŠ¤ ë‹¨ìœ„ë¡œ ì»¤ë²„ë˜ì—ˆëŠ”ê°€            |

  ------

  #### âœ… Gradle ì„¤ì • ì˜ˆì‹œ

  ```
  plugins {
      id 'jacoco'
  }
  
  jacoco {
      toolVersion = "0.8.10" // ìµœì‹  ë²„ì „
  }
  
  jacocoTestReport {
      dependsOn test
      reports {
          xml.required = true
          html.required = true
      }
  }
  ```

  #### ì‹¤í–‰ ëª…ë ¹ì–´

  ```
  ./gradlew test jacocoTestReport
  ```

  #### ê²°ê³¼ ìœ„ì¹˜

  ```
  build/reports/jacoco/test/html/index.html
  ```

  ------

  ### ğŸ“¦ 2. SonarQubeë€?

  **ì½”ë“œ í’ˆì§ˆ ê´€ë¦¬ í”Œë«í¼**ìœ¼ë¡œ ë‹¤ìŒ ê¸°ëŠ¥ì„ ì œê³µí•¨:

  | ê¸°ëŠ¥                        | ì„¤ëª…                                    |
  | --------------------------- | --------------------------------------- |
  | ì •ì  ì½”ë“œ ë¶„ì„              | ë²„ê·¸, ì·¨ì•½ì , ì½”ë“œ ëƒ„ìƒˆ íƒì§€            |
  | ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸             | JaCoCo ë“± ì™¸ë¶€ ë„êµ¬ë¡œë¶€í„° ì»¤ë²„ë¦¬ì§€ ìˆ˜ì§‘ |
  | ìœ ì§€ë³´ìˆ˜ì„± ë° ê¸°ìˆ ë¶€ì±„ ê³„ì‚° | "ì½”ë“œë¥¼ ì–¼ë§ˆë‚˜ ê³ ì³ì•¼ í•˜ëŠ”ê°€" ìˆ˜ì¹˜í™”    |
  | CI/CD ì—°ë™                  | GitHub Actions, Jenkins ë“±              |
  | ë‹¤ì–‘í•œ ì–¸ì–´ ì§€ì›            | Java, Kotlin, JavaScript, Python ë“±     |

  ------

  #### âœ… í•µì‹¬ ë¶„ì„ í•­ëª©

  | í•­ëª©                | ì„¤ëª…                                    |
  | ------------------- | --------------------------------------- |
  | **Bugs**            | ì‹¤ì œ ì‹¤í–‰ ì‹œ ì˜¤ë¥˜ë¥¼ ìœ ë°œí•  ìˆ˜ ìˆëŠ” ì½”ë“œ |
  | **Vulnerabilities** | ë³´ì•ˆ ê²°í•¨ ìœ ë°œ ê°€ëŠ¥ì„±                   |
  | **Code Smells**     | ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ìš´ ë¹„íš¨ìœ¨ì  êµ¬ì¡°           |
  | **Coverage**        | í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ (JaCoCo ì—°ë™)           |
  | **Duplications**    | ì¤‘ë³µ ì½”ë“œ ë¹„ìœ¨                          |
  | **Debt**            | ê°œì„ ì— í•„ìš”í•œ ì‹œê°„ (ê¸°ìˆ  ë¶€ì±„ ì§€í‘œ)     |

  ------

  ### ğŸ”— 3. JaCoCo + SonarQube ì—°ë™

  #### âœ… Gradle ì„¤ì • ì˜ˆì‹œ

  ```
  plugins {
      id 'jacoco'
      id 'org.sonarqube' version '4.4.1.3373' // ìµœì‹  ë²„ì „ í™•ì¸
  }
  
  sonar {
      properties {
          property "sonar.projectKey", "myproject"
          property "sonar.organization", "myorg"
          property "sonar.host.url", "http://localhost:9000"
          property "sonar.login", "your-token"
          property "sonar.coverage.jacoco.xmlReportPaths", "build/reports/jacoco/test/jacocoTestReport.xml"
      }
  }
  ```

  #### âœ… ì‹¤í–‰ ìˆœì„œ

  ```
  ./gradlew test jacocoTestReport sonar
  ```

  â†’ JaCoCoê°€ ì»¤ë²„ë¦¬ì§€ë¥¼ ìˆ˜ì§‘í•˜ê³ , SonarQubeê°€ ë¶„ì„ ë° ì‹œê°í™”

  ------

  ### ğŸŒ 4. SonarQube ì„œë²„ ì„¤ì¹˜

  #### Docker ë°©ì‹ (ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš©)

  ```
  docker run -d --name sonar \
    -p 9000:9000 \
    sonarqube:latest
  ```

  - ì ‘ì† ì£¼ì†Œ: http://localhost:9000
  - ê¸°ë³¸ ê³„ì •: `admin` / `admin`

  ------

  ### ğŸ§  5. ì‹¤ë¬´ ìë™í™” ì „ëµ

  | ë‹¨ê³„           | ë‚´ìš©                                                         |
  | -------------- | ------------------------------------------------------------ |
  | ë¡œì»¬ í…ŒìŠ¤íŠ¸    | `JaCoCo`ë¡œ ì»¤ë²„ë¦¬ì§€ í™•ì¸ (`./gradlew test jacocoTestReport`) |
  | CI í™˜ê²½        | GitHub Actions ë˜ëŠ” Jenkinsì—ì„œ `sonar` íƒœìŠ¤í¬ ì‹¤í–‰          |
  | í’ˆì§ˆ ê²Œì´íŠ¸    | SonarQubeì—ì„œ "ì»¤ë²„ë¦¬ì§€ 80% ì´ìƒ" ê°™ì€ ê¸°ì¤€ ì„¤ì • ê°€ëŠ¥        |
  | PR ë¶„ì„ ìë™í™” | GitHub PRì—ì„œ SonarQube ê²°ê³¼ ì½”ë©˜íŠ¸ ë‚¨ê¸°ê¸° (Developer Edition ì´ìƒ) |
  | ì½”ë“œ ë¦¬ë·° ì—°ê³„ | Bug/Vulnerability/Smell ìˆëŠ” ì½”ë“œ ìë™ í‘œì‹œ                  |

  ------

  ### âœ… 6. ìš”ì•½

  | í•­ëª©        | JaCoCo                            | SonarQube                        |
  | ----------- | --------------------------------- | -------------------------------- |
  | ìš©ë„        | í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ì¸¡ì • ë„êµ¬         | ì½”ë“œ í’ˆì§ˆ ì¢…í•© ë¶„ì„ í”Œë«í¼       |
  | ë°©ì‹        | ë°”ì´íŠ¸ì½”ë“œ ì‹¤í–‰ ë¶„ì„              | ì •ì  ë¶„ì„ + ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸ ìˆ˜ì§‘ |
  | ì£¼ìš” ì‚°ì¶œë¬¼ | HTML/XML ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸          | ì›¹ ëŒ€ì‹œë³´ë“œ, í’ˆì§ˆ ê²Œì´íŠ¸         |
  | ì—°ë™        | Gradle/Mavenê³¼ ì—°ë™               | JaCoCo ë¦¬í¬íŠ¸ì™€ ì—°ë™ ê°€ëŠ¥        |
  | CI í†µí•©     | `./gradlew test jacocoTestReport` | `./gradlew sonar`                |